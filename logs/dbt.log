

============================== 2022-07-28 06:32:19.213932 | 916fee8d-26f4-4c9e-a0cb-b75013a9d557 ==============================
[0m06:32:19.213942 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:32:19.214170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m06:32:19.214254 [debug] [MainThread]: Tracking: tracking
[0m06:32:19.220318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6bbd37580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6bbd376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6bbda34c0>]}
[0m06:32:19.374498 [debug] [MainThread]: Executing "git --help"
[0m06:32:19.386680 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:32:19.386951 [debug] [MainThread]: STDERR: "b''"
[0m06:32:19.390754 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m06:32:19.391370 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:32:19.391462 [debug] [MainThread]: On debug: select 1 as id
[0m06:32:19.391537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:32:20.694985 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.3 seconds
[0m06:32:20.695814 [debug] [MainThread]: On debug: Close
[0m06:32:20.918111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b4dd2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6bb7f2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b4d496a0>]}
[0m06:32:21.842178 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-28 06:35:51.883869 | 8bff1940-6cee-47b4-80f4-37076e777a4b ==============================
[0m06:35:51.883886 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:35:51.884192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m06:35:51.884311 [debug] [MainThread]: Tracking: tracking
[0m06:35:51.884514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef947f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef947fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef964070>]}
[0m06:35:51.892130 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m06:35:51.892306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8bff1940-6cee-47b4-80f4-37076e777a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef964d60>]}
[0m06:35:51.902556 [debug] [MainThread]: Parsing macros/adapters.sql
[0m06:35:51.934038 [debug] [MainThread]: Parsing macros/catalog.sql
[0m06:35:51.936358 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m06:35:51.937077 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m06:35:51.939747 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m06:35:51.946189 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m06:35:51.948993 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m06:35:51.950162 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m06:35:51.953712 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:35:51.954073 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:35:51.954485 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:35:51.954981 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:35:51.955435 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:35:51.962332 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:35:51.972526 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:35:51.975864 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:35:51.978045 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:35:51.987869 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:35:51.989935 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:35:51.991553 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:35:51.996893 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m06:35:51.998851 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m06:35:51.999956 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m06:35:52.001065 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m06:35:52.006864 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m06:35:52.009882 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m06:35:52.010404 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m06:35:52.011011 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m06:35:52.011668 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m06:35:52.012647 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:35:52.014386 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:35:52.017149 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m06:35:52.018468 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m06:35:52.019793 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m06:35:52.022989 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:35:52.036259 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:35:52.041116 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:35:52.042453 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:35:52.050661 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:35:52.063632 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m06:35:52.072944 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m06:35:52.083868 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:35:52.095487 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:35:52.102119 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m06:35:52.103262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m06:35:52.106491 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:35:52.108917 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m06:35:52.109874 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:35:52.113726 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:35:52.115506 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:35:52.117641 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:35:52.121606 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:35:52.123380 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:35:52.124948 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m06:35:52.125654 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:35:52.126586 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:35:52.127394 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m06:35:52.128105 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:35:52.128823 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:35:52.129813 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:35:52.130687 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m06:35:52.132204 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m06:35:52.132928 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m06:35:52.133677 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:35:52.134508 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:35:52.135304 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:35:52.136217 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m06:35:52.137190 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m06:35:52.138012 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m06:35:52.142326 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:35:52.143022 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:35:52.143673 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:35:52.144530 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m06:35:52.333060 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:35:52.341276 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:35:52.380943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bff1940-6cee-47b4-80f4-37076e777a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec7e32b0>]}
[0m06:35:52.385405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bff1940-6cee-47b4-80f4-37076e777a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef8f93d0>]}
[0m06:35:52.385652 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:35:52.385816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bff1940-6cee-47b4-80f4-37076e777a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef947f70>]}
[0m06:35:52.386329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef947fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec7e3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec7e36a0>]}


============================== 2022-07-28 06:43:30.256389 | 2d4f50c0-150f-4ba2-a99d-4160d1a381bb ==============================
06:43:30.256401 [info ] [MainThread]: Running with dbt=1.1.1
06:43:30.256687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
06:43:30.256805 [debug] [MainThread]: Tracking: tracking
06:43:30.257005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22aff5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22aff640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22aff6a0>]}
06:43:30.270201 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
06:43:30.270427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d4f50c0-150f-4ba2-a99d-4160d1a381bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22b24a90>]}
06:43:30.288361 [debug] [MainThread]: Parsing macros/adapters.sql
06:43:30.315704 [debug] [MainThread]: Parsing macros/catalog.sql
06:43:30.317265 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
06:43:30.318005 [debug] [MainThread]: Parsing macros/materializations/merge.sql
06:43:30.320866 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
06:43:30.327478 [debug] [MainThread]: Parsing macros/materializations/table.sql
06:43:30.329815 [debug] [MainThread]: Parsing macros/materializations/view.sql
06:43:30.330842 [debug] [MainThread]: Parsing macros/materializations/seed.sql
06:43:30.334838 [debug] [MainThread]: Parsing macros/adapters/columns.sql
06:43:30.342507 [debug] [MainThread]: Parsing macros/adapters/relation.sql
06:43:30.349448 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
06:43:30.352653 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
06:43:30.354897 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
06:43:30.356900 [debug] [MainThread]: Parsing macros/adapters/schema.sql
06:43:30.358538 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
06:43:30.363853 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
06:43:30.365727 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
06:43:30.367003 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
06:43:30.368120 [debug] [MainThread]: Parsing macros/etc/datetime.sql
06:43:30.374157 [debug] [MainThread]: Parsing macros/etc/statement.sql
06:43:30.377490 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
06:43:30.378147 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
06:43:30.378809 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
06:43:30.379462 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
06:43:30.380493 [debug] [MainThread]: Parsing macros/materializations/configs.sql
06:43:30.382281 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
06:43:30.385424 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
06:43:30.386829 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
06:43:30.388100 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
06:43:30.391361 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
06:43:30.402829 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
06:43:30.407227 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
06:43:30.408455 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
06:43:30.416126 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
06:43:30.427738 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
06:43:30.437639 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
06:43:30.449824 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
06:43:30.461778 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
06:43:30.469888 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
06:43:30.471093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
06:43:30.474347 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
06:43:30.476310 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
06:43:30.477289 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
06:43:30.482329 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
06:43:30.484112 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
06:43:30.486207 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
06:43:30.491309 [debug] [MainThread]: Parsing tests/generic/builtin.sql
06:43:30.640803 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
06:43:30.648399 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
06:43:30.681906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d4f50c0-150f-4ba2-a99d-4160d1a381bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde201cd1f0>]}
06:43:30.685738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d4f50c0-150f-4ba2-a99d-4160d1a381bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22aff5e0>]}
06:43:30.685982 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
06:43:30.686140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4f50c0-150f-4ba2-a99d-4160d1a381bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde201c3fd0>]}
06:43:30.686640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22a54fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22a6b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde22a6bdc0>]}


============================== 2022-07-28 08:11:44.385403 | 98276f28-c864-4a1e-b341-3b9c8586d9b4 ==============================
08:11:44.385413 [info ] [MainThread]: Running with dbt=1.1.1
08:11:44.385688 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:11:44.385807 [debug] [MainThread]: Tracking: tracking
08:11:44.386021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b601c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b601c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b601c6a0>]}
08:11:44.403356 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
08:11:44.403654 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_listings.sql
08:11:44.403836 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://models/example/my_second_dbt_model.sql
08:11:44.403942 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://models/example/my_first_dbt_model.sql
08:11:44.413123 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
08:11:44.422913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:11:44.426084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98276f28-c864-4a1e-b341-3b9c8586d9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b4f69760>]}
08:11:44.429911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98276f28-c864-4a1e-b341-3b9c8586d9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b60cfd60>]}
08:11:44.430177 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:11:44.430339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98276f28-c864-4a1e-b341-3b9c8586d9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b60cfa60>]}
08:11:44.430851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b60cfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b602ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b60ca640>]}


============================== 2022-07-28 08:12:31.137362 | 29716900-3d4b-4978-9e5d-919260275603 ==============================
08:12:31.137373 [info ] [MainThread]: Running with dbt=1.1.1
08:12:31.137646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:12:31.137760 [debug] [MainThread]: Tracking: tracking
08:12:31.137974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc51135e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc5113640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc51136a0>]}
08:12:31.154919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:12:31.155081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:12:31.155314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:12:31.159136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29716900-3d4b-4978-9e5d-919260275603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc50af610>]}
08:12:31.162903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29716900-3d4b-4978-9e5d-919260275603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc5167610>]}
08:12:31.163165 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:12:31.163336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29716900-3d4b-4978-9e5d-919260275603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc51676d0>]}
08:12:31.163845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc51676a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc5167220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc5167190>]}


============================== 2022-07-28 08:12:59.028259 | c05c837e-40f7-48b1-8013-62225c301e00 ==============================
[0m08:12:59.028282 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:12:59.028651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:12:59.028774 [debug] [MainThread]: Tracking: tracking
[0m08:12:59.028979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f76d7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f76d7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f76f2070>]}
[0m08:12:59.045243 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m08:12:59.045645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c05c837e-40f7-48b1-8013-62225c301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f76d74c0>]}
[0m08:12:59.060768 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:12:59.095946 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:12:59.097462 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:12:59.098182 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:12:59.100822 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:12:59.107951 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:12:59.110883 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:12:59.111898 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:12:59.115509 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:12:59.115871 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:12:59.116279 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:12:59.116780 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:12:59.117292 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:12:59.124336 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:12:59.134430 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:12:59.137705 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:12:59.139786 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:12:59.149738 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:12:59.151723 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:12:59.153298 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:12:59.158505 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:12:59.160578 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:12:59.161685 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:12:59.162805 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:12:59.168368 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:12:59.171393 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:12:59.171918 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:12:59.172531 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:12:59.173189 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:12:59.174336 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:12:59.176041 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:12:59.178898 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:12:59.180220 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:12:59.181489 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:12:59.184579 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:12:59.197447 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:12:59.202226 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:12:59.203439 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:12:59.211498 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:12:59.225082 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:12:59.234662 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:12:59.245750 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:12:59.257899 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:12:59.264764 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:12:59.265867 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:12:59.269204 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:12:59.271630 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:12:59.272618 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:12:59.276677 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:12:59.278514 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:12:59.280693 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:12:59.284873 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:12:59.286659 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:12:59.288240 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:12:59.288974 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:12:59.290011 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:12:59.290854 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:12:59.291605 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:12:59.292339 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:12:59.293310 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:12:59.294152 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:12:59.295644 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:12:59.296361 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:12:59.297130 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:12:59.297995 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:12:59.298908 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:12:59.299761 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:12:59.300696 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:12:59.301510 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:12:59.305977 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:12:59.306667 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:12:59.307383 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:12:59.308254 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:12:59.493051 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:12:59.517626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m08:12:59.520893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c05c837e-40f7-48b1-8013-62225c301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f65c7fa0>]}
[0m08:12:59.524478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c05c837e-40f7-48b1-8013-62225c301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f65ceb80>]}
[0m08:12:59.524704 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:12:59.524898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c05c837e-40f7-48b1-8013-62225c301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f77049d0>]}
[0m08:12:59.525696 [info ] [MainThread]: 
[0m08:12:59.526025 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:12:59.526969 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:12:59.566149 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:12:59.566314 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:12:59.566395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:00.238887 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.67 seconds
[0m08:13:00.240239 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:13:00.338219 [debug] [ThreadPool]: Acquiring new snowflake connection "create_airbnb_dev"
[0m08:13:00.338460 [debug] [ThreadPool]: Acquiring new snowflake connection "create_airbnb_dev"
[0m08:13:00.338648 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='airbnb', schema='dev', identifier=None)"
[0m08:13:00.342224 [debug] [ThreadPool]: Using snowflake connection "create_airbnb_dev"
[0m08:13:00.342383 [debug] [ThreadPool]: On create_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_airbnb_dev"} */
create schema if not exists airbnb.dev
[0m08:13:00.342495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:00.876130 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.53 seconds
[0m08:13:00.876783 [debug] [ThreadPool]: On create_airbnb_dev: Close
[0m08:13:00.969337 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:13:00.974360 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:13:00.974520 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:13:00.974640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:01.544353 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.57 seconds
[0m08:13:01.545281 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:13:01.640294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c05c837e-40f7-48b1-8013-62225c301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e766b670>]}
[0m08:13:01.640781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:01.641029 [info ] [MainThread]: 
[0m08:13:01.646354 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m08:13:01.646622 [info ] [Thread-1  ]: 1 of 1 START view model dev.src_listings ....................................... [RUN]
[0m08:13:01.647259 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:13:01.647386 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m08:13:01.647509 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_listings
[0m08:13:01.648788 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:13:01.649377 [debug] [Thread-1  ]: finished collecting timing info
[0m08:13:01.649521 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m08:13:01.669663 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:13:01.670516 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:13:01.670630 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listing as (
    select * from "AIRBNB"."RAW"."RAW_LISTINGS"
)
select
	id as listing_id,
	listing_url,
	name as listing_name,
	room_type,
	minimum_nights,
	host_id,
	price as price_str,
	created_at,
	updated_at
FROM raw_listings
  );
[0m08:13:01.670725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:13:02.153188 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5e78c-3201-0690-0000-d0150001104a
[0m08:13:02.153540 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m08:13:02.154001 [debug] [Thread-1  ]: finished collecting timing info
[0m08:13:02.154274 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m08:13:02.253172 [debug] [Thread-1  ]: Database Error in model src_listings (models/src/src_listings.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/dbtlearn/models/src/src_listings.sql
[0m08:13:02.253450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c05c837e-40f7-48b1-8013-62225c301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e41f8c70>]}
[0m08:13:02.253709 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dev.src_listings .............................. [[31mERROR[0m in 0.61s]
[0m08:13:02.254021 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m08:13:02.255115 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:13:02.255339 [info ] [MainThread]: 
[0m08:13:02.255522 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m08:13:02.255699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:02.255790 [debug] [MainThread]: Connection 'create_airbnb_dev' was properly closed.
[0m08:13:02.255879 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:13:02.260756 [info ] [MainThread]: 
[0m08:13:02.260985 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:13:02.261179 [info ] [MainThread]: 
[0m08:13:02.261347 [error] [MainThread]: [33mDatabase Error in model src_listings (models/src/src_listings.sql)[0m
[0m08:13:02.261510 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m08:13:02.261664 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m08:13:02.261819 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/src/src_listings.sql
[0m08:13:02.261979 [info ] [MainThread]: 
[0m08:13:02.262140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:13:02.262378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f65c9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f65c9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f65c9520>]}


============================== 2022-07-28 08:15:38.802059 | c6c101ec-77e7-4e25-982a-0b5fafcb43ee ==============================
[0m08:15:38.802075 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:15:38.802435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:15:38.802559 [debug] [MainThread]: Tracking: tracking
[0m08:15:38.802758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2b31e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2b31e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2b31ee0>]}
[0m08:15:38.822832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:15:38.823168 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m08:15:38.833097 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:15:38.851476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m08:15:38.855149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c101ec-77e7-4e25-982a-0b5fafcb43ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e01e8d00>]}
[0m08:15:38.859196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c101ec-77e7-4e25-982a-0b5fafcb43ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2a7cf40>]}
[0m08:15:38.859444 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:15:38.859668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c101ec-77e7-4e25-982a-0b5fafcb43ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2a6f040>]}
[0m08:15:38.860588 [info ] [MainThread]: 
[0m08:15:38.860971 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:15:38.861635 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:15:38.870521 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:15:38.870708 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:15:38.870816 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-07-28 08:15:39.122820 | 39ad7d67-11ac-419c-9941-9b908d3b4100 ==============================
08:15:39.122835 [info ] [MainThread]: Running with dbt=1.1.1
08:15:39.123215 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:15:39.123385 [debug] [MainThread]: Tracking: tracking
08:15:39.123671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b1c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b1c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b1c640>]}
08:15:39.136744 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
08:15:39.136958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39ad7d67-11ac-419c-9941-9b908d3b4100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b3f9d0>]}
08:15:39.142740 [debug] [MainThread]: Parsing macros/adapters.sql
08:15:39.169934 [debug] [MainThread]: Parsing macros/catalog.sql
08:15:39.171379 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:15:39.172065 [debug] [MainThread]: Parsing macros/materializations/merge.sql
08:15:39.174646 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:15:39.180642 [debug] [MainThread]: Parsing macros/materializations/table.sql
08:15:39.182818 [debug] [MainThread]: Parsing macros/materializations/view.sql
08:15:39.183861 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:15:39.187592 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:15:39.194338 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:15:39.201233 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:15:39.204561 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:15:39.206773 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:15:39.208796 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:15:39.210363 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:15:39.215444 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:15:39.217315 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:15:39.218448 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:15:39.219493 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:15:39.225290 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:15:39.228510 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:15:39.229040 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:15:39.229652 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:15:39.230308 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:15:39.231322 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:15:39.233039 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:15:39.235950 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:15:39.237321 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:15:39.238711 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:15:39.242129 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:15:39.254376 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:15:39.258994 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:15:39.260249 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:15:39.267998 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:15:39.280290 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:15:39.289720 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:15:39.300788 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:15:39.312057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:15:39.319106 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:15:39.320202 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:15:39.323325 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:15:39.325181 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:15:39.326139 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:15:39.330877 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:15:39.332804 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:15:39.334945 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:15:39.340458 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:15:39.492998 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
08:15:39.511107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:15:39.514276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39ad7d67-11ac-419c-9941-9b908d3b4100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b879d0>]}
08:15:39.517214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39ad7d67-11ac-419c-9941-9b908d3b4100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b47c10>]}
08:15:39.517449 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:15:39.517605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39ad7d67-11ac-419c-9941-9b908d3b4100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b3f580>]}
08:15:39.518052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b3f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b87790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77b87af0>]}
[0m08:15:39.842373 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.97 seconds
[0m08:15:39.843818 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:15:39.958169 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:15:39.963063 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:15:39.963196 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:15:39.963299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:15:40.526080 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.56 seconds
[0m08:15:40.527098 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:15:40.622976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c101ec-77e7-4e25-982a-0b5fafcb43ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2b4c8b0>]}
[0m08:15:40.623385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:15:40.623593 [info ] [MainThread]: 
[0m08:15:40.626755 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m08:15:40.627007 [info ] [Thread-1  ]: 1 of 1 START view model dev.src_listings ....................................... [RUN]
[0m08:15:40.627386 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:15:40.627502 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m08:15:40.627627 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_listings
[0m08:15:40.629497 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:15:40.629746 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:40.629880 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m08:15:40.649712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:15:40.650320 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:15:40.650445 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listing as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
	id as listing_id,
	listing_url,
	name as listing_name,
	room_type,
	minimum_nights,
	host_id,
	price as price_str,
	created_at,
	updated_at
FROM raw_listings
  );
[0m08:15:40.650546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:15:41.261725 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5e78f-3201-06a3-0000-0000d015f041
[0m08:15:41.261888 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m08:15:41.262053 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:41.262183 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m08:15:41.361886 [debug] [Thread-1  ]: Database Error in model src_listings (models/src/src_listings.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/dbtlearn/models/src/src_listings.sql
[0m08:15:41.362174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c101ec-77e7-4e25-982a-0b5fafcb43ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b2b195e0>]}
[0m08:15:41.362438 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dev.src_listings .............................. [[31mERROR[0m in 0.73s]
[0m08:15:41.362757 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m08:15:41.364050 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:15:41.364274 [info ] [MainThread]: 
[0m08:15:41.364458 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m08:15:41.364634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:41.364730 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:15:41.368856 [info ] [MainThread]: 
[0m08:15:41.369101 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:15:41.369303 [info ] [MainThread]: 
[0m08:15:41.369476 [error] [MainThread]: [33mDatabase Error in model src_listings (models/src/src_listings.sql)[0m
[0m08:15:41.369645 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m08:15:41.369801 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m08:15:41.369960 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/src/src_listings.sql
[0m08:15:41.370130 [info ] [MainThread]: 
[0m08:15:41.370334 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:15:41.370582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2a6cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2b4c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2a7cd00>]}


============================== 2022-07-28 08:17:36.805143 | bcb6ca5b-9f05-44dc-abb5-0d25fb429836 ==============================
08:17:36.805154 [info ] [MainThread]: Running with dbt=1.1.1
08:17:36.805434 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:17:36.805555 [debug] [MainThread]: Tracking: tracking
08:17:36.805765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b512bf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b512bf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b512bf730>]}
08:17:36.822090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:17:36.822394 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
08:17:36.830965 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
08:17:36.840456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:17:36.843752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb6ca5b-9f05-44dc-abb5-0d25fb429836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b501f7a00>]}
08:17:36.846723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb6ca5b-9f05-44dc-abb5-0d25fb429836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b51240f10>]}
08:17:36.846943 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:17:36.847124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb6ca5b-9f05-44dc-abb5-0d25fb429836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b512b7850>]}
08:17:36.847586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b512b7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b512407c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b51240cd0>]}


============================== 2022-07-28 08:17:38.442215 | 70922544-10a8-4035-90b5-754cd544821e ==============================
[0m08:17:38.442233 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:17:38.442587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:17:38.442700 [debug] [MainThread]: Tracking: tracking
[0m08:17:38.442882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3310743ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3310743f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3310743fa0>]}
[0m08:17:38.453512 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m08:17:38.453741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70922544-10a8-4035-90b5-754cd544821e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33107698b0>]}
[0m08:17:38.461837 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:17:38.493062 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:17:38.494458 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:17:38.495141 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:17:38.497867 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:17:38.504402 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:17:38.506996 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:17:38.508010 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:17:38.511599 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:17:38.511963 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:17:38.512365 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:17:38.512859 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:17:38.513292 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:17:38.520242 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:17:38.530733 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:17:38.534101 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:17:38.536380 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:17:38.546687 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:17:38.548889 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:17:38.550583 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:17:38.556015 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:17:38.558427 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:17:38.559698 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:17:38.560811 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:17:38.567175 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:17:38.570436 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:17:38.571008 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:17:38.571653 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:17:38.572320 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:17:38.573510 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:17:38.575520 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:17:38.578512 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:17:38.579884 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:17:38.581221 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:17:38.584521 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:17:38.598244 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:17:38.603959 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:17:38.605239 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:17:38.613686 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:17:38.625833 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:17:38.635350 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:17:38.646915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:17:38.659100 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:17:38.665573 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:17:38.666724 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:17:38.669960 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:17:38.672399 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:17:38.673361 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:17:38.677265 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:17:38.678983 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:17:38.680960 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:17:38.684968 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:17:38.686671 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:17:38.688233 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:17:38.688930 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:17:38.689865 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:17:38.690667 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:17:38.691382 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:17:38.692115 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:17:38.693095 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:17:38.693931 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:17:38.695419 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:17:38.696140 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:17:38.696876 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:17:38.697723 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:17:38.698517 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:17:38.699337 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:17:38.700267 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:17:38.701099 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:17:38.705346 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:17:38.705976 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:17:38.706604 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:17:38.707911 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:17:38.889398 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:17:38.913768 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m08:17:38.917042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70922544-10a8-4035-90b5-754cd544821e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3310683e80>]}
[0m08:17:38.920625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70922544-10a8-4035-90b5-754cd544821e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f331068daf0>]}
[0m08:17:38.920826 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:17:38.921021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70922544-10a8-4035-90b5-754cd544821e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f331075be80>]}
[0m08:17:38.921815 [info ] [MainThread]: 
[0m08:17:38.922169 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:17:38.922753 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:17:38.961532 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:17:38.961707 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:17:38.961796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:39.594439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.63 seconds
[0m08:17:39.596180 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:17:39.689461 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:17:39.694356 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:17:39.694524 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:17:39.694615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:40.256683 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.56 seconds
[0m08:17:40.257783 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:17:40.365969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70922544-10a8-4035-90b5-754cd544821e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3313fb32e0>]}
[0m08:17:40.366479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:17:40.366717 [info ] [MainThread]: 
[0m08:17:40.369648 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m08:17:40.369937 [info ] [Thread-1  ]: 1 of 1 START view model dev.src_listings ....................................... [RUN]
[0m08:17:40.370526 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:17:40.370646 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m08:17:40.370773 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_listings
[0m08:17:40.371962 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:17:40.372235 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:40.372352 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m08:17:40.393752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:17:40.394353 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:17:40.394461 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    with raw_listing as (
    select * from "AIRBNB"."RAW"."RAW_LISTINGS"
)
select
	id as listing_id,
	listing_url,
	name as listing_name,
	room_type,
	minimum_nights,
	host_id,
	price as price_str,
	created_at,
	updated_at
FROM raw_listings
  );
[0m08:17:40.394567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:17:40.759870 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5e791-3201-068e-0000-0000d015a0f5
[0m08:17:40.760052 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m08:17:40.760245 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:40.760370 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m08:17:40.875656 [debug] [Thread-1  ]: Database Error in model src_listings (models/src/src_listings.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
  compiled SQL at target/run/dbtlearn/models/src/src_listings.sql
[0m08:17:40.875945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70922544-10a8-4035-90b5-754cd544821e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33006b4c40>]}
[0m08:17:40.876219 [error] [Thread-1  ]: 1 of 1 ERROR creating view model dev.src_listings .............................. [[31mERROR[0m in 0.51s]
[0m08:17:40.876540 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m08:17:40.877793 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:17:40.878021 [info ] [MainThread]: 
[0m08:17:40.878203 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m08:17:40.878381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:40.878471 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:17:40.882914 [info ] [MainThread]: 
[0m08:17:40.883118 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:17:40.883357 [info ] [MainThread]: 
[0m08:17:40.883525 [error] [MainThread]: [33mDatabase Error in model src_listings (models/src/src_listings.sql)[0m
[0m08:17:40.883693 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m08:17:40.883849 [error] [MainThread]:   Object 'AIRBNB.DEV.RAW_LISTINGS' does not exist or not authorized.
[0m08:17:40.884005 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/src/src_listings.sql
[0m08:17:40.884170 [info ] [MainThread]: 
[0m08:17:40.884336 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:17:40.884576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3301b11940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3301b114f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3301b11250>]}


============================== 2022-07-28 08:22:00.635307 | 19e9c126-a24a-4c32-84af-a350417210a6 ==============================
08:22:00.635317 [info ] [MainThread]: Running with dbt=1.1.1
08:22:00.635582 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:22:00.635694 [debug] [MainThread]: Tracking: tracking
08:22:00.635895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251855e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa425185640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251856a0>]}
08:22:00.647307 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
08:22:00.647510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19e9c126-a24a-4c32-84af-a350417210a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251aaa90>]}
08:22:00.657021 [debug] [MainThread]: Parsing macros/adapters.sql
08:22:00.684425 [debug] [MainThread]: Parsing macros/catalog.sql
08:22:00.685836 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:22:00.686527 [debug] [MainThread]: Parsing macros/materializations/merge.sql
08:22:00.689381 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:22:00.695640 [debug] [MainThread]: Parsing macros/materializations/table.sql
08:22:00.697973 [debug] [MainThread]: Parsing macros/materializations/view.sql
08:22:00.698959 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:22:00.702742 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:22:00.709688 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:22:00.716494 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:22:00.719817 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:22:00.721995 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:22:00.723976 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:22:00.725541 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:22:00.731103 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:22:00.732982 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:22:00.734252 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:22:00.735382 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:22:00.741759 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:22:00.745058 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:22:00.745594 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:22:00.746235 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:22:00.746890 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:22:00.747942 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:22:00.749703 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:22:00.752777 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:22:00.754170 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:22:00.755510 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:22:00.759044 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:22:00.771474 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:22:00.776197 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:22:00.777370 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:22:00.785445 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:22:00.797831 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:22:00.807058 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:22:00.818144 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:22:00.829694 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:22:00.836689 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:22:00.837858 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:22:00.841106 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:22:00.843091 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:22:00.844077 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:22:00.849021 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:22:00.850821 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:22:00.853148 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:22:00.858404 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:22:01.009153 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
08:22:01.027151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:22:01.030092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19e9c126-a24a-4c32-84af-a350417210a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251ebc10>]}
08:22:01.032893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19e9c126-a24a-4c32-84af-a350417210a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4250cae50>]}
08:22:01.033136 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:22:01.033293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19e9c126-a24a-4c32-84af-a350417210a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa425185df0>]}
08:22:01.033767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251855e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251eb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4251eba90>]}


============================== 2022-07-28 08:22:42.646152 | 0af55fe9-16db-4ae8-acbd-6a94d93323ad ==============================
[0m08:22:42.646170 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:22:42.646517 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:22:42.646628 [debug] [MainThread]: Tracking: tracking
[0m08:22:42.646819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edab4ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edab4ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edab4efd0>]}
[0m08:22:42.657993 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m08:22:42.658237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0af55fe9-16db-4ae8-acbd-6a94d93323ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edab6a880>]}
[0m08:22:42.665609 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:22:42.695994 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:22:42.697534 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:22:42.698279 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:22:42.701300 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:22:42.708808 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:22:42.711696 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:22:42.712800 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:22:42.716884 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:22:42.717336 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:22:42.717785 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:22:42.718282 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:22:42.718844 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:22:42.726297 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:22:42.737538 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:22:42.741094 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:22:42.743325 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:22:42.753756 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:22:42.755939 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:22:42.757598 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:22:42.762992 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:22:42.765108 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:22:42.766290 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:22:42.767380 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:22:42.773424 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:22:42.776742 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:22:42.777285 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:22:42.777895 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:22:42.778541 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:22:42.779742 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:22:42.781411 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:22:42.784383 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:22:42.785768 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:22:42.787141 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:22:42.790451 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:22:42.804178 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:22:42.809521 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:22:42.810923 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:22:42.819563 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:22:42.832011 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:22:42.841279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:22:42.852762 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:22:42.864462 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:22:42.871262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:22:42.872414 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:22:42.875666 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:22:42.878093 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:22:42.879066 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:22:42.882930 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:22:42.884642 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:22:42.886769 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:22:42.890916 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:22:42.892659 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:22:42.894211 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:22:42.894917 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:22:42.895860 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:22:42.896666 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:22:42.897385 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:22:42.898096 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:22:42.899052 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:22:42.899885 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:22:42.901311 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:22:42.902035 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:22:42.902831 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:22:42.903866 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:22:42.904840 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:22:42.905734 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:22:42.906675 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:22:42.907487 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:22:42.911800 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:22:42.912434 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:22:42.913063 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:22:42.913894 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:22:43.099853 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:22:43.122688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m08:22:43.125963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af55fe9-16db-4ae8-acbd-6a94d93323ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edaa85f10>]}
[0m08:22:43.129319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af55fe9-16db-4ae8-acbd-6a94d93323ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edaa8db20>]}
[0m08:22:43.129500 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:22:43.129686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af55fe9-16db-4ae8-acbd-6a94d93323ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edab7ac10>]}
[0m08:22:43.130452 [info ] [MainThread]: 
[0m08:22:43.130772 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:22:43.131345 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:22:43.170852 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:22:43.171060 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:22:43.171150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:43.959550 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.79 seconds
[0m08:22:43.960859 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:22:44.066381 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:22:44.071359 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:22:44.071536 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:22:44.071644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:44.634531 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.56 seconds
[0m08:22:44.635464 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:22:44.736225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af55fe9-16db-4ae8-acbd-6a94d93323ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ed8a400a0>]}
[0m08:22:44.736696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:22:44.736914 [info ] [MainThread]: 
[0m08:22:44.740156 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m08:22:44.740408 [info ] [Thread-1  ]: 1 of 1 START view model dev.src_listings ....................................... [RUN]
[0m08:22:44.740976 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:22:44.741101 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m08:22:44.741232 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_listings
[0m08:22:44.742384 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:22:44.742642 [debug] [Thread-1  ]: finished collecting timing info
[0m08:22:44.742763 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m08:22:44.761374 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:22:44.761945 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:22:44.762051 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:22:44.762149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:22:45.481259 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m08:22:45.494009 [debug] [Thread-1  ]: finished collecting timing info
[0m08:22:45.494228 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m08:22:45.588172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af55fe9-16db-4ae8-acbd-6a94d93323ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e93be0ac0>]}
[0m08:22:45.588517 [info ] [Thread-1  ]: 1 of 1 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.85s]
[0m08:22:45.588846 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m08:22:45.590112 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:22:45.590344 [info ] [MainThread]: 
[0m08:22:45.590531 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m08:22:45.590713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:45.590807 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:22:45.595317 [info ] [MainThread]: 
[0m08:22:45.595512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:22:45.595730 [info ] [MainThread]: 
[0m08:22:45.595958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:22:45.596210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9067e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9067e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9067e070>]}


============================== 2022-07-28 08:32:48.365612 | ac3011d5-e2b6-42bb-8e2c-7ed6252101b7 ==============================
08:32:48.365622 [info ] [MainThread]: Running with dbt=1.1.1
08:32:48.365887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:32:48.366007 [debug] [MainThread]: Tracking: tracking
08:32:48.366209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6c7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6c7730>]}
08:32:48.379006 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
08:32:48.379244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac3011d5-e2b6-42bb-8e2c-7ed6252101b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6edb20>]}
08:32:48.385242 [debug] [MainThread]: Parsing macros/adapters.sql
08:32:48.412675 [debug] [MainThread]: Parsing macros/catalog.sql
08:32:48.414088 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:32:48.414784 [debug] [MainThread]: Parsing macros/materializations/merge.sql
08:32:48.417573 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:32:48.423505 [debug] [MainThread]: Parsing macros/materializations/table.sql
08:32:48.425912 [debug] [MainThread]: Parsing macros/materializations/view.sql
08:32:48.427031 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:32:48.430939 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:32:48.437899 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:32:48.445082 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:32:48.448602 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:32:48.450960 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:32:48.453146 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:32:48.454785 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:32:48.460572 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:32:48.463762 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:32:48.465535 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:32:48.467007 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:32:48.473375 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:32:48.477562 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:32:48.478188 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:32:48.478833 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:32:48.479567 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:32:48.480610 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:32:48.482418 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:32:48.485237 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:32:48.486612 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:32:48.487890 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:32:48.491303 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:32:48.503325 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:32:48.507895 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:32:48.509194 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:32:48.517305 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:32:48.529694 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:32:48.539333 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:32:48.550496 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:32:48.562718 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:32:48.570141 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:32:48.571283 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:32:48.574619 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:32:48.576602 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:32:48.577668 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:32:48.582596 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:32:48.584361 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:32:48.586495 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:32:48.592459 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:32:48.746008 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
08:32:48.753729 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
08:32:48.766412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:32:48.769447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac3011d5-e2b6-42bb-8e2c-7ed6252101b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a681d30>]}
08:32:48.772172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac3011d5-e2b6-42bb-8e2c-7ed6252101b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6ef700>]}
08:32:48.772371 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:32:48.772529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac3011d5-e2b6-42bb-8e2c-7ed6252101b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6c7670>]}
08:32:48.772971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a63ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a61b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a62c640>]}


============================== 2022-07-28 08:33:10.701783 | 97b27356-7013-4d75-b330-acb249462675 ==============================
[0m08:33:10.701799 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:33:10.702248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:33:10.702420 [debug] [MainThread]: Tracking: tracking
[0m08:33:10.702651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d17de100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d17de160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d17de1c0>]}
[0m08:33:10.714084 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m08:33:10.714357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d17facd0>]}
[0m08:33:10.722313 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:33:10.755099 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:33:10.756566 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:33:10.757312 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:33:10.760106 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:33:10.766759 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:33:10.769580 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:33:10.770581 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:33:10.774469 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:33:10.774835 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:33:10.775248 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:33:10.775743 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:33:10.776182 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:33:10.783377 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:33:10.794108 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:33:10.797526 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:33:10.799693 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:33:10.809733 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:33:10.811848 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:33:10.813503 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:33:10.818764 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:33:10.820813 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:33:10.821987 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:33:10.823083 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:33:10.829201 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:33:10.832431 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:33:10.832990 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:33:10.833604 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:33:10.834254 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:33:10.835304 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:33:10.837036 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:33:10.840042 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:33:10.841396 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:33:10.842704 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:33:10.846003 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:33:10.859342 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:33:10.864451 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:33:10.865687 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:33:10.874031 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:33:10.886470 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:33:10.896238 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:33:10.907830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:33:10.920212 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:33:10.927385 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:33:10.928681 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:33:10.932032 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:33:10.934575 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:33:10.935657 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:33:10.939956 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:33:10.941932 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:33:10.944171 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:33:10.948369 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:33:10.950244 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:33:10.952400 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:33:10.953762 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:33:10.954885 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:33:10.955748 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:33:10.956492 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:33:10.957264 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:33:10.958258 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:33:10.959139 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:33:10.960657 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:33:10.961413 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:33:10.962206 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:33:10.963071 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:33:10.963876 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:33:10.964728 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:33:10.965704 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:33:10.966545 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:33:10.972022 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:33:10.972798 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:33:10.973458 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:33:10.974440 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:33:11.159541 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:33:11.167939 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:33:11.184690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m08:33:11.188261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d00b35e0>]}
[0m08:33:11.192024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d00f1fd0>]}
[0m08:33:11.192245 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:33:11.192444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d17de1c0>]}
[0m08:33:11.193315 [info ] [MainThread]: 
[0m08:33:11.193656 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:33:11.194342 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:33:11.236008 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:33:11.236219 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:33:11.236338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:12.046854 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m08:33:12.048173 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:33:12.136798 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:33:12.141711 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:33:12.141848 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:33:12.141953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:13.115311 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.97 seconds
[0m08:33:13.116620 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:33:13.226085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d00b86d0>]}
[0m08:33:13.226520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:33:13.226743 [info ] [MainThread]: 
[0m08:33:13.229978 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m08:33:13.230496 [info ] [Thread-1  ]: 1 of 2 START view model dev.src_listings ....................................... [RUN]
[0m08:33:13.230714 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_reviews
[0m08:33:13.231159 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:33:13.231400 [info ] [Thread-2  ]: 2 of 2 START view model dev.src_reviews ........................................ [RUN]
[0m08:33:13.231605 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m08:33:13.232006 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:33:13.232153 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_listings
[0m08:33:13.232342 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:33:13.233616 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:33:13.233811 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_reviews
[0m08:33:13.234812 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:33:13.235039 [debug] [Thread-1  ]: finished collecting timing info
[0m08:33:13.235308 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m08:33:13.246392 [debug] [Thread-2  ]: finished collecting timing info
[0m08:33:13.251801 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_reviews
[0m08:33:13.263480 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:33:13.265091 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:33:13.265777 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:33:13.265903 [debug] [Thread-2  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:33:13.266326 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:33:13.266477 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:33:13.266670 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:33:13.268476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:33:14.077150 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m08:33:14.089874 [debug] [Thread-1  ]: finished collecting timing info
[0m08:33:14.090067 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m08:33:14.194804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a04fb820>]}
[0m08:33:14.195170 [info ] [Thread-1  ]: 1 of 2 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.96s]
[0m08:33:14.195523 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m08:33:14.544238 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m08:33:14.545534 [debug] [Thread-2  ]: finished collecting timing info
[0m08:33:14.545668 [debug] [Thread-2  ]: On model.dbtlearn.src_reviews: Close
[0m08:33:14.647982 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b27356-7013-4d75-b330-acb249462675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a2983b20>]}
[0m08:33:14.648331 [info ] [Thread-2  ]: 2 of 2 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.42s]
[0m08:33:14.648635 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_reviews
[0m08:33:14.649841 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:33:14.650101 [info ] [MainThread]: 
[0m08:33:14.650298 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m08:33:14.650487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:14.650581 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:33:14.650675 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m08:33:14.654954 [info ] [MainThread]: 
[0m08:33:14.655349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:33:14.655692 [info ] [MainThread]: 
[0m08:33:14.655941 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:33:14.656218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d00b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56d00b3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a0548a60>]}


============================== 2022-07-28 08:38:36.199707 | 678a3d40-32ac-44ad-81b2-95e086b5944d ==============================
08:38:36.199719 [info ] [MainThread]: Running with dbt=1.1.1
08:38:36.200000 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
08:38:36.200122 [debug] [MainThread]: Tracking: tracking
08:38:36.200332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e3856d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e385730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e385790>]}
08:38:36.212311 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
08:38:36.212563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '678a3d40-32ac-44ad-81b2-95e086b5944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e3aab80>]}
08:38:36.218554 [debug] [MainThread]: Parsing macros/adapters.sql
08:38:36.246524 [debug] [MainThread]: Parsing macros/catalog.sql
08:38:36.248001 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:38:36.248754 [debug] [MainThread]: Parsing macros/materializations/merge.sql
08:38:36.251543 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:38:36.259068 [debug] [MainThread]: Parsing macros/materializations/table.sql
08:38:36.261407 [debug] [MainThread]: Parsing macros/materializations/view.sql
08:38:36.262424 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:38:36.266231 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:38:36.273322 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:38:36.280760 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:38:36.284054 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:38:36.286485 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:38:36.288533 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:38:36.290133 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:38:36.295381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:38:36.297331 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:38:36.298518 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:38:36.299719 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:38:36.306179 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:38:36.309983 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:38:36.310810 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:38:36.311550 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:38:36.312250 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:38:36.313384 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:38:36.315252 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:38:36.318257 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:38:36.319648 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:38:36.321035 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:38:36.324728 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:38:36.338785 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:38:36.343778 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:38:36.345141 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:38:36.352826 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:38:36.365619 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:38:36.375724 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:38:36.389197 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:38:36.401781 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:38:36.409364 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:38:36.410609 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:38:36.414009 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:38:36.416036 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:38:36.417019 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:38:36.421935 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:38:36.423728 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:38:36.426227 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:38:36.431687 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:38:36.589503 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
08:38:36.597604 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
08:38:36.599299 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
08:38:36.611415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

08:38:36.614547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '678a3d40-32ac-44ad-81b2-95e086b5944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e2e2130>]}
08:38:36.617400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '678a3d40-32ac-44ad-81b2-95e086b5944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e3add00>]}
08:38:36.617598 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 181 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:38:36.617751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678a3d40-32ac-44ad-81b2-95e086b5944d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e3aa670>]}
08:38:36.618211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e2ccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e2f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83e2f8e20>]}


============================== 2022-07-28 08:38:39.522190 | 8001220b-9556-4e25-93b3-4e4c9fadc7d1 ==============================
[0m08:38:39.522208 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:38:39.522575 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:38:39.522697 [debug] [MainThread]: Tracking: tracking
[0m08:38:39.522905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dd021f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dd021f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dd021fd0>]}
[0m08:38:39.535089 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m08:38:39.535383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dd03c880>]}
[0m08:38:39.543781 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:38:39.577270 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:38:39.578936 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:38:39.579778 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:38:39.582786 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:38:39.589816 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:38:39.592622 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:38:39.593739 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:38:39.597887 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:38:39.598278 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:38:39.598699 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:38:39.599273 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:38:39.599728 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:38:39.607081 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:38:39.618391 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:38:39.621844 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:38:39.624052 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:38:39.635059 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:38:39.637168 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:38:39.638786 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:38:39.644108 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:38:39.646259 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:38:39.647421 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:38:39.648507 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:38:39.654477 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:38:39.657706 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:38:39.658234 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:38:39.658911 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:38:39.659566 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:38:39.660662 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:38:39.662475 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:38:39.665536 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:38:39.666890 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:38:39.668136 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:38:39.671408 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:38:39.684379 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:38:39.689401 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:38:39.690633 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:38:39.698893 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:38:39.711201 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:38:39.720642 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:38:39.732040 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:38:39.744011 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:38:39.750884 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:38:39.752021 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:38:39.755320 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:38:39.757739 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:38:39.758703 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:38:39.762536 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:38:39.764302 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:38:39.766413 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:38:39.770481 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:38:39.772213 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:38:39.773792 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:38:39.774500 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:38:39.775440 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:38:39.776239 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:38:39.776960 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:38:39.777708 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:38:39.778675 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:38:39.779532 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:38:39.781007 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:38:39.781731 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:38:39.782476 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:38:39.783352 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:38:39.784147 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:38:39.785029 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:38:39.785990 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:38:39.786769 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:38:39.791044 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:38:39.791683 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:38:39.792316 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:38:39.793153 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:38:39.976284 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:38:39.984406 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:38:39.986093 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:38:40.002970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m08:38:40.006309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d9eaa730>]}
[0m08:38:40.010417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06dbf0fd60>]}
[0m08:38:40.010691 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:38:40.010910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d9eecee0>]}
[0m08:38:40.011867 [info ] [MainThread]: 
[0m08:38:40.012247 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:38:40.012986 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:38:40.056521 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:38:40.056700 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:38:40.056808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:40.708950 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.65 seconds
[0m08:38:40.710288 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:38:40.807185 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:38:40.815453 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:38:40.815623 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:38:40.815738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:41.352065 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.54 seconds
[0m08:38:41.353235 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:38:41.447018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06e2a32f40>]}
[0m08:38:41.447487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:41.447718 [info ] [MainThread]: 
[0m08:38:41.451446 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:38:41.451662 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:38:41.451921 [info ] [Thread-1  ]: 1 of 3 START view model dev.src_hosts .......................................... [RUN]
[0m08:38:41.452109 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:38:41.452400 [info ] [Thread-2  ]: 2 of 3 START view model dev.src_listings ....................................... [RUN]
[0m08:38:41.452927 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:38:41.453176 [info ] [Thread-3  ]: 3 of 3 START view model dev.src_reviews ........................................ [RUN]
[0m08:38:41.453584 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:38:41.453781 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:38:41.454197 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:38:41.454381 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:38:41.454598 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:38:41.454783 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:38:41.454969 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:38:41.456253 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:38:41.456457 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:38:41.457517 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:38:41.458754 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:38:41.459278 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:41.459660 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:38:41.475578 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:41.481180 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:41.481429 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:38:41.484937 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:38:41.485250 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:38:41.487284 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:38:41.489222 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:38:41.489832 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:38:41.490302 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:38:41.490549 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:38:41.490775 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:38:41.491163 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:38:41.491361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:41.491567 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:38:41.491764 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:38:41.494528 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:38:42.170495 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m08:38:42.185091 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:42.185314 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:38:42.225223 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.73 seconds
[0m08:38:42.228574 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:42.228727 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:38:42.275565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d9eaa700>]}
[0m08:38:42.275880 [info ] [Thread-1  ]: 1 of 3 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.82s]
[0m08:38:42.276234 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:38:42.339335 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d8fb07f0>]}
[0m08:38:42.339649 [info ] [Thread-3  ]: 3 of 3 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.89s]
[0m08:38:42.339958 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:38:42.440540 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m08:38:42.442049 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:42.442193 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:38:42.528726 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8001220b-9556-4e25-93b3-4e4c9fadc7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d8f91f10>]}
[0m08:38:42.529087 [info ] [Thread-2  ]: 2 of 3 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.08s]
[0m08:38:42.529420 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:38:42.530574 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:38:42.530828 [info ] [MainThread]: 
[0m08:38:42.531024 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m08:38:42.531213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:42.531308 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m08:38:42.531402 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:38:42.531495 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m08:38:42.536090 [info ] [MainThread]: 
[0m08:38:42.536345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:42.536567 [info ] [MainThread]: 
[0m08:38:42.536747 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:38:42.537021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d8f8ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d9ea4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06d9139ca0>]}


============================== 2022-07-28 09:57:08.788020 | 7a6dab06-f10d-41ed-a7cf-5f1e77a8dc0a ==============================
[0m09:57:08.788038 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:57:08.788348 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m09:57:08.788459 [debug] [MainThread]: Tracking: tracking
[0m09:57:08.788660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470dab8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470dab8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470dad5040>]}
[0m09:57:08.810206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:08.810382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:08.810707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m09:57:08.814796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a6dab06-f10d-41ed-a7cf-5f1e77a8dc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470c943c70>]}
[0m09:57:08.819147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a6dab06-f10d-41ed-a7cf-5f1e77a8dc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470c9d5b20>]}
[0m09:57:08.819388 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:57:08.819536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a6dab06-f10d-41ed-a7cf-5f1e77a8dc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470c9a7d90>]}
[0m09:57:08.819982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470dad5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470c9d54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470c9d5b50>]}


============================== 2022-07-28 10:35:45.989000 | 978e10d7-3fc9-40dd-84f4-6570a76cdc89 ==============================
[0m10:35:45.989017 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:35:45.989306 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:35:45.989417 [debug] [MainThread]: Tracking: tracking
[0m10:35:45.989609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56fcdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56fcdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56fcdfd0>]}
[0m10:35:46.008890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:35:46.009135 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m10:35:46.017937 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m10:35:46.028596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:35:46.031877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '978e10d7-3fc9-40dd-84f4-6570a76cdc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd54e3f460>]}
[0m10:35:46.035618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '978e10d7-3fc9-40dd-84f4-6570a76cdc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56f30f40>]}
[0m10:35:46.035839 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:35:46.035992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978e10d7-3fc9-40dd-84f4-6570a76cdc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56f27d60>]}
[0m10:35:46.036470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56f27d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56f30b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd56f301c0>]}


============================== 2022-07-28 10:37:20.882013 | cc59a940-bc8f-4468-92a4-d94376f0053c ==============================
[0m10:37:20.882029 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:37:20.882370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:37:20.882479 [debug] [MainThread]: Tracking: tracking
[0m10:37:20.882669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b93d0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b93d0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b93d0f10>]}
[0m10:37:20.908203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:20.908377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:20.908677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:37:20.912823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b92c5ee0>]}
[0m10:37:20.917011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b9352d90>]}
[0m10:37:20.917229 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:37:20.917412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b9329f10>]}
[0m10:37:20.918287 [info ] [MainThread]: 
[0m10:37:20.918602 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:37:20.919286 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m10:37:20.928201 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m10:37:20.928367 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m10:37:20.928467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:21.665362 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.74 seconds
[0m10:37:21.666629 [debug] [ThreadPool]: On list_airbnb: Close
[0m10:37:21.873182 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m10:37:21.877811 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m10:37:21.877955 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m10:37:21.878068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:22.227250 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.35 seconds
[0m10:37:22.228337 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m10:37:22.338066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b93ef880>]}
[0m10:37:22.338470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:37:22.338676 [info ] [MainThread]: 
[0m10:37:22.342840 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m10:37:22.343104 [info ] [Thread-1  ]: 1 of 4 START view model dev.src_hosts .......................................... [RUN]
[0m10:37:22.343734 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m10:37:22.343894 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m10:37:22.344057 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m10:37:22.344212 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m10:37:22.344423 [info ] [Thread-2  ]: 2 of 4 START view model dev.src_listings ....................................... [RUN]
[0m10:37:22.344686 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m10:37:22.344916 [info ] [Thread-3  ]: 3 of 4 START view model dev.src_reviews ........................................ [RUN]
[0m10:37:22.345264 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m10:37:22.346407 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m10:37:22.346804 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m10:37:22.346990 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m10:37:22.347254 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m10:37:22.347507 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m10:37:22.347640 [debug] [Thread-1  ]: finished collecting timing info
[0m10:37:22.347829 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m10:37:22.348743 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m10:37:22.348946 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m10:37:22.349833 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m10:37:22.365954 [debug] [Thread-3  ]: finished collecting timing info
[0m10:37:22.369455 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m10:37:22.369613 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m10:37:22.369748 [debug] [Thread-2  ]: finished collecting timing info
[0m10:37:22.371737 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m10:37:22.371994 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m10:37:22.373705 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m10:37:22.374267 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m10:37:22.374403 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m10:37:22.374532 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:37:22.374857 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m10:37:22.376657 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m10:37:22.376835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:37:22.377616 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m10:37:22.377734 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m10:37:22.377848 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:37:23.449429 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.07 seconds
[0m10:37:23.462588 [debug] [Thread-3  ]: finished collecting timing info
[0m10:37:23.462755 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m10:37:23.478962 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.1 seconds
[0m10:37:23.480349 [debug] [Thread-2  ]: finished collecting timing info
[0m10:37:23.480473 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m10:37:23.551696 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.17 seconds
[0m10:37:23.553153 [debug] [Thread-1  ]: finished collecting timing info
[0m10:37:23.553300 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m10:37:23.554859 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8429280>]}
[0m10:37:23.555238 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.21s]
[0m10:37:23.555551 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m10:37:23.577455 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8429550>]}
[0m10:37:23.577793 [info ] [Thread-2  ]: 2 of 4 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.23s]
[0m10:37:23.578081 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m10:37:23.578577 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m10:37:23.578755 [info ] [Thread-4  ]: 4 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m10:37:23.579075 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:37:23.579190 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m10:37:23.579307 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m10:37:23.581368 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:37:23.581694 [debug] [Thread-4  ]: finished collecting timing info
[0m10:37:23.581799 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m10:37:23.583477 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:37:23.584083 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:37:23.584182 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimun_nights =0 then 1
        else minimun_nights
    end as minimun_nights
    host_id,
    replace(
        price_str,
        "$"
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m10:37:23.584273 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:37:23.680894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8133580>]}
[0m10:37:23.686425 [info ] [Thread-1  ]: 1 of 4 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.34s]
[0m10:37:23.686755 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m10:37:23.982505 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a5e81d-3201-06b2-0000-d0150001500a
[0m10:37:23.982668 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 4 unexpected 'host_id'.
[0m10:37:23.982846 [debug] [Thread-4  ]: finished collecting timing info
[0m10:37:23.982959 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m10:37:24.078463 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'host_id'.
  compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m10:37:24.078751 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc59a940-bc8f-4468-92a4-d94376f0053c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b80acdc0>]}
[0m10:37:24.079044 [error] [Thread-4  ]: 4 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 0.50s]
[0m10:37:24.079383 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m10:37:24.080595 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:37:24.080831 [info ] [MainThread]: 
[0m10:37:24.081022 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m10:37:24.081280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:24.081370 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m10:37:24.081456 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m10:37:24.081540 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m10:37:24.081624 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m10:37:24.085490 [info ] [MainThread]: 
[0m10:37:24.085668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:37:24.085881 [info ] [MainThread]: 
[0m10:37:24.086045 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m10:37:24.086202 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m10:37:24.086353 [error] [MainThread]:   syntax error line 15 at position 4 unexpected 'host_id'.
[0m10:37:24.086503 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m10:37:24.086661 [info ] [MainThread]: 
[0m10:37:24.086816 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:37:24.087035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8412940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8412250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25b8412760>]}


============================== 2022-07-28 10:38:00.842921 | 5dde5ab8-ec2e-4c57-af9a-850126157e94 ==============================
[0m10:38:00.842939 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:38:00.843255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:38:00.843368 [debug] [MainThread]: Tracking: tracking
[0m10:38:00.843578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3b4ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3b4eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3b4ef10>]}
[0m10:38:00.865719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:00.866031 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m10:38:00.875803 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m10:38:00.893230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:38:00.896674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dde5ab8-ec2e-4c57-af9a-850126157e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b19fb790>]}
[0m10:38:00.900558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dde5ab8-ec2e-4c57-af9a-850126157e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3aa9dc0>]}
[0m10:38:00.900777 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:38:00.900933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dde5ab8-ec2e-4c57-af9a-850126157e94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3b4bb50>]}
[0m10:38:00.901420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3aa9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3b37910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79b3b37bb0>]}


============================== 2022-07-28 10:38:01.655742 | 55cc6331-e492-4d6e-8649-a17c514daa18 ==============================
[0m10:38:01.655759 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:38:01.656102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:38:01.656206 [debug] [MainThread]: Tracking: tracking
[0m10:38:01.656393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f218949adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f218949ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f218949aeb0>]}
[0m10:38:01.675962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:38:01.676112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:38:01.676394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:38:01.680150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2188386e80>]}
[0m10:38:01.684104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2189416d30>]}
[0m10:38:01.684410 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:38:01.684599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21883e9eb0>]}
[0m10:38:01.685487 [info ] [MainThread]: 
[0m10:38:01.685805 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:38:01.686772 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m10:38:01.695578 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m10:38:01.695730 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m10:38:01.695809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:02.226711 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
[0m10:38:02.228320 [debug] [ThreadPool]: On list_airbnb: Close
[0m10:38:02.327775 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m10:38:02.332488 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m10:38:02.332604 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m10:38:02.332705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:02.892561 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.56 seconds
[0m10:38:02.893586 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m10:38:02.978111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21895331f0>]}
[0m10:38:02.978518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:02.978716 [info ] [MainThread]: 
[0m10:38:02.981699 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m10:38:02.981904 [info ] [Thread-1  ]: 1 of 4 START view model dev.src_hosts .......................................... [RUN]
[0m10:38:02.982447 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m10:38:02.982575 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m10:38:02.982709 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m10:38:02.983798 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m10:38:02.984010 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m10:38:02.984292 [info ] [Thread-2  ]: 2 of 4 START view model dev.src_listings ....................................... [RUN]
[0m10:38:02.984564 [debug] [Thread-1  ]: finished collecting timing info
[0m10:38:02.984915 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m10:38:02.985126 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m10:38:02.985268 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m10:38:02.985460 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m10:38:02.990959 [info ] [Thread-3  ]: 3 of 4 START view model dev.src_reviews ........................................ [RUN]
[0m10:38:03.004496 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m10:38:03.004685 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m10:38:03.005112 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m10:38:03.006341 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m10:38:03.006714 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m10:38:03.006899 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m10:38:03.007249 [debug] [Thread-2  ]: finished collecting timing info
[0m10:38:03.007392 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m10:38:03.007573 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m10:38:03.007760 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m10:38:03.007931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:38:03.008884 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m10:38:03.010560 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m10:38:03.012794 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m10:38:03.012921 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m10:38:03.013034 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:38:03.013173 [debug] [Thread-3  ]: finished collecting timing info
[0m10:38:03.014800 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m10:38:03.017297 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m10:38:03.017881 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m10:38:03.018133 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m10:38:03.018244 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:38:03.750631 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m10:38:03.763098 [debug] [Thread-1  ]: finished collecting timing info
[0m10:38:03.763275 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m10:38:03.848466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2180753d60>]}
[0m10:38:03.848811 [info ] [Thread-1  ]: 1 of 4 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.87s]
[0m10:38:03.849122 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m10:38:03.928162 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.91 seconds
[0m10:38:03.929533 [debug] [Thread-3  ]: finished collecting timing info
[0m10:38:03.929661 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m10:38:03.973210 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.96 seconds
[0m10:38:03.974658 [debug] [Thread-2  ]: finished collecting timing info
[0m10:38:03.974783 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m10:38:04.021717 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f218073f2b0>]}
[0m10:38:04.022031 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.02s]
[0m10:38:04.022333 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m10:38:04.071110 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2180762d90>]}
[0m10:38:04.071421 [info ] [Thread-2  ]: 2 of 4 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.09s]
[0m10:38:04.071729 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m10:38:04.072407 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m10:38:04.072609 [info ] [Thread-4  ]: 4 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m10:38:04.072930 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:38:04.073033 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m10:38:04.073158 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m10:38:04.075154 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:38:04.075435 [debug] [Thread-4  ]: finished collecting timing info
[0m10:38:04.075543 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m10:38:04.077219 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:38:04.077791 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:38:04.077892 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimun_nights =0 then 1
        else minimun_nights
    end as minimun_nights,
    host_id,
    replace(
        price_str,
        "$"
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m10:38:04.077986 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:38:04.573579 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a5e81d-3201-06a5-0000-0000d015e215
[0m10:38:04.573741 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 13
invalid identifier 'MINIMUN_NIGHTS'
[0m10:38:04.573922 [debug] [Thread-4  ]: finished collecting timing info
[0m10:38:04.574042 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m10:38:04.667851 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'MINIMUN_NIGHTS'
  compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m10:38:04.668169 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cc6331-e492-4d6e-8649-a17c514daa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21806b93a0>]}
[0m10:38:04.668495 [error] [Thread-4  ]: 4 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 0.60s]
[0m10:38:04.668867 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m10:38:04.670335 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:38:04.670690 [info ] [MainThread]: 
[0m10:38:04.670927 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m10:38:04.671152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:04.671269 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m10:38:04.671386 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m10:38:04.671500 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m10:38:04.671613 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m10:38:04.676211 [info ] [MainThread]: 
[0m10:38:04.676392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:38:04.676577 [info ] [MainThread]: 
[0m10:38:04.676740 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m10:38:04.676898 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 12 at position 13
[0m10:38:04.677051 [error] [MainThread]:   invalid identifier 'MINIMUN_NIGHTS'
[0m10:38:04.677202 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m10:38:04.677384 [info ] [MainThread]: 
[0m10:38:04.677542 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:38:04.677764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2183436bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f218348df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f218348d370>]}


============================== 2022-07-28 10:39:02.409111 | aca35001-778a-4c3d-afcd-76c81b5f0ef6 ==============================
[0m10:39:02.409128 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:39:02.409480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:39:02.409588 [debug] [MainThread]: Tracking: tracking
[0m10:39:02.409782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5c26e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5c26eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5c26f10>]}
[0m10:39:02.429687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:39:02.429994 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m10:39:02.439146 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m10:39:02.450214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:39:02.453558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a408e790>]}
[0m10:39:02.460318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a4b29dc0>]}
[0m10:39:02.460664 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:39:02.460949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5c55b50>]}
[0m10:39:02.462231 [info ] [MainThread]: 
[0m10:39:02.462690 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:39:02.463603 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m10:39:02.472071 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m10:39:02.472199 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m10:39:02.472299 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-07-28 10:39:02.959694 | c4396c61-6110-4465-910d-4d82e284da58 ==============================
[0m10:39:02.959712 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:39:02.960008 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:39:02.960118 [debug] [MainThread]: Tracking: tracking
[0m10:39:02.960304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbdcdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbdcdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbdcdfa0>]}
[0m10:39:02.979746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:02.979906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:02.980195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:39:02.984011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4396c61-6110-4465-910d-4d82e284da58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbcc7f70>]}
[0m10:39:02.988104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4396c61-6110-4465-910d-4d82e284da58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbdb7e20>]}
[0m10:39:02.988314 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:39:02.988463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4396c61-6110-4465-910d-4d82e284da58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbd34040>]}
[0m10:39:02.988913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbd29fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbdb7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61bbdb7af0>]}
[0m10:39:03.075584 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.6 seconds
[0m10:39:03.076894 [debug] [ThreadPool]: On list_airbnb: Close
[0m10:39:03.175011 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m10:39:03.185785 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m10:39:03.186085 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m10:39:03.186314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:03.537369 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.35 seconds
[0m10:39:03.538373 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m10:39:03.627466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05ab638e80>]}
[0m10:39:03.627855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:39:03.628056 [info ] [MainThread]: 
[0m10:39:03.631303 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m10:39:03.631527 [info ] [Thread-1  ]: 1 of 4 START view model dev.src_hosts .......................................... [RUN]
[0m10:39:03.632065 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m10:39:03.632193 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m10:39:03.632325 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m10:39:03.634011 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m10:39:03.634252 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m10:39:03.634597 [info ] [Thread-2  ]: 2 of 4 START view model dev.src_listings ....................................... [RUN]
[0m10:39:03.634986 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m10:39:03.635271 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m10:39:03.635431 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m10:39:03.635618 [debug] [Thread-1  ]: finished collecting timing info
[0m10:39:03.635868 [info ] [Thread-3  ]: 3 of 4 START view model dev.src_reviews ........................................ [RUN]
[0m10:39:03.636139 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m10:39:03.636327 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m10:39:03.636707 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m10:39:03.637707 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m10:39:03.648679 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m10:39:03.657311 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m10:39:03.657704 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m10:39:03.657891 [debug] [Thread-2  ]: finished collecting timing info
[0m10:39:03.659091 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m10:39:03.659485 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m10:39:03.659683 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m10:39:03.659982 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m10:39:03.660187 [debug] [Thread-3  ]: finished collecting timing info
[0m10:39:03.662038 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m10:39:03.662214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:39:03.662406 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m10:39:03.663010 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m10:39:03.666436 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m10:39:03.666690 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m10:39:03.667154 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:39:03.669174 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m10:39:03.669308 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m10:39:03.669405 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:39:04.423827 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m10:39:04.437382 [debug] [Thread-3  ]: finished collecting timing info
[0m10:39:04.437555 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m10:39:04.522535 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m10:39:04.524005 [debug] [Thread-2  ]: finished collecting timing info
[0m10:39:04.524190 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m10:39:04.526294 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5c48d00>]}
[0m10:39:04.526552 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.89s]
[0m10:39:04.526852 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m10:39:04.616205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m10:39:04.618025 [debug] [Thread-1  ]: finished collecting timing info
[0m10:39:04.618175 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m10:39:04.620112 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f059c6680a0>]}
[0m10:39:04.620351 [info ] [Thread-2  ]: 2 of 4 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.99s]
[0m10:39:04.620656 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m10:39:04.621111 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m10:39:04.621283 [info ] [Thread-4  ]: 4 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m10:39:04.621599 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:39:04.621717 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m10:39:04.621835 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m10:39:04.623789 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:39:04.624060 [debug] [Thread-4  ]: finished collecting timing info
[0m10:39:04.624173 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m10:39:04.625975 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:39:04.626536 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:39:04.626636 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        "$"
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m10:39:04.626728 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:39:04.728911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f059c6616a0>]}
[0m10:39:04.734417 [info ] [Thread-1  ]: 1 of 4 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.10s]
[0m10:39:04.734751 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m10:39:05.029720 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a5e81e-3201-069c-0000-d0150001302a
[0m10:39:05.029875 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 8
invalid identifier '"$"'
[0m10:39:05.030055 [debug] [Thread-4  ]: finished collecting timing info
[0m10:39:05.030174 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m10:39:05.131986 [debug] [Thread-4  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier '"$"'
  compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m10:39:05.132412 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca35001-778a-4c3d-afcd-76c81b5f0ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f059dc90d90>]}
[0m10:39:05.132854 [error] [Thread-4  ]: 4 of 4 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 0.51s]
[0m10:39:05.133399 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m10:39:05.135424 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:39:05.135865 [info ] [MainThread]: 
[0m10:39:05.136209 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m10:39:05.136539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:05.136709 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m10:39:05.136882 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m10:39:05.137051 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m10:39:05.137219 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m10:39:05.144254 [info ] [MainThread]: 
[0m10:39:05.144463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:39:05.144667 [info ] [MainThread]: 
[0m10:39:05.144896 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m10:39:05.145120 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 18 at position 8
[0m10:39:05.145359 [error] [MainThread]:   invalid identifier '"$"'
[0m10:39:05.145531 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m10:39:05.145703 [info ] [MainThread]: 
[0m10:39:05.145887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:39:05.146150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f059c668610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f059c668640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a4b52940>]}


============================== 2022-07-28 10:39:21.629292 | 3655e7d4-60cf-496d-898e-e648596c09ad ==============================
[0m10:39:21.629308 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:39:21.629634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:39:21.629741 [debug] [MainThread]: Tracking: tracking
[0m10:39:21.629928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadb4ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadb4eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadb4ef10>]}
[0m10:39:21.649387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:39:21.649711 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m10:39:21.660307 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m10:39:21.671298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:39:21.675915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c77bca790>]}
[0m10:39:21.681150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadaa9dc0>]}
[0m10:39:21.681601 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:39:21.682093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadb4bb50>]}
[0m10:39:21.683769 [info ] [MainThread]: 
[0m10:39:21.684398 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:39:21.685389 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m10:39:21.694205 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m10:39:21.694362 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m10:39:21.694466 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-07-28 10:39:21.794233 | a557cfb6-483c-41bf-bdf5-e0584b19fd81 ==============================
[0m10:39:21.794247 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:39:21.794529 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:39:21.794638 [debug] [MainThread]: Tracking: tracking
[0m10:39:21.794824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880ac8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880ac8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880ac8f70>]}
[0m10:39:21.814565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:21.814720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:21.815014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m10:39:21.818896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a557cfb6-483c-41bf-bdf5-e0584b19fd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87f988f40>]}
[0m10:39:21.822793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a557cfb6-483c-41bf-bdf5-e0584b19fd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880aaddf0>]}
[0m10:39:21.823007 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:39:21.823158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a557cfb6-483c-41bf-bdf5-e0584b19fd81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87f9eaf70>]}
[0m10:39:21.823607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87f9eaf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880aad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe880aadac0>]}
[0m10:39:22.231568 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
[0m10:39:22.232821 [debug] [ThreadPool]: On list_airbnb: Close
[0m10:39:22.323408 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m10:39:22.329234 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m10:39:22.329343 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m10:39:22.329438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:22.844398 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.51 seconds
[0m10:39:22.845447 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m10:39:22.939934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb456ae80>]}
[0m10:39:22.940323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:39:22.940528 [info ] [MainThread]: 
[0m10:39:22.943378 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m10:39:22.943604 [info ] [Thread-1  ]: 1 of 4 START view model dev.src_hosts .......................................... [RUN]
[0m10:39:22.943964 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m10:39:22.944595 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m10:39:22.944816 [info ] [Thread-2  ]: 2 of 4 START view model dev.src_listings ....................................... [RUN]
[0m10:39:22.944982 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m10:39:22.945146 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m10:39:22.945576 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m10:39:22.945809 [info ] [Thread-3  ]: 3 of 4 START view model dev.src_reviews ........................................ [RUN]
[0m10:39:22.945974 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m10:39:22.946149 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m10:39:22.946548 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m10:39:22.948222 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m10:39:22.948403 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m10:39:22.948572 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m10:39:22.949578 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m10:39:22.949824 [debug] [Thread-1  ]: finished collecting timing info
[0m10:39:22.950005 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m10:39:22.950294 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m10:39:22.951296 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m10:39:22.956864 [debug] [Thread-2  ]: finished collecting timing info
[0m10:39:22.970390 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m10:39:22.970736 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m10:39:22.972959 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m10:39:22.973107 [debug] [Thread-3  ]: finished collecting timing info
[0m10:39:22.973841 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m10:39:22.974247 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m10:39:22.974401 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m10:39:22.974578 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m10:39:22.974768 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m10:39:22.976663 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m10:39:22.976853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:39:22.977036 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:39:22.979156 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m10:39:22.980739 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m10:39:22.980840 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:39:23.864181 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m10:39:23.871413 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m10:39:23.880323 [debug] [Thread-2  ]: finished collecting timing info
[0m10:39:23.880478 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m10:39:23.882101 [debug] [Thread-1  ]: finished collecting timing info
[0m10:39:23.883693 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m10:39:23.907673 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m10:39:23.909351 [debug] [Thread-3  ]: finished collecting timing info
[0m10:39:23.909485 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m10:39:23.966112 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c76c87850>]}
[0m10:39:23.966455 [info ] [Thread-2  ]: 2 of 4 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.02s]
[0m10:39:23.966773 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m10:39:23.967227 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m10:39:23.967410 [info ] [Thread-4  ]: 4 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m10:39:23.967714 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:39:23.967820 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m10:39:23.967921 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m10:39:23.969661 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:39:23.969883 [debug] [Thread-4  ]: finished collecting timing info
[0m10:39:23.969992 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m10:39:23.971699 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:39:23.972236 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:39:23.972334 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m10:39:23.972428 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:39:23.977095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6f5db730>]}
[0m10:39:23.977369 [info ] [Thread-1  ]: 1 of 4 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.03s]
[0m10:39:23.977650 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m10:39:24.000200 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c76c87bb0>]}
[0m10:39:24.000505 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.05s]
[0m10:39:24.000821 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m10:39:24.445166 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m10:39:24.448000 [debug] [Thread-4  ]: finished collecting timing info
[0m10:39:24.448287 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m10:39:24.537561 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3655e7d4-60cf-496d-898e-e648596c09ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6f599bb0>]}
[0m10:39:24.538074 [info ] [Thread-4  ]: 4 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.57s]
[0m10:39:24.538620 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m10:39:24.540294 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:39:24.540700 [info ] [MainThread]: 
[0m10:39:24.541033 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m10:39:24.541334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:24.541490 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m10:39:24.541633 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m10:39:24.541780 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m10:39:24.541937 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m10:39:24.547602 [info ] [MainThread]: 
[0m10:39:24.547864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:24.548219 [info ] [MainThread]: 
[0m10:39:24.548462 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:39:24.548782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c77358550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c76d322e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c76d32c70>]}


============================== 2022-07-28 12:43:03.765895 | 6bab6252-446c-4044-bb77-18f4a73a2813 ==============================
[0m12:43:03.765912 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:43:03.766201 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m12:43:03.766309 [debug] [MainThread]: Tracking: tracking
[0m12:43:03.766492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a76595dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a76595e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a76595e80>]}
[0m12:43:03.785929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:43:03.786188 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:43:03.793917 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:43:03.796477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a764b5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7646c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a7646cca0>]}


============================== 2022-07-28 12:45:28.239289 | 87ac70ef-32e3-4526-bb62-7972ee7c8f1b ==============================
[0m12:45:28.239306 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:45:28.239612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m12:45:28.239725 [debug] [MainThread]: Tracking: tracking
[0m12:45:28.239917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d167cedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d167cee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d167ceeb0>]}
[0m12:45:28.268848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:45:28.269100 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:45:28.277181 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:45:28.279463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d16734430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d166ec7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d166eccd0>]}


============================== 2022-07-28 12:46:18.488179 | 89811de3-5f59-4469-a471-c7883eebb4a5 ==============================
[0m12:46:18.488197 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:46:18.488635 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:46:18.488758 [debug] [MainThread]: Tracking: tracking
[0m12:46:18.488965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483e7ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483e7ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd483e7ffd0>]}
[0m12:46:18.509195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:46:18.509456 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:46:18.517661 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:46:18.520225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd482d81550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd482d2a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd482d2adf0>]}


============================== 2022-07-28 12:46:52.289813 | 8dcf2714-c2d7-4448-bf9e-f18eacea3e80 ==============================
[0m12:46:52.289827 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:46:52.290163 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:46:52.290286 [debug] [MainThread]: Tracking: tracking
[0m12:46:52.290469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815a304ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815a304f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815a304fa0>]}
[0m12:46:52.310452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:46:52.310734 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:46:52.318898 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:46:52.321352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815a235520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81591ab8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81591abdc0>]}


============================== 2022-07-28 12:48:22.998357 | e07b8b08-4a87-478f-b289-af3ef5e0120e ==============================
[0m12:48:22.998373 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:48:22.998699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:48:22.998807 [debug] [MainThread]: Tracking: tracking
[0m12:48:22.998992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbcd1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbcd1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbcd1fa0>]}
[0m12:48:23.018593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:48:23.018858 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:48:23.026722 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:48:23.028954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbc00520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbabab8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbababdc0>]}


============================== 2022-07-28 12:48:33.637648 | 6ca0d8d6-4f76-4a7c-9e54-ea6284723da8 ==============================
[0m12:48:33.637656 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:48:33.637896 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m12:48:33.637992 [debug] [MainThread]: Tracking: tracking
[0m12:48:33.644121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6bc515e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6bcdb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6bcbd3a0>]}
[0m12:48:33.795587 [debug] [MainThread]: Executing "git --help"
[0m12:48:33.805662 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:33.805917 [debug] [MainThread]: STDERR: "b''"
[0m12:48:33.808175 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m12:48:33.808790 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:48:33.808894 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:33.808987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:34.484164 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.68 seconds
[0m12:48:34.485247 [debug] [MainThread]: On debug: Close
[0m12:48:34.586078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65d16910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65d16100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65d279a0>]}
[0m12:48:35.456230 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-28 12:48:39.883260 | 14d2b959-59d6-4f01-a2cd-fef11e85e96d ==============================
[0m12:48:39.883277 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:48:39.883612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:48:39.883721 [debug] [MainThread]: Tracking: tracking
[0m12:48:39.883908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4d47e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4d47eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4d47f10>]}
[0m12:48:39.902961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:48:39.903217 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:48:39.911090 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:48:39.913248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4cbf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4c6c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be4c6cd30>]}


============================== 2022-07-28 12:50:02.153678 | b13c3660-fa69-4c23-8612-cb87cbec75e2 ==============================
[0m12:50:02.153693 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:50:02.154034 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:50:02.154140 [debug] [MainThread]: Tracking: tracking
[0m12:50:02.154329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57d53d5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57d53d5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57d53d5ee0>]}
[0m12:50:02.173954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:50:02.174215 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:50:02.183973 [debug] [MainThread]: 1603: static parser failed on dim/dim_hosts_cleansed.sql
[0m12:50:02.186432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57d533f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57d52ec820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57d52ecd00>]}


============================== 2022-07-28 12:51:45.951730 | a6d1ddda-61cd-479d-a693-bdbeb261ae08 ==============================
[0m12:51:45.951747 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:51:45.952082 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m12:51:45.952201 [debug] [MainThread]: Tracking: tracking
[0m12:51:45.952391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e4e6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e4e6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e4e6e80>]}
[0m12:51:45.980758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:51:45.981130 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:51:45.991585 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:51:46.002353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m12:51:46.005740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6d1ddda-61cd-479d-a693-bdbeb261ae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1c146730>]}
[0m12:51:46.009663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6d1ddda-61cd-479d-a693-bdbeb261ae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e4c8dc0>]}
[0m12:51:46.009899 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:51:46.010050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d1ddda-61cd-479d-a693-bdbeb261ae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e43ae80>]}
[0m12:51:46.010526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e43ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e4c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1e4c8ac0>]}


============================== 2022-07-28 12:51:47.513625 | 0233565c-018d-4d24-b97f-41206bcaf62e ==============================
[0m12:51:47.513643 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:51:47.513977 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:51:47.514090 [debug] [MainThread]: Tracking: tracking
[0m12:51:47.514280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75b90f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75b90f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75b90fd0>]}
[0m12:51:47.534053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:47.534218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:47.534524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m12:51:47.538486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75a88040>]}
[0m12:51:47.542657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75aff1c0>]}
[0m12:51:47.542883 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:51:47.543073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75a86d30>]}
[0m12:51:47.544010 [info ] [MainThread]: 
[0m12:51:47.544342 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:51:47.545165 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m12:51:47.554399 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m12:51:47.554575 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m12:51:47.554688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:48.178370 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.62 seconds
[0m12:51:48.180325 [debug] [ThreadPool]: On list_airbnb: Close
[0m12:51:48.268809 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:51:48.274486 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:51:48.274654 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:51:48.274767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:48.870672 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.6 seconds
[0m12:51:48.871751 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:51:48.962733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75abbca0>]}
[0m12:51:48.963156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:48.963380 [info ] [MainThread]: 
[0m12:51:48.966811 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m12:51:48.967041 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m12:51:48.967629 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m12:51:48.967789 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m12:51:48.967955 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m12:51:48.969157 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:51:48.969390 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m12:51:48.969599 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m12:51:48.969967 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m12:51:48.970262 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m12:51:48.970423 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m12:51:48.971032 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m12:51:48.971205 [debug] [Thread-1  ]: finished collecting timing info
[0m12:51:48.971428 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m12:51:48.971915 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m12:51:48.972130 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m12:51:48.973262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:51:48.973465 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m12:51:48.992598 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m12:51:48.992825 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m12:51:48.993025 [debug] [Thread-2  ]: finished collecting timing info
[0m12:51:48.994221 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:51:48.994634 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:51:48.994826 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m12:51:48.995088 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m12:51:48.995211 [debug] [Thread-3  ]: finished collecting timing info
[0m12:51:48.997024 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m12:51:48.997185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:51:48.997371 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m12:51:49.001415 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m12:51:49.001921 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:51:49.002268 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m12:51:49.002472 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:51:49.004235 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:51:49.004352 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m12:51:49.004467 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:51:49.827709 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m12:51:49.834972 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.83 seconds
[0m12:51:49.857850 [debug] [Thread-2  ]: finished collecting timing info
[0m12:51:49.858730 [debug] [Thread-3  ]: finished collecting timing info
[0m12:51:49.859479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m12:51:49.859664 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m12:51:49.859862 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m12:51:49.861253 [debug] [Thread-1  ]: finished collecting timing info
[0m12:51:49.863011 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m12:51:49.961035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a74c132b0>]}
[0m12:51:49.961361 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.99s]
[0m12:51:49.961684 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m12:51:49.962189 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:51:49.962383 [info ] [Thread-4  ]: 4 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m12:51:49.962724 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:51:49.962848 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:51:49.962973 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m12:51:49.964868 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:51:49.965112 [debug] [Thread-4  ]: finished collecting timing info
[0m12:51:49.965222 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:51:49.966938 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:51:49.967365 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:51:49.967466 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous'),
    host_name,
    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:51:49.967562 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:51:49.970163 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a74c0faf0>]}
[0m12:51:49.970507 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.00s]
[0m12:51:49.970807 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m12:51:49.971260 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:51:49.971456 [info ] [Thread-1  ]: 5 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m12:51:49.971774 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:51:49.971892 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:51:49.972010 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m12:51:49.974123 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:51:49.974403 [debug] [Thread-1  ]: finished collecting timing info
[0m12:51:49.974521 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:51:50.006766 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:51:50.008166 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:51:50.008314 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m12:51:50.008879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:51:50.010937 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a76c539d0>]}
[0m12:51:50.011181 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.04s]
[0m12:51:50.011487 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m12:51:50.759526 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a5e8a3-3201-06e3-0000-d0150001600e
[0m12:51:50.759697 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m12:51:50.759876 [debug] [Thread-4  ]: finished collecting timing info
[0m12:51:50.759995 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:51:50.871001 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m12:51:50.871271 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75b15e20>]}
[0m12:51:50.871540 [error] [Thread-4  ]: 4 of 5 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.91s]
[0m12:51:50.871845 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:51:50.942362 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m12:51:50.943772 [debug] [Thread-1  ]: finished collecting timing info
[0m12:51:50.943900 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:51:51.044214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0233565c-018d-4d24-b97f-41206bcaf62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a75242dc0>]}
[0m12:51:51.044528 [info ] [Thread-1  ]: 5 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.07s]
[0m12:51:51.044835 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:51:51.045949 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:51:51.046196 [info ] [MainThread]: 
[0m12:51:51.046380 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m12:51:51.046556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:51.046646 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:51:51.046736 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m12:51:51.046831 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m12:51:51.046920 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m12:51:51.051101 [info ] [MainThread]: 
[0m12:51:51.051279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:51:51.051462 [info ] [MainThread]: 
[0m12:51:51.051624 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m12:51:51.051780 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m12:51:51.051932 [error] [MainThread]:   Missing column specification
[0m12:51:51.052082 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m12:51:51.052242 [info ] [MainThread]: 
[0m12:51:51.052397 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:51:51.052612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a74af6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a74af6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a74af6dc0>]}


============================== 2022-07-28 12:53:20.402457 | 1f6d3116-8e9d-4855-948a-3fd812b38651 ==============================
[0m12:53:20.402473 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:53:20.402773 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m12:53:20.402883 [debug] [MainThread]: Tracking: tracking
[0m12:53:20.403074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dd52df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dd52e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dd52ee0>]}
[0m12:53:20.422399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:20.422705 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m12:53:20.432420 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:53:20.442577 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m12:53:20.445889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f6d3116-8e9d-4855-948a-3fd812b38651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e17bc6a30>]}
[0m12:53:20.449760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f6d3116-8e9d-4855-948a-3fd812b38651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4ddf7190>]}
[0m12:53:20.449997 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:53:20.450158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f6d3116-8e9d-4855-948a-3fd812b38651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dcacfd0>]}
[0m12:53:20.450656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dcacf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dcd5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4dcd5be0>]}


============================== 2022-07-28 12:53:22.134647 | ce0c2e46-c39b-4f3e-be89-2ca777a013bc ==============================
[0m12:53:22.134664 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:53:22.134998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:53:22.135106 [debug] [MainThread]: Tracking: tracking
[0m12:53:22.135295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1297016fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1297032040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12970320a0>]}
[0m12:53:22.154433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:22.154587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:22.154883 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example

[0m12:53:22.158690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1295f0a0d0>]}
[0m12:53:22.162514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1295fcd250>]}
[0m12:53:22.162701 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:53:22.162882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1295f08eb0>]}
[0m12:53:22.163768 [info ] [MainThread]: 
[0m12:53:22.164075 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:53:22.164805 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m12:53:22.174167 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m12:53:22.174371 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m12:53:22.174481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:22.989501 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.81 seconds
[0m12:53:22.991148 [debug] [ThreadPool]: On list_airbnb: Close
[0m12:53:23.086972 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:53:23.092407 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:53:23.092544 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:53:23.092642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:23.626797 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
[0m12:53:23.627848 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:53:23.723234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1295ffb520>]}
[0m12:53:23.724519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:23.725095 [info ] [MainThread]: 
[0m12:53:23.732925 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m12:53:23.733320 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m12:53:23.734720 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m12:53:23.735097 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m12:53:23.735420 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m12:53:23.735971 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m12:53:23.736772 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m12:53:23.737488 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m12:53:23.738191 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m12:53:23.738524 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m12:53:23.738906 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m12:53:23.739256 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m12:53:23.739568 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m12:53:23.739859 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m12:53:23.740166 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m12:53:23.742021 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:53:23.743830 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:53:23.745275 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:53:23.746224 [debug] [Thread-1  ]: finished collecting timing info
[0m12:53:23.746425 [debug] [Thread-2  ]: finished collecting timing info
[0m12:53:23.746656 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m12:53:23.746833 [debug] [Thread-3  ]: finished collecting timing info
[0m12:53:23.747093 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m12:53:23.758154 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m12:53:23.770176 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m12:53:23.772117 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m12:53:23.774643 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m12:53:23.775572 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:53:23.776161 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:53:23.776574 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:53:23.776748 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m12:53:23.776924 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m12:53:23.777100 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m12:53:23.777274 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:53:23.777459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:23.777643 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:53:24.467401 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m12:53:24.481838 [debug] [Thread-1  ]: finished collecting timing info
[0m12:53:24.482021 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m12:53:24.557653 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m12:53:24.559087 [debug] [Thread-3  ]: finished collecting timing info
[0m12:53:24.559214 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m12:53:24.589770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1295ffbbb0>]}
[0m12:53:24.590094 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.85s]
[0m12:53:24.590426 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m12:53:24.590957 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:53:24.591155 [info ] [Thread-4  ]: 4 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m12:53:24.591531 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:53:24.591644 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:53:24.591757 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m12:53:24.593769 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:53:24.594015 [debug] [Thread-4  ]: finished collecting timing info
[0m12:53:24.594134 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:53:24.596277 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:53:24.596771 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:53:24.596869 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m12:53:24.596962 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:53:24.664656 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12956e5ee0>]}
[0m12:53:24.670117 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.93s]
[0m12:53:24.670458 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m12:53:25.381212 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.6 seconds
[0m12:53:25.383235 [debug] [Thread-2  ]: finished collecting timing info
[0m12:53:25.383427 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m12:53:25.494839 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f129432c760>]}
[0m12:53:25.495150 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.76s]
[0m12:53:25.495442 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m12:53:25.495940 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:53:25.496273 [info ] [Thread-1  ]: 5 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m12:53:25.496597 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:53:25.496755 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:53:25.496876 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m12:53:25.498665 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:53:25.499018 [debug] [Thread-1  ]: finished collecting timing info
[0m12:53:25.499123 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:53:25.500913 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:53:25.501428 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:53:25.501527 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m12:53:25.501621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:25.645283 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.05 seconds
[0m12:53:25.649713 [debug] [Thread-4  ]: finished collecting timing info
[0m12:53:25.657719 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:53:25.762577 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12942b9670>]}
[0m12:53:25.762893 [info ] [Thread-4  ]: 4 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.17s]
[0m12:53:25.763186 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:53:26.112126 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
[0m12:53:26.113528 [debug] [Thread-1  ]: finished collecting timing info
[0m12:53:26.113658 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:53:26.222752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0c2e46-c39b-4f3e-be89-2ca777a013bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12942e0d60>]}
[0m12:53:26.223100 [info ] [Thread-1  ]: 5 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.73s]
[0m12:53:26.223424 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:53:26.224714 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:53:26.224973 [info ] [MainThread]: 
[0m12:53:26.225169 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m12:53:26.225364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:26.225462 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:53:26.225572 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m12:53:26.225678 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m12:53:26.225774 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m12:53:26.229611 [info ] [MainThread]: 
[0m12:53:26.229789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:26.229979 [info ] [MainThread]: 
[0m12:53:26.230140 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:53:26.230356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12950253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1294f85dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1294f85be0>]}


============================== 2022-07-28 13:05:46.317675 | c934ae91-7e1b-4390-a546-8c7c046227db ==============================
[0m13:05:46.317691 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:05:46.318026 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:05:46.318139 [debug] [MainThread]: Tracking: tracking
[0m13:05:46.318334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6be17040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6be300a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6be30100>]}
[0m13:05:46.330764 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:05:46.331031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6beb13d0>]}
[0m13:05:46.338594 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:05:46.369784 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:05:46.371251 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:05:46.372055 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:05:46.375366 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:05:46.382334 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:05:46.385065 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:05:46.386068 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:05:46.390001 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:05:46.390437 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:05:46.390885 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:05:46.391383 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:05:46.391824 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:05:46.398706 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:05:46.409568 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:05:46.412911 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:05:46.415063 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:05:46.425184 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:05:46.427228 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:05:46.428845 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:05:46.434035 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:05:46.436094 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:05:46.437274 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:05:46.438360 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:05:46.444007 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:05:46.447235 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:05:46.447755 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:05:46.448357 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:05:46.448996 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:05:46.450006 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:05:46.451760 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:05:46.454647 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:05:46.456020 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:05:46.457329 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:05:46.460480 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:05:46.473682 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:05:46.478532 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:05:46.479765 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:05:46.488187 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:05:46.500508 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:05:46.510428 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:05:46.521783 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:05:46.533593 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:05:46.540328 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:05:46.541439 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:05:46.544643 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:05:46.547123 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:05:46.548121 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:05:46.551786 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:05:46.553517 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:05:46.555690 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:05:46.559750 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:05:46.561470 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:05:46.563019 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:05:46.563730 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:05:46.564669 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:05:46.565468 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:05:46.566209 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:05:46.566932 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:05:46.567873 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:05:46.568712 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:05:46.570188 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:05:46.570926 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:05:46.571701 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:05:46.572544 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:05:46.573356 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:05:46.574185 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:05:46.575117 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:05:46.575931 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:05:46.580487 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:05:46.581140 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:05:46.581778 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:05:46.582625 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:05:46.781960 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:05:46.789700 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:05:46.791328 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:05:46.792920 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:05:46.794506 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:05:46.844970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6beaefa0>]}
[0m13:05:46.848674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6beaef70>]}
[0m13:05:46.848884 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:05:46.849086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6ad26fa0>]}
[0m13:05:46.849923 [info ] [MainThread]: 
[0m13:05:46.850251 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:05:46.851005 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:05:46.860034 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:05:46.860214 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:05:46.860300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:47.488521 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.63 seconds
[0m13:05:47.489808 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:05:47.594173 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:05:47.598881 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:05:47.599015 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:05:47.599117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:48.125289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.53 seconds
[0m13:05:48.126485 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:05:48.222561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6ad12b50>]}
[0m13:05:48.223177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:05:48.223409 [info ] [MainThread]: 
[0m13:05:48.227098 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m13:05:48.227362 [info ] [Thread-2  ]: 2 of 5 START table model dev.src_listings ...................................... [RUN]
[0m13:05:48.227549 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m13:05:48.226339 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m13:05:48.228252 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m13:05:48.228499 [info ] [Thread-3  ]: 3 of 5 START table model dev.src_reviews ....................................... [RUN]
[0m13:05:48.228727 [info ] [Thread-1  ]: 1 of 5 START table model dev.src_hosts ......................................... [RUN]
[0m13:05:48.228923 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m13:05:48.229325 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m13:05:48.229704 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m13:05:48.229907 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m13:05:48.230055 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m13:05:48.230246 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m13:05:48.231552 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:05:48.231747 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m13:05:48.231933 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m13:05:48.233137 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:05:48.234134 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:05:48.234309 [debug] [Thread-2  ]: finished collecting timing info
[0m13:05:48.234867 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m13:05:48.235104 [debug] [Thread-1  ]: finished collecting timing info
[0m13:05:48.247716 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."SRC_LISTINGS" because it is of type view
[0m13:05:48.247948 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m13:05:48.248154 [debug] [Thread-3  ]: finished collecting timing info
[0m13:05:48.252287 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:05:48.253628 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."SRC_HOSTS" because it is of type view
[0m13:05:48.253829 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m13:05:48.253984 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
drop view if exists "AIRBNB"."DEV"."SRC_LISTINGS" cascade
[0m13:05:48.255164 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:05:48.256628 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type view
[0m13:05:48.256818 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:05:48.257018 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop view if exists "AIRBNB"."DEV"."SRC_HOSTS" cascade
[0m13:05:48.258465 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:05:48.259546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:48.259853 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop view if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m13:05:48.263697 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:05:48.787201 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m13:05:48.794650 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m13:05:48.795306 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:05:48.795436 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace transient table airbnb.dev.src_listings  as
      (WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
      );
[0m13:05:48.910451 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m13:05:48.911450 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m13:05:48.911928 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:05:48.912035 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace transient table airbnb.dev.src_hosts  as
      (with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
      );
[0m13:05:49.151391 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m13:05:49.152365 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m13:05:49.152869 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:05:49.152979 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace transient table airbnb.dev.src_reviews  as
      (with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
      );
[0m13:05:50.376781 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.46 seconds
[0m13:05:50.395638 [debug] [Thread-1  ]: finished collecting timing info
[0m13:05:50.395809 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m13:05:50.421765 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.63 seconds
[0m13:05:50.423464 [debug] [Thread-2  ]: finished collecting timing info
[0m13:05:50.423679 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m13:05:50.499270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6bead4f0>]}
[0m13:05:50.499586 [info ] [Thread-1  ]: 1 of 5 OK created table model dev.src_hosts .................................... [[32mSUCCESS 1[0m in 2.27s]
[0m13:05:50.499912 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m13:05:50.500379 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:05:50.500596 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m13:05:50.500918 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:05:50.501029 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:05:50.501139 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m13:05:50.503765 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:05:50.504027 [debug] [Thread-4  ]: finished collecting timing info
[0m13:05:50.504148 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:05:50.505517 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m13:05:50.506993 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:05:50.507207 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:05:50.507431 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:05:50.521076 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6beada90>]}
[0m13:05:50.521404 [info ] [Thread-2  ]: 2 of 5 OK created table model dev.src_listings ................................. [[32mSUCCESS 1[0m in 2.29s]
[0m13:05:50.521751 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m13:05:50.522125 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:05:50.522323 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m13:05:50.522669 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:05:50.522805 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:05:50.522962 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m13:05:50.526766 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:05:50.527195 [debug] [Thread-1  ]: finished collecting timing info
[0m13:05:50.527323 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:05:50.528778 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m13:05:50.530025 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:05:50.530137 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:05:50.530239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:51.000070 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m13:05:51.001055 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:05:51.001568 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:05:51.001686 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m13:05:51.017111 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m13:05:51.018061 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:05:51.018659 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:05:51.018763 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m13:05:51.838190 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m13:05:51.839876 [debug] [Thread-1  ]: finished collecting timing info
[0m13:05:51.840018 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:05:51.933805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6bead3d0>]}
[0m13:05:51.934120 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.41s]
[0m13:05:51.934437 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:05:52.187717 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.19 seconds
[0m13:05:52.189291 [debug] [Thread-4  ]: finished collecting timing info
[0m13:05:52.189434 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:05:52.287342 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c608bbeb0>]}
[0m13:05:52.287659 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.79s]
[0m13:05:52.287967 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:05:53.522167 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.37 seconds
[0m13:05:53.523741 [debug] [Thread-3  ]: finished collecting timing info
[0m13:05:53.523882 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m13:05:53.674203 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c934ae91-7e1b-4390-a546-8c7c046227db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6ad42b80>]}
[0m13:05:53.674681 [info ] [Thread-3  ]: 3 of 5 OK created table model dev.src_reviews .................................. [[32mSUCCESS 1[0m in 5.44s]
[0m13:05:53.675154 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m13:05:53.676928 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:05:53.677380 [info ] [MainThread]: 
[0m13:05:53.677625 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.83 seconds (6.83s).
[0m13:05:53.677839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:53.677952 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m13:05:53.678048 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m13:05:53.678144 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m13:05:53.678238 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m13:05:53.683038 [info ] [MainThread]: 
[0m13:05:53.683297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:53.683520 [info ] [MainThread]: 
[0m13:05:53.683708 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:05:53.683982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6e65a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6bead5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6bead820>]}


============================== 2022-07-28 13:08:25.760612 | 77f25671-62f9-4409-b282-9f9880a277dd ==============================
[0m13:08:25.760637 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:08:25.760993 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:08:25.761105 [debug] [MainThread]: Tracking: tracking
[0m13:08:25.761288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a9554e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a9554e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a9554ee0>]}
[0m13:08:25.781721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:25.781913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:25.786185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a9447be0>]}
[0m13:08:25.790567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a94b61f0>]}
[0m13:08:25.790861 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:08:25.791055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a94b6040>]}
[0m13:08:25.792048 [info ] [MainThread]: 
[0m13:08:25.792386 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:08:25.793172 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:08:25.803105 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:08:25.803284 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:08:25.803394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:26.639913 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.84 seconds
[0m13:08:26.641293 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:08:26.762804 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:08:26.767997 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:08:26.768134 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:08:26.768232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:27.173943 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.41 seconds
[0m13:08:27.175293 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:08:27.455191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a947cb50>]}
[0m13:08:27.455622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:08:27.455854 [info ] [MainThread]: 
[0m13:08:27.459315 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m13:08:27.459505 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m13:08:27.460259 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m13:08:27.460473 [info ] [Thread-2  ]: 2 of 5 START table model dev.src_listings ...................................... [RUN]
[0m13:08:27.460855 [info ] [Thread-1  ]: 1 of 5 START table model dev.src_hosts ......................................... [RUN]
[0m13:08:27.461108 [info ] [Thread-3  ]: 3 of 5 START table model dev.src_reviews ....................................... [RUN]
[0m13:08:27.461559 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m13:08:27.461922 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m13:08:27.462258 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m13:08:27.462438 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m13:08:27.462609 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m13:08:27.462750 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m13:08:27.462942 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m13:08:27.463105 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m13:08:27.463237 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m13:08:27.464412 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:08:27.465304 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:08:27.466200 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:08:27.466949 [debug] [Thread-1  ]: finished collecting timing info
[0m13:08:27.467225 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m13:08:27.473177 [debug] [Thread-2  ]: finished collecting timing info
[0m13:08:27.483733 [debug] [Thread-3  ]: finished collecting timing info
[0m13:08:27.483945 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m13:08:27.485680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m13:08:27.485887 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m13:08:27.487518 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m13:08:27.489064 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m13:08:27.489855 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:08:27.489992 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace transient table airbnb.dev.src_hosts  as
      (with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
      );
[0m13:08:27.490117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:27.491915 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:08:27.492147 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace transient table airbnb.dev.src_reviews  as
      (with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
      );
[0m13:08:27.492277 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:08:27.495020 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:08:27.495147 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace transient table airbnb.dev.src_listings  as
      (WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
      );
[0m13:08:27.495321 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:08:29.206620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.72 seconds
[0m13:08:29.222461 [debug] [Thread-1  ]: finished collecting timing info
[0m13:08:29.222641 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m13:08:29.242460 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.75 seconds
[0m13:08:29.243919 [debug] [Thread-2  ]: finished collecting timing info
[0m13:08:29.244045 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m13:08:29.347234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a94ced90>]}
[0m13:08:29.347564 [info ] [Thread-1  ]: 1 of 5 OK created table model dev.src_hosts .................................... [[32mSUCCESS 1[0m in 1.89s]
[0m13:08:29.347917 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m13:08:29.348432 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:08:29.348635 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m13:08:29.348990 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:08:29.349119 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:08:29.349253 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m13:08:29.351402 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:08:29.351662 [debug] [Thread-4  ]: finished collecting timing info
[0m13:08:29.351780 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:08:29.385067 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:08:29.385629 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:08:29.385738 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m13:08:29.385834 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:08:29.484464 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80acdda580>]}
[0m13:08:29.490003 [info ] [Thread-2  ]: 2 of 5 OK created table model dev.src_listings ................................. [[32mSUCCESS 1[0m in 2.02s]
[0m13:08:29.490342 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m13:08:29.501244 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:08:29.511972 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m13:08:29.512402 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:08:29.512537 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:08:29.517912 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m13:08:29.519707 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:08:29.530435 [debug] [Thread-1  ]: finished collecting timing info
[0m13:08:29.530590 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:08:29.532211 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:08:29.538161 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:08:29.538332 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m13:08:29.538448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:30.870188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.33 seconds
[0m13:08:30.871770 [debug] [Thread-1  ]: finished collecting timing info
[0m13:08:30.871911 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:08:31.001160 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.62 seconds
[0m13:08:31.002692 [debug] [Thread-4  ]: finished collecting timing info
[0m13:08:31.002823 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:08:31.289848 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a0ff0550>]}
[0m13:08:31.290185 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.94s]
[0m13:08:31.290505 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:08:31.384845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a80903a0>]}
[0m13:08:31.385157 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.87s]
[0m13:08:31.385448 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:08:32.296231 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.8 seconds
[0m13:08:32.297880 [debug] [Thread-3  ]: finished collecting timing info
[0m13:08:32.298022 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m13:08:32.442975 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f25671-62f9-4409-b282-9f9880a277dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80acddb7f0>]}
[0m13:08:32.443283 [info ] [Thread-3  ]: 3 of 5 OK created table model dev.src_reviews .................................. [[32mSUCCESS 1[0m in 4.98s]
[0m13:08:32.443573 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m13:08:32.444673 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:08:32.444916 [info ] [MainThread]: 
[0m13:08:32.445114 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m13:08:32.445286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:32.445375 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m13:08:32.445463 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m13:08:32.445551 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m13:08:32.445637 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m13:08:32.449490 [info ] [MainThread]: 
[0m13:08:32.449671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:32.449867 [info ] [MainThread]: 
[0m13:08:32.450031 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:08:32.450254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b3da7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a8593dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a85935b0>]}


============================== 2022-07-28 13:12:06.062751 | 51b769af-bd60-479b-911b-e99b58875ea0 ==============================
[0m13:12:06.062768 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:12:06.063092 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:12:06.063202 [debug] [MainThread]: Tracking: tracking
[0m13:12:06.063400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaef6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaef6ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaef6f40>]}
[0m13:12:06.075368 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:12:06.075629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaf16910>]}
[0m13:12:06.084909 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:12:06.114802 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:12:06.116258 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:12:06.116966 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:12:06.119753 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:12:06.126616 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:12:06.129343 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:12:06.130318 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:12:06.133970 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:12:06.134337 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:12:06.134737 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:12:06.135219 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:12:06.135666 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:12:06.142744 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:12:06.153106 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:12:06.156426 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:12:06.158678 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:12:06.168488 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:12:06.170515 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:12:06.172190 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:12:06.177485 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:12:06.179455 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:12:06.180600 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:12:06.181660 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:12:06.187557 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:12:06.190936 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:12:06.191466 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:12:06.192067 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:12:06.192707 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:12:06.193715 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:12:06.195420 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:12:06.198194 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:12:06.199541 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:12:06.200846 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:12:06.204616 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:12:06.217838 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:12:06.231345 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:12:06.234483 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:12:06.243989 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:12:06.256258 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:12:06.265541 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:12:06.276633 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:12:06.288619 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:12:06.295417 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:12:06.296476 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:12:06.299736 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:12:06.302099 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:12:06.303058 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:12:06.306882 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:12:06.308599 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:12:06.310694 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:12:06.314744 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:12:06.316458 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:12:06.317984 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:12:06.318683 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:12:06.319632 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:12:06.320425 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:12:06.321153 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:12:06.321867 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:12:06.322800 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:12:06.323621 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:12:06.325071 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:12:06.325776 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:12:06.326603 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:12:06.327446 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:12:06.328224 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:12:06.329035 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:12:06.329950 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:12:06.330747 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:12:06.335207 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:12:06.335825 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:12:06.336440 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:12:06.337262 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:12:06.517272 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:12:06.525559 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:12:06.527242 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:12:06.528859 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:12:06.530460 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:12:06.580433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaf90f40>]}
[0m13:12:06.584077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaf90ee0>]}
[0m13:12:06.584308 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:12:06.584493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84e9de6fd0>]}
[0m13:12:06.585341 [info ] [MainThread]: 
[0m13:12:06.585655 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:12:06.586328 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:12:06.594714 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:12:06.594862 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:12:06.594959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:07.309924 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.71 seconds
[0m13:12:07.311214 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:12:07.418165 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:12:07.422859 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:12:07.423014 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:12:07.423116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:07.956780 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.53 seconds
[0m13:12:07.958271 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:12:08.056178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eae4da60>]}
[0m13:12:08.056629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:08.056857 [info ] [MainThread]: 
[0m13:12:08.060395 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m13:12:08.061490 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m13:12:08.061759 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m13:12:08.061951 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m13:12:08.062229 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m13:12:08.062763 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m13:12:08.063010 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m13:12:08.063443 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m13:12:08.063673 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m13:12:08.064089 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m13:12:08.064294 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m13:12:08.064518 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m13:12:08.064728 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m13:12:08.064933 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m13:12:08.066196 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:12:08.066416 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m13:12:08.067447 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:12:08.068551 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:12:08.068805 [debug] [Thread-1  ]: finished collecting timing info
[0m13:12:08.069174 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m13:12:08.074644 [debug] [Thread-2  ]: finished collecting timing info
[0m13:12:08.080096 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m13:12:08.090774 [debug] [Thread-3  ]: finished collecting timing info
[0m13:12:08.092171 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."SRC_HOSTS" because it is of type table
[0m13:12:08.092708 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."SRC_LISTINGS" because it is of type table
[0m13:12:08.092873 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m13:12:08.096091 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:12:08.097281 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:12:08.098813 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type table
[0m13:12:08.098987 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop table if exists "AIRBNB"."DEV"."SRC_HOSTS" cascade
[0m13:12:08.099162 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
drop table if exists "AIRBNB"."DEV"."SRC_LISTINGS" cascade
[0m13:12:08.101017 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:12:08.101195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:08.101380 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:12:08.101562 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop table if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m13:12:08.103711 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:12:08.752981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m13:12:08.759757 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m13:12:08.760281 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:12:08.760389 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m13:12:08.774531 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.67 seconds
[0m13:12:08.775607 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m13:12:08.776084 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:12:08.776186 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m13:12:08.786509 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m13:12:08.787475 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m13:12:08.787931 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:12:08.788032 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:12:08.943358 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m13:12:08.954283 [debug] [Thread-1  ]: finished collecting timing info
[0m13:12:08.954430 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m13:12:08.956411 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m13:12:08.957664 [debug] [Thread-3  ]: finished collecting timing info
[0m13:12:08.957793 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m13:12:08.984528 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m13:12:08.985768 [debug] [Thread-2  ]: finished collecting timing info
[0m13:12:08.985914 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m13:12:09.053046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaed4c70>]}
[0m13:12:09.053378 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.99s]
[0m13:12:09.053701 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m13:12:09.054162 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:12:09.054347 [info ] [Thread-4  ]: 4 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m13:12:09.054705 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:12:09.054809 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:12:09.054914 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m13:12:09.056975 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:12:09.057237 [debug] [Thread-4  ]: finished collecting timing info
[0m13:12:09.057344 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:12:09.058872 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m13:12:09.060099 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:12:09.060242 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:12:09.060396 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:12:09.063513 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84eaea0850>]}
[0m13:12:09.063874 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.00s]
[0m13:12:09.064231 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m13:12:09.079656 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84baf232b0>]}
[0m13:12:09.079984 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.02s]
[0m13:12:09.080285 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m13:12:09.081173 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:12:09.081351 [info ] [Thread-1  ]: 5 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m13:12:09.081670 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:12:09.081799 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:12:09.081919 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m13:12:09.083665 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:12:09.083896 [debug] [Thread-1  ]: finished collecting timing info
[0m13:12:09.084003 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:12:09.085479 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m13:12:09.086630 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:12:09.086748 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:12:09.086857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:12:09.550965 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.46 seconds
[0m13:12:09.552630 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:12:09.553545 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:12:09.553708 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m13:12:09.744887 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m13:12:09.746030 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:12:09.746522 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:12:09.746621 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m13:12:09.766552 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m13:12:09.767867 [debug] [Thread-1  ]: finished collecting timing info
[0m13:12:09.768004 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:12:09.872816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b80f6520>]}
[0m13:12:09.873217 [info ] [Thread-1  ]: 5 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.79s]
[0m13:12:09.873617 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:12:09.947926 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m13:12:09.949183 [debug] [Thread-4  ]: finished collecting timing info
[0m13:12:09.949313 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:12:10.055215 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b769af-bd60-479b-911b-e99b58875ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b80fe970>]}
[0m13:12:10.055537 [info ] [Thread-4  ]: 4 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.00s]
[0m13:12:10.055856 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:12:10.057246 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:12:10.057495 [info ] [MainThread]: 
[0m13:12:10.057677 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m13:12:10.057854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:10.057945 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m13:12:10.058034 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m13:12:10.058121 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m13:12:10.058208 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m13:12:10.062860 [info ] [MainThread]: 
[0m13:12:10.063046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:10.063247 [info ] [MainThread]: 
[0m13:12:10.063413 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:12:10.063645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b82087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bae49820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bae49ee0>]}


============================== 2022-07-28 13:13:44.602757 | 16d113ee-72a5-4e80-ba1d-f2d2f50627b5 ==============================
[0m13:13:44.602775 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:13:44.603136 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:13:44.603243 [debug] [MainThread]: Tracking: tracking
[0m13:13:44.603435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e14fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e14ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e14ffa0>]}
[0m13:13:44.615444 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:13:44.615718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e1699d0>]}
[0m13:13:44.623727 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:13:44.656491 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:13:44.657907 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:13:44.658576 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:13:44.661459 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:13:44.668239 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:13:44.671042 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:13:44.672027 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:13:44.675656 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:13:44.675998 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:13:44.676421 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:13:44.676926 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:13:44.677353 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:13:44.684387 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:13:44.695193 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:13:44.698612 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:13:44.700823 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:13:44.711179 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:13:44.713248 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:13:44.714838 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:13:44.720085 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:13:44.722019 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:13:44.723149 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:13:44.724250 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:13:44.730343 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:13:44.733536 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:13:44.734055 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:13:44.734685 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:13:44.735330 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:13:44.736349 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:13:44.738031 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:13:44.740976 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:13:44.742330 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:13:44.743629 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:13:44.746899 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:13:44.760129 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:13:44.765146 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:13:44.766363 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:13:44.775054 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:13:44.787768 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:13:44.796457 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:13:44.807236 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:13:44.819519 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:13:44.826563 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:13:44.827712 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:13:44.831035 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:13:44.833619 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:13:44.834748 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:13:44.838736 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:13:44.840542 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:13:44.842699 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:13:44.846812 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:13:44.848612 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:13:44.850130 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:13:44.850838 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:13:44.851786 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:13:44.852583 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:13:44.853301 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:13:44.853999 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:13:44.854929 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:13:44.855755 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:13:44.857182 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:13:44.857885 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:13:44.858645 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:13:44.859464 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:13:44.860213 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:13:44.861012 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:13:44.861914 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:13:44.862700 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:13:44.867280 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:13:44.867987 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:13:44.868667 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:13:44.869491 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:13:45.054491 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:13:45.062208 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:13:45.063721 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:13:45.065235 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:13:45.066732 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:13:45.116438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e1e9220>]}
[0m13:13:45.120149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e1e97f0>]}
[0m13:13:45.120364 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:13:45.120547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e0a6fa0>]}
[0m13:13:45.121395 [info ] [MainThread]: 
[0m13:13:45.121713 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:13:45.122383 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:13:45.130719 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:13:45.130828 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:13:45.130923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:45.752995 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.62 seconds
[0m13:13:45.754308 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:13:45.855416 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:13:45.860324 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:13:45.860498 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:13:45.860622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:46.447126 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.59 seconds
[0m13:13:46.448201 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:13:46.554348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e0e71c0>]}
[0m13:13:46.554966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:46.555304 [info ] [MainThread]: 
[0m13:13:46.558986 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m13:13:46.560026 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m13:13:46.560287 [info ] [Thread-1  ]: 1 of 5 START table model dev.src_hosts ......................................... [RUN]
[0m13:13:46.560463 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m13:13:46.560752 [info ] [Thread-2  ]: 2 of 5 START table model dev.src_listings ...................................... [RUN]
[0m13:13:46.561168 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m13:13:46.561391 [info ] [Thread-3  ]: 3 of 5 START table model dev.src_reviews ....................................... [RUN]
[0m13:13:46.561789 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m13:13:46.561971 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m13:13:46.562320 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m13:13:46.562496 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m13:13:46.562681 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m13:13:46.562843 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m13:13:46.563001 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m13:13:46.564123 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:13:46.564307 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m13:13:46.565208 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:13:46.566214 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:13:46.566812 [debug] [Thread-1  ]: finished collecting timing info
[0m13:13:46.567064 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m13:13:46.572988 [debug] [Thread-3  ]: finished collecting timing info
[0m13:13:46.578389 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m13:13:46.579459 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."SRC_HOSTS" because it is of type view
[0m13:13:46.580792 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type view
[0m13:13:46.580988 [debug] [Thread-2  ]: finished collecting timing info
[0m13:13:46.585181 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:13:46.586661 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:13:46.586881 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m13:13:46.587068 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop view if exists "AIRBNB"."DEV"."SRC_HOSTS" cascade
[0m13:13:46.587255 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop view if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m13:13:46.588635 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."SRC_LISTINGS" because it is of type view
[0m13:13:46.588811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:46.588997 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:13:46.590279 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:13:46.593314 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
drop view if exists "AIRBNB"."DEV"."SRC_LISTINGS" cascade
[0m13:13:46.593456 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:13:47.263025 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.67 seconds
[0m13:13:47.269737 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m13:13:47.270258 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:13:47.270360 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace transient table airbnb.dev.src_reviews  as
      (with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
      );
[0m13:13:47.280615 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m13:13:47.281464 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m13:13:47.281945 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:13:47.282042 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace transient table airbnb.dev.src_listings  as
      (WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
      );
[0m13:13:47.502997 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.91 seconds
[0m13:13:47.504932 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m13:13:47.505942 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:13:47.506177 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace transient table airbnb.dev.src_hosts  as
      (with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
      );
[0m13:13:48.571741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.07 seconds
[0m13:13:48.608991 [debug] [Thread-1  ]: finished collecting timing info
[0m13:13:48.609202 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m13:13:48.707874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e1e9e50>]}
[0m13:13:48.708201 [info ] [Thread-1  ]: 1 of 5 OK created table model dev.src_hosts .................................... [[32mSUCCESS 1[0m in 2.15s]
[0m13:13:48.708520 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m13:13:48.709024 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:13:48.709233 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m13:13:48.709563 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:13:48.709668 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:13:48.709771 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m13:13:48.711464 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:13:48.711704 [debug] [Thread-4  ]: finished collecting timing info
[0m13:13:48.711811 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:13:48.713377 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m13:13:48.714555 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:13:48.714663 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:13:48.714757 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:13:48.859061 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.58 seconds
[0m13:13:48.862294 [debug] [Thread-2  ]: finished collecting timing info
[0m13:13:48.862440 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m13:13:48.961055 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d7206d30>]}
[0m13:13:48.961372 [info ] [Thread-2  ]: 2 of 5 OK created table model dev.src_listings ................................. [[32mSUCCESS 1[0m in 2.40s]
[0m13:13:48.961663 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m13:13:48.962161 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:13:48.962339 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m13:13:48.962669 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:13:48.962789 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:13:48.962905 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m13:13:48.964615 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:13:48.964871 [debug] [Thread-1  ]: finished collecting timing info
[0m13:13:48.964974 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:13:48.966205 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m13:13:48.967297 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:13:48.967396 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:13:48.967488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:49.097657 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.38 seconds
[0m13:13:49.103869 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:13:49.122748 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:13:49.122922 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m13:13:49.341108 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.37 seconds
[0m13:13:49.342052 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:13:49.342647 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:13:49.342746 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m13:13:50.154295 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m13:13:50.156010 [debug] [Thread-1  ]: finished collecting timing info
[0m13:13:50.156153 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:13:50.188849 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.07 seconds
[0m13:13:50.196675 [debug] [Thread-4  ]: finished collecting timing info
[0m13:13:50.196841 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:13:50.261853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4411e20>]}
[0m13:13:50.262206 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.30s]
[0m13:13:50.262553 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:13:50.315016 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e0e7040>]}
[0m13:13:50.315393 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.61s]
[0m13:13:50.315718 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:13:51.952830 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.68 seconds
[0m13:13:51.954331 [debug] [Thread-3  ]: finished collecting timing info
[0m13:13:51.954465 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m13:13:52.057044 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d113ee-72a5-4e80-ba1d-f2d2f50627b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d728bee0>]}
[0m13:13:52.057427 [info ] [Thread-3  ]: 3 of 5 OK created table model dev.src_reviews .................................. [[32mSUCCESS 1[0m in 5.49s]
[0m13:13:52.057801 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m13:13:52.059680 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:13:52.060027 [info ] [MainThread]: 
[0m13:13:52.060279 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m13:13:52.060509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:52.060673 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m13:13:52.060798 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m13:13:52.060914 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m13:13:52.061029 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m13:13:52.066899 [info ] [MainThread]: 
[0m13:13:52.067148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:52.067411 [info ] [MainThread]: 
[0m13:13:52.067640 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:13:52.067908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e1f4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d43ce460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d43cec70>]}


============================== 2022-07-28 13:14:16.548722 | b61e6402-2b57-4ccd-a0e9-5018b40ef2b6 ==============================
[0m13:14:16.548740 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:14:16.549257 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:14:16.549455 [debug] [MainThread]: Tracking: tracking
[0m13:14:16.549684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04781e1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04781eb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04781eb0a0>]}
[0m13:14:16.562004 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:14:16.562251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04781fac40>]}
[0m13:14:16.571267 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:14:16.604138 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:14:16.605551 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:14:16.606222 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m13:14:16.609003 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:14:16.615791 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:14:16.618512 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:14:16.619612 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:14:16.623486 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:14:16.623855 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:14:16.624250 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:14:16.624729 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:14:16.625151 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:14:16.632053 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:14:16.642547 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:14:16.645962 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:14:16.648117 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:14:16.657724 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:14:16.659775 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:14:16.661370 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:14:16.666952 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:14:16.669018 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:14:16.670187 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:14:16.671304 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:14:16.677481 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:14:16.680764 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:14:16.681294 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:14:16.681903 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:14:16.682614 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:14:16.683685 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:14:16.685496 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:14:16.688522 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:14:16.689850 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:14:16.691143 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:14:16.694476 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:14:16.707639 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:14:16.712614 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:14:16.713845 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:14:16.721996 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:14:16.734205 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:14:16.743737 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:14:16.754697 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:14:16.765908 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:14:16.772746 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:14:16.773921 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:14:16.777212 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:14:16.779619 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:14:16.780583 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:14:16.784502 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:14:16.786412 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:14:16.788582 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:14:16.792675 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:14:16.794406 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:14:16.795993 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:14:16.796750 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:14:16.797697 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:14:16.798500 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:14:16.799304 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:14:16.800071 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:14:16.801088 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:14:16.802011 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:14:16.803575 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:14:16.804336 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:14:16.805097 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:14:16.805938 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:14:16.806725 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:14:16.807569 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:14:16.808528 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:14:16.809351 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:14:16.814054 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:14:16.814676 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:14:16.815313 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:14:16.816249 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:14:17.005400 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m13:14:17.013517 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m13:14:17.015186 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m13:14:17.017774 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m13:14:17.021238 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m13:14:17.077197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0479279f40>]}
[0m13:14:17.080993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0479279eb0>]}
[0m13:14:17.081207 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:14:17.081389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0478128fd0>]}
[0m13:14:17.082246 [info ] [MainThread]: 
[0m13:14:17.082700 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:14:17.083541 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:14:17.092266 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:14:17.092428 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:14:17.092526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:17.621973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
[0m13:14:17.623311 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:14:17.721190 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:14:17.725954 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:14:17.726111 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:14:17.726214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:18.280349 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.55 seconds
[0m13:14:18.283282 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:14:18.393507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047ba250a0>]}
[0m13:14:18.393908 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:18.394110 [info ] [MainThread]: 
[0m13:14:18.397242 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m13:14:18.398217 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m13:14:18.398470 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m13:14:18.398643 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m13:14:18.398852 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m13:14:18.399296 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m13:14:18.399493 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m13:14:18.399946 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m13:14:18.400089 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m13:14:18.400460 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m13:14:18.400574 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m13:14:18.400764 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m13:14:18.400908 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m13:14:18.401048 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m13:14:18.402209 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:14:18.402360 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m13:14:18.403246 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:14:18.404272 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:14:18.404607 [debug] [Thread-1  ]: finished collecting timing info
[0m13:14:18.404915 [debug] [Thread-2  ]: finished collecting timing info
[0m13:14:18.405036 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m13:14:18.405254 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m13:14:18.405408 [debug] [Thread-3  ]: finished collecting timing info
[0m13:14:18.426639 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m13:14:18.428448 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."SRC_HOSTS" because it is of type table
[0m13:14:18.430148 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type table
[0m13:14:18.430547 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."SRC_LISTINGS" because it is of type table
[0m13:14:18.433598 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:14:18.434914 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:14:18.436115 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:14:18.436305 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
drop table if exists "AIRBNB"."DEV"."SRC_HOSTS" cascade
[0m13:14:18.436482 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
drop table if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m13:14:18.436653 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
drop table if exists "AIRBNB"."DEV"."SRC_LISTINGS" cascade
[0m13:14:18.436825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:14:18.436994 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:14:18.437165 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:14:19.083006 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m13:14:19.090989 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m13:14:19.091491 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:14:19.091596 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m13:14:19.143133 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m13:14:19.144238 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m13:14:19.144723 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:14:19.144825 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m13:14:19.266241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m13:14:19.290814 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.85 seconds
[0m13:14:19.296628 [debug] [Thread-1  ]: finished collecting timing info
[0m13:14:19.297304 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m13:14:19.298287 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m13:14:19.298501 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m13:14:19.299609 [debug] [Thread-3  ]: finished collecting timing info
[0m13:14:19.300398 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m13:14:19.302162 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:14:19.303116 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:14:19.388971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047ba250a0>]}
[0m13:14:19.389309 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.99s]
[0m13:14:19.389632 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m13:14:19.390143 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:14:19.390352 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m13:14:19.390752 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:14:19.390892 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:14:19.391423 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m13:14:19.393399 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:14:19.393752 [debug] [Thread-4  ]: finished collecting timing info
[0m13:14:19.393877 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:14:19.401160 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04713190a0>]}
[0m13:14:19.406772 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.00s]
[0m13:14:19.408996 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:14:19.409375 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m13:14:19.410212 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:14:19.410318 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m13:14:19.410413 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:14:19.453990 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m13:14:19.455244 [debug] [Thread-2  ]: finished collecting timing info
[0m13:14:19.455392 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m13:14:19.570537 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0478100580>]}
[0m13:14:19.570916 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.17s]
[0m13:14:19.571247 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m13:14:19.572103 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:14:19.572525 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m13:14:19.572850 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:14:19.572980 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:14:19.573100 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m13:14:19.574718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:14:19.578162 [debug] [Thread-1  ]: finished collecting timing info
[0m13:14:19.578300 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:14:19.579832 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:14:19.581183 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:14:19.581302 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m13:14:19.581411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:14:20.449945 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.04 seconds
[0m13:14:20.456508 [debug] [Thread-4  ]: finished collecting timing info
[0m13:14:20.456689 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:14:20.732183 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04703f4700>]}
[0m13:14:20.732486 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.34s]
[0m13:14:20.732794 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:14:21.196075 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.61 seconds
[0m13:14:21.197636 [debug] [Thread-1  ]: finished collecting timing info
[0m13:14:21.197770 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:14:21.297895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61e6402-2b57-4ccd-a0e9-5018b40ef2b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0470443550>]}
[0m13:14:21.298199 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.73s]
[0m13:14:21.298492 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:14:21.299705 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:14:21.299950 [info ] [MainThread]: 
[0m13:14:21.300128 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m13:14:21.300300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:21.300387 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m13:14:21.300474 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m13:14:21.300560 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m13:14:21.300675 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m13:14:21.304883 [info ] [MainThread]: 
[0m13:14:21.305095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:21.305295 [info ] [MainThread]: 
[0m13:14:21.305458 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:14:21.305688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04711368b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04711368e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0471136820>]}


============================== 2022-07-29 07:49:36.592222 | 124ef6ce-c51f-42d6-8d35-56b7a078d6b8 ==============================
[0m07:49:36.592239 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:49:36.592541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m07:49:36.592657 [debug] [MainThread]: Tracking: tracking
[0m07:49:36.592843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27602afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb276048040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2760480a0>]}
[0m07:49:36.615632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:49:36.615807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:49:36.619962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '124ef6ce-c51f-42d6-8d35-56b7a078d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274f0b070>]}
[0m07:49:36.624351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '124ef6ce-c51f-42d6-8d35-56b7a078d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274f76250>]}
[0m07:49:36.624587 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:49:36.624752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124ef6ce-c51f-42d6-8d35-56b7a078d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274f08e50>]}
[0m07:49:36.625231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274f08e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274f761c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb274f76220>]}


============================== 2022-07-29 07:51:37.653048 | 17069653-fa2d-477b-9df9-d41fcf2bbf79 ==============================
[0m07:51:37.653056 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:51:37.653301 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:51:37.653408 [debug] [MainThread]: Tracking: tracking
[0m07:51:37.659238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41feaaa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41feaaa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41feb154c0>]}
[0m07:51:37.807861 [debug] [MainThread]: Executing "git --help"
[0m07:51:37.810335 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:51:37.810578 [debug] [MainThread]: STDERR: "b''"
[0m07:51:37.812733 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m07:51:37.813340 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:51:37.813446 [debug] [MainThread]: On debug: select 1 as id
[0m07:51:37.813544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:51:38.422544 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.61 seconds
[0m07:51:38.423305 [debug] [MainThread]: On debug: Close
[0m07:51:38.526368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f8b71c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41fe55e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f8ba06a0>]}
[0m07:51:39.429363 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-29 07:51:50.295307 | bf2fc261-db81-4048-a23b-53cc561f884c ==============================
[0m07:51:50.295324 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:51:50.295650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:51:50.295757 [debug] [MainThread]: Tracking: tracking
[0m07:51:50.295941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69fab040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69fab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69fab100>]}
[0m07:51:50.315669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:51:50.315839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:51:50.319717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69e88f40>]}
[0m07:51:50.323610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69ef6280>]}
[0m07:51:50.323799 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:51:50.323984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69f8e2b0>]}
[0m07:51:50.324872 [info ] [MainThread]: 
[0m07:51:50.325181 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:51:50.325927 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m07:51:50.335114 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m07:51:50.335260 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m07:51:50.335359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:50.869501 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
[0m07:51:50.870772 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:51:50.997812 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:51:51.003572 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:51:51.003867 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:51:51.003980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:51.343353 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.34 seconds
[0m07:51:51.344432 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:51:51.432135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69ebcc10>]}
[0m07:51:51.432523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:51:51.432729 [info ] [MainThread]: 
[0m07:51:51.437032 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:51:51.437247 [info ] [Thread-1  ]: 1 of 5 START view model dev.src_hosts .......................................... [RUN]
[0m07:51:51.437812 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:51:51.437941 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:51:51.438076 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:51:51.439178 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:51:51.439416 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:51:51.439724 [info ] [Thread-2  ]: 2 of 5 START view model dev.src_listings ....................................... [RUN]
[0m07:51:51.439895 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:51:51.440247 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m07:51:51.440541 [info ] [Thread-3  ]: 3 of 5 START view model dev.src_reviews ........................................ [RUN]
[0m07:51:51.440720 [debug] [Thread-1  ]: finished collecting timing info
[0m07:51:51.440912 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:51:51.441284 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m07:51:51.441473 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m07:51:51.441647 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m07:51:51.441809 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:51:51.453284 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:51:51.461545 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m07:51:51.461774 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m07:51:51.463419 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:51:51.463930 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m07:51:51.464404 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m07:51:51.464543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:51:51.466391 [debug] [Thread-2  ]: finished collecting timing info
[0m07:51:51.466526 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m07:51:51.468535 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m07:51:51.468673 [debug] [Thread-3  ]: finished collecting timing info
[0m07:51:51.469396 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m07:51:51.469552 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m07:51:51.469725 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m07:51:51.472142 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m07:51:51.472319 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:51:51.474307 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m07:51:51.474427 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m07:51:51.474522 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:51:52.244004 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m07:51:52.256864 [debug] [Thread-1  ]: finished collecting timing info
[0m07:51:52.257069 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m07:51:52.269057 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.8 seconds
[0m07:51:52.272103 [debug] [Thread-2  ]: finished collecting timing info
[0m07:51:52.272233 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m07:51:52.342534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a682d0190>]}
[0m07:51:52.342848 [info ] [Thread-1  ]: 1 of 5 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.90s]
[0m07:51:52.343159 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:51:52.343653 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:51:52.343831 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m07:51:52.344160 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:51:52.344281 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:51:52.344401 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:51:52.346461 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:51:52.346765 [debug] [Thread-4  ]: finished collecting timing info
[0m07:51:52.346878 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:51:52.393230 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:51:52.393597 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6b04e580>]}
[0m07:51:52.393971 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.95s]
[0m07:51:52.394284 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:51:52.394744 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:51:52.395056 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m07:51:52.395523 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:51:52.395774 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:51:52.395913 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m07:51:52.397579 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:51:52.398036 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:51:52.398271 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m07:51:52.398395 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:51:52.400135 [debug] [Thread-1  ]: finished collecting timing info
[0m07:51:52.400252 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:51:52.402081 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:51:52.402785 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:51:52.402887 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m07:51:52.402981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:51:52.451281 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.98 seconds
[0m07:51:52.452668 [debug] [Thread-3  ]: finished collecting timing info
[0m07:51:52.452797 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m07:51:52.550375 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69021e80>]}
[0m07:51:52.551089 [info ] [Thread-3  ]: 3 of 5 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.11s]
[0m07:51:52.551429 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:51:54.272989 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.87 seconds
[0m07:51:54.278437 [debug] [Thread-4  ]: finished collecting timing info
[0m07:51:54.278572 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m07:51:54.292316 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.89 seconds
[0m07:51:54.293724 [debug] [Thread-1  ]: finished collecting timing info
[0m07:51:54.293852 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m07:51:54.365311 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a682d09d0>]}
[0m07:51:54.365675 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.02s]
[0m07:51:54.366035 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:51:54.384847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2fc261-db81-4048-a23b-53cc561f884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6b04e700>]}
[0m07:51:54.385159 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.99s]
[0m07:51:54.385493 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:51:54.386995 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:51:54.387289 [info ] [MainThread]: 
[0m07:51:54.387506 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m07:51:54.387716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:54.387824 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m07:51:54.387933 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m07:51:54.388041 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m07:51:54.388147 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m07:51:54.392793 [info ] [MainThread]: 
[0m07:51:54.393010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:51:54.393248 [info ] [MainThread]: 
[0m07:51:54.393449 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:51:54.393716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69ef6100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a68fe1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a69028820>]}


============================== 2022-07-29 08:21:00.055043 | 4cefa1ac-a78e-4384-a479-0afafd9a6d39 ==============================
[0m08:21:00.055060 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:21:00.055358 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m08:21:00.055501 [debug] [MainThread]: Tracking: tracking
[0m08:21:00.055787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce739fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce7590a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce759100>]}
[0m08:21:00.076057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:21:00.076332 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fct_reviews.sql
[0m08:21:00.084656 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m08:21:00.096286 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m08:21:00.102607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cefa1ac-a78e-4384-a479-0afafd9a6d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd5f6ee0>]}
[0m08:21:00.106631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cefa1ac-a78e-4384-a479-0afafd9a6d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce6a2e80>]}
[0m08:21:00.106865 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:21:00.107026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cefa1ac-a78e-4384-a479-0afafd9a6d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce6a2ee0>]}
[0m08:21:00.107506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce6a2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce6a2eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ce6a2a60>]}


============================== 2022-07-29 08:21:31.400625 | 7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe ==============================
[0m08:21:31.400640 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:21:31.400991 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:21:31.401103 [debug] [MainThread]: Tracking: tracking
[0m08:21:31.401290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29859d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29859d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29859d2b0>]}
[0m08:21:31.421493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:21:31.421655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:21:31.425580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29848d7c0>]}
[0m08:21:31.429502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29851b6a0>]}
[0m08:21:31.429703 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:21:31.429897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29851b820>]}
[0m08:21:31.430835 [info ] [MainThread]: 
[0m08:21:31.431150 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:21:31.432170 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:21:31.441345 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:21:31.441505 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:21:31.441610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:21:32.030566 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.59 seconds
[0m08:21:32.031844 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:21:32.122043 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:21:32.127125 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:21:32.127245 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:21:32.127345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:21:32.671253 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.54 seconds
[0m08:21:32.672335 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:21:32.767260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29851b3d0>]}
[0m08:21:32.767797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:21:32.768079 [info ] [MainThread]: 
[0m08:21:32.771964 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:21:32.772279 [info ] [Thread-1  ]: 1 of 6 START view model dev.src_hosts .......................................... [RUN]
[0m08:21:32.772990 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:21:32.773137 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:21:32.773286 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:21:32.774447 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:21:32.774726 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:21:32.775006 [info ] [Thread-2  ]: 2 of 6 START view model dev.src_listings ....................................... [RUN]
[0m08:21:32.775389 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:21:32.775645 [debug] [Thread-1  ]: finished collecting timing info
[0m08:21:32.775936 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:21:32.776211 [info ] [Thread-3  ]: 3 of 6 START view model dev.src_reviews ........................................ [RUN]
[0m08:21:32.776442 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:21:32.776691 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:21:32.777205 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:21:32.788257 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:21:32.796920 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:21:32.797185 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:21:32.798293 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:21:32.798579 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:21:32.799012 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:21:32.799994 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:21:32.800293 [debug] [Thread-2  ]: finished collecting timing info
[0m08:21:32.800453 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:21:32.800875 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:21:32.801134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:21:32.801376 [debug] [Thread-3  ]: finished collecting timing info
[0m08:21:32.803541 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:21:32.805406 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:21:32.808031 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:21:32.808765 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:21:32.808904 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:21:32.809036 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:21:32.809905 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:21:32.811029 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:21:32.811154 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:21:33.522050 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m08:21:33.534837 [debug] [Thread-3  ]: finished collecting timing info
[0m08:21:33.534981 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:21:33.540964 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m08:21:33.542230 [debug] [Thread-1  ]: finished collecting timing info
[0m08:21:33.542352 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:21:33.633113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd290062820>]}
[0m08:21:33.633445 [info ] [Thread-1  ]: 1 of 6 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.86s]
[0m08:21:33.633789 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:21:33.634277 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:21:33.634468 [info ] [Thread-4  ]: 4 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m08:21:33.634832 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:21:33.634958 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:21:33.635084 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:21:33.637029 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:21:33.637312 [debug] [Thread-4  ]: finished collecting timing info
[0m08:21:33.637425 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:21:33.650053 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:21:33.651224 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:21:33.651399 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m08:21:33.651521 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:21:33.653907 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd290033100>]}
[0m08:21:33.654220 [info ] [Thread-3  ]: 3 of 6 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.88s]
[0m08:21:33.654652 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:21:33.655156 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m08:21:33.655378 [info ] [Thread-1  ]: 5 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:21:33.655751 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:21:33.655884 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:21:33.656016 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m08:21:33.694340 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:21:33.695815 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m08:21:33.697167 [debug] [Thread-2  ]: finished collecting timing info
[0m08:21:33.697574 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:21:33.699086 [debug] [Thread-1  ]: finished collecting timing info
[0m08:21:33.699209 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:21:33.720107 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:21:33.720660 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:21:33.720769 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
      (-- auto-incremental set up--

-------------------------------
with src_reviews as (
    select * from airbnb.dev.src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


      );
[0m08:21:33.720898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:21:33.807326 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29802bfd0>]}
[0m08:21:33.812998 [info ] [Thread-2  ]: 2 of 6 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.03s]
[0m08:21:33.813469 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:21:33.824511 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:21:33.832601 [info ] [Thread-3  ]: 6 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m08:21:33.840774 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:21:33.842168 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:21:33.842314 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:21:33.844172 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:21:33.850047 [debug] [Thread-3  ]: finished collecting timing info
[0m08:21:33.850873 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:21:33.853010 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:21:33.865424 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:21:33.870809 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m08:21:33.876367 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:21:36.002356 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.35 seconds
[0m08:21:36.007897 [debug] [Thread-4  ]: finished collecting timing info
[0m08:21:36.008096 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:21:36.043806 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.17 seconds
[0m08:21:36.045351 [debug] [Thread-3  ]: finished collecting timing info
[0m08:21:36.045484 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:21:36.098894 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29803ad60>]}
[0m08:21:36.099235 [info ] [Thread-4  ]: 4 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.46s]
[0m08:21:36.099552 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:21:36.143544 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd29004eb80>]}
[0m08:21:36.143845 [info ] [Thread-3  ]: 6 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 2.30s]
[0m08:21:36.144145 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:21:38.975435 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.25 seconds
[0m08:21:38.976914 [debug] [Thread-1  ]: finished collecting timing info
[0m08:21:38.977050 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m08:21:39.063372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fcdc8d9-f65e-4dd8-ae90-98c8870f63fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2935d7c70>]}
[0m08:21:39.063745 [info ] [Thread-1  ]: 5 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 1[0m in 5.41s]
[0m08:21:39.064127 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:21:39.065470 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:21:39.065780 [info ] [MainThread]: 
[0m08:21:39.066000 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m08:21:39.066214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:21:39.066383 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:21:39.066542 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:21:39.066653 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:21:39.066763 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:21:39.071621 [info ] [MainThread]: 
[0m08:21:39.071873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:21:39.072102 [info ] [MainThread]: 
[0m08:21:39.072296 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:21:39.072560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2935bc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2996602b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd299660a30>]}


============================== 2022-07-29 08:34:56.702286 | 97992c83-517f-42fa-91e3-57af90cdf30e ==============================
[0m08:34:56.702311 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:34:56.702861 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:34:56.703070 [debug] [MainThread]: Tracking: tracking
[0m08:34:56.703436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa485130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa485190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa4851f0>]}
[0m08:34:56.735530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:34:56.735698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:34:56.741297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea934d700>]}
[0m08:34:56.745926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa4205e0>]}
[0m08:34:56.746196 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:34:56.746416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa420760>]}
[0m08:34:56.747454 [info ] [MainThread]: 
[0m08:34:56.748062 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:34:56.749207 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:34:56.759530 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:34:56.759718 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:34:56.759834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:57.318833 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.56 seconds
[0m08:34:57.320082 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:34:57.412398 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:34:57.417614 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:34:57.417922 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:34:57.418042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:57.934211 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.52 seconds
[0m08:34:57.935272 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:34:58.024547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa420490>]}
[0m08:34:58.025118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:34:58.025455 [info ] [MainThread]: 
[0m08:34:58.029773 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:34:58.030049 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:34:58.030958 [info ] [Thread-1  ]: 1 of 6 START view model dev.src_hosts .......................................... [RUN]
[0m08:34:58.031235 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:34:58.031615 [info ] [Thread-2  ]: 2 of 6 START view model dev.src_listings ....................................... [RUN]
[0m08:34:58.032281 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:34:58.032646 [info ] [Thread-3  ]: 3 of 6 START view model dev.src_reviews ........................................ [RUN]
[0m08:34:58.033290 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:34:58.033607 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:34:58.034261 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:34:58.034562 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:34:58.034883 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:34:58.035165 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:34:58.035449 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:34:58.036868 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:34:58.037091 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:34:58.038130 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:34:58.039470 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:34:58.040011 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:58.040237 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:58.040521 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:34:58.040889 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:58.041051 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:34:58.046491 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:34:58.060990 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:34:58.062966 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:34:58.065231 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:34:58.066268 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:34:58.066420 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:34:58.066552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:34:58.066893 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:34:58.069153 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:34:58.069315 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:34:58.069528 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:34:58.069863 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:34:58.070209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:34:58.719811 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.65 seconds
[0m08:34:58.734576 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:58.734763 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:34:58.832779 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea8480790>]}
[0m08:34:58.833106 [info ] [Thread-2  ]: 2 of 6 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.80s]
[0m08:34:58.833443 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:34:58.833958 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:34:58.834153 [info ] [Thread-4  ]: 4 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m08:34:58.834506 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:34:58.834638 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:34:58.834772 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:34:58.836760 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:34:58.837056 [debug] [Thread-4  ]: finished collecting timing info
[0m08:34:58.837176 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:34:58.850663 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:34:58.851361 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:34:58.851474 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m08:34:58.851577 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:34:58.989702 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.92 seconds
[0m08:34:58.996372 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:58.996534 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:34:59.023565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m08:34:59.030201 [debug] [Thread-1  ]: finished collecting timing info
[0m08:34:59.036108 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:34:59.108157 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa502430>]}
[0m08:34:59.108477 [info ] [Thread-3  ]: 3 of 6 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.07s]
[0m08:34:59.108793 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:34:59.109299 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m08:34:59.109480 [info ] [Thread-2  ]: 5 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:34:59.109808 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:34:59.109946 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:34:59.110076 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m08:34:59.116803 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:34:59.117111 [debug] [Thread-2  ]: finished collecting timing info
[0m08:34:59.117247 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:34:59.136134 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:34:59.136358 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with src_reviews as (
    select * from airbnb.dev.src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m08:34:59.136493 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:34:59.139600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa420340>]}
[0m08:34:59.139915 [info ] [Thread-1  ]: 1 of 6 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 1.11s]
[0m08:34:59.140228 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:34:59.140714 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:34:59.140922 [info ] [Thread-3  ]: 6 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m08:34:59.141418 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:34:59.141647 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:34:59.141859 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:34:59.143961 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:34:59.144276 [debug] [Thread-3  ]: finished collecting timing info
[0m08:34:59.144393 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:34:59.146128 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:34:59.148601 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:34:59.148764 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m08:34:59.148886 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:35:00.256438 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m08:35:00.262772 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:00.262930 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:35:00.336298 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m08:35:00.338653 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:00.338772 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:35:00.432459 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m08:35:00.442368 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:00.442518 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:35:00.485937 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.34 seconds
[0m08:35:00.490735 [debug] [Thread-3  ]: finished collecting timing info
[0m08:35:00.490915 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:35:00.496741 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m08:35:00.499021 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:00.499135 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:35:00.548781 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.7 seconds
[0m08:35:00.550566 [debug] [Thread-4  ]: finished collecting timing info
[0m08:35:00.550717 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:35:00.562048 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m08:35:00.568128 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:35:00.576746 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:35:00.577777 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:00.577896 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m08:35:00.578354 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea814ba30>]}
[0m08:35:00.578758 [info ] [Thread-3  ]: 6 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.44s]
[0m08:35:00.579089 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:35:00.640370 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea84ea880>]}
[0m08:35:00.640678 [info ] [Thread-4  ]: 4 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.81s]
[0m08:35:00.641011 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:35:00.653986 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m08:35:00.654224 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:00.654344 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:35:01.219413 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.56 seconds
[0m08:35:01.219632 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:35:01.219736 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:35:01.440050 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m08:35:01.441593 [debug] [Thread-2  ]: finished collecting timing info
[0m08:35:01.441739 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m08:35:01.553378 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97992c83-517f-42fa-91e3-57af90cdf30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaa502a60>]}
[0m08:35:01.553695 [info ] [Thread-2  ]: 5 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 1[0m in 2.44s]
[0m08:35:01.554014 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:35:01.555430 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:35:01.555729 [info ] [MainThread]: 
[0m08:35:01.555935 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m08:35:01.556131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:01.556231 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m08:35:01.556355 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:35:01.556451 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:35:01.556546 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:35:01.560886 [info ] [MainThread]: 
[0m08:35:01.561129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:35:01.561351 [info ] [MainThread]: 
[0m08:35:01.561532 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:35:01.561783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea83c3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea83c3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ea83c3850>]}


============================== 2022-07-29 08:38:06.360541 | 86dc2f83-a7cb-4d95-8e41-b6592a9f5576 ==============================
[0m08:38:06.360559 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:38:06.360922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:38:06.361039 [debug] [MainThread]: Tracking: tracking
[0m08:38:06.361243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005d621c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005d62220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005d62280>]}
[0m08:38:06.381868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:06.382029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:06.385877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005c4d790>]}
[0m08:38:06.390018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cdb670>]}
[0m08:38:06.390208 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:38:06.390408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cdb7f0>]}
[0m08:38:06.391378 [info ] [MainThread]: 
[0m08:38:06.391693 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:38:06.392444 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:38:06.401571 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:38:06.401744 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:38:06.401851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:06.979256 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.58 seconds
[0m08:38:06.980514 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:38:07.079294 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:38:07.084500 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:38:07.084629 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:38:07.084734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:07.617971 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.53 seconds
[0m08:38:07.619346 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:38:07.712480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cdb3a0>]}
[0m08:38:07.712917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:07.713161 [info ] [MainThread]: 
[0m08:38:07.717189 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:38:07.717469 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:38:07.718197 [info ] [Thread-1  ]: 1 of 6 START view model dev.src_hosts .......................................... [RUN]
[0m08:38:07.718533 [info ] [Thread-2  ]: 2 of 6 START view model dev.src_listings ....................................... [RUN]
[0m08:38:07.718743 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:38:07.719304 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:38:07.719912 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:38:07.720219 [info ] [Thread-3  ]: 3 of 6 START view model dev.src_reviews ........................................ [RUN]
[0m08:38:07.720466 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:38:07.720709 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:38:07.721228 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:38:07.721437 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:38:07.721659 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:38:07.721883 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:38:07.723520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:38:07.724820 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:38:07.725056 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:38:07.725550 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:07.726771 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:38:07.727056 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:07.727264 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:38:07.727577 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:38:07.744131 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:07.757796 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:38:07.758006 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:38:07.759200 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:38:07.762161 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:38:07.762992 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:38:07.763964 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:38:07.764342 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:38:07.764509 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:38:07.764688 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:38:07.764839 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:38:07.765016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:07.765201 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:38:07.765394 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:38:08.493688 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.73 seconds
[0m08:38:08.509030 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:08.509189 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:38:08.512932 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m08:38:08.514364 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:08.514515 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:38:08.516241 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m08:38:08.517790 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:08.517927 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:38:08.600600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cdb490>]}
[0m08:38:08.601491 [info ] [Thread-1  ]: 1 of 6 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.88s]
[0m08:38:08.601951 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:38:08.602585 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:38:08.602833 [info ] [Thread-4  ]: 4 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m08:38:08.603397 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00403a0a0>]}
[0m08:38:08.603930 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:38:08.604346 [info ] [Thread-3  ]: 3 of 6 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.88s]
[0m08:38:08.604654 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:38:08.605168 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:38:08.605437 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:38:08.608195 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:38:08.608937 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m08:38:08.609369 [info ] [Thread-1  ]: 5 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:38:08.609904 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:38:08.610258 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:08.610463 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:38:08.610710 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:38:08.611075 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m08:38:08.626723 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cb2b80>]}
[0m08:38:08.664255 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:38:08.664620 [info ] [Thread-2  ]: 2 of 6 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.91s]
[0m08:38:08.667355 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:38:08.667802 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:38:08.668596 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:38:08.669153 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:38:08.669298 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:08.669507 [info ] [Thread-3  ]: 6 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m08:38:08.669756 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m08:38:08.669952 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:38:08.670360 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:38:08.670540 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:38:08.681203 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:38:08.692589 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:38:08.693792 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:38:08.699229 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:38:08.700157 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:38:08.700320 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
      (-- auto-incremental set up--

-------------------------------
with src_reviews as (
    select * from airbnb.dev.src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


      );
[0m08:38:08.700453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:08.701262 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:08.701423 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:38:08.703190 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:38:08.705191 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:38:08.705357 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m08:38:08.705490 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:38:10.450512 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.75 seconds
[0m08:38:10.455503 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:10.455642 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:38:10.628151 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005de7340>]}
[0m08:38:10.628468 [info ] [Thread-3  ]: 6 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.96s]
[0m08:38:10.628780 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:38:12.207954 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.54 seconds
[0m08:38:12.209602 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:12.209744 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:38:12.298608 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0095b4f70>]}
[0m08:38:12.298927 [info ] [Thread-4  ]: 4 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 3.69s]
[0m08:38:12.299241 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:38:13.811781 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.11 seconds
[0m08:38:13.815690 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:13.815852 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m08:38:13.915184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86dc2f83-a7cb-4d95-8e41-b6592a9f5576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa004054310>]}
[0m08:38:13.915511 [info ] [Thread-1  ]: 5 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 1[0m in 5.31s]
[0m08:38:13.915845 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:38:13.917154 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:38:13.917421 [info ] [MainThread]: 
[0m08:38:13.917624 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m08:38:13.917824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:13.917924 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:38:13.918026 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:38:13.918126 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:38:13.918224 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:38:13.922901 [info ] [MainThread]: 
[0m08:38:13.923130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:13.923345 [info ] [MainThread]: 
[0m08:38:13.923525 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:38:13.923781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0053f07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cdb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005cdb3d0>]}


============================== 2022-07-29 08:53:29.442184 | 6962e5a9-2ea5-4a13-8571-f62dbda92236 ==============================
[0m08:53:29.442199 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:53:29.442489 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m08:53:29.442603 [debug] [MainThread]: Tracking: tracking
[0m08:53:29.442791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1425300fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142531b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142531b0d0>]}
[0m08:53:29.463110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:53:29.463367 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m08:53:29.473489 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:53:29.486792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6962e5a9-2ea5-4a13-8571-f62dbda92236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14241b2eb0>]}
[0m08:53:29.490651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6962e5a9-2ea5-4a13-8571-f62dbda92236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1425260fd0>]}
[0m08:53:29.490881 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:53:29.491035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6962e5a9-2ea5-4a13-8571-f62dbda92236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1425260a00>]}
[0m08:53:29.491507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1425300fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1425260f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1425260c10>]}


============================== 2022-07-29 08:53:54.919331 | ad21922e-6800-4c8f-89ee-c98cf1122b59 ==============================
[0m08:53:54.919347 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:53:54.919643 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m08:53:54.919755 [debug] [MainThread]: Tracking: tracking
[0m08:53:54.919939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac939e90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac939e90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac939e9130>]}
[0m08:53:54.939580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:54.939738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:54.943633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad21922e-6800-4c8f-89ee-c98cf1122b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac938d09a0>]}
[0m08:53:54.947958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad21922e-6800-4c8f-89ee-c98cf1122b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac93959970>]}
[0m08:53:54.948201 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:53:54.948375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad21922e-6800-4c8f-89ee-c98cf1122b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac939599d0>]}
[0m08:53:54.948869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac93959a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac93959820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac93959490>]}


============================== 2022-07-29 08:53:56.705588 | 91804ed2-c647-44f7-b6df-8afd364c5dd1 ==============================
[0m08:53:56.705608 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:53:56.706083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:53:56.706236 [debug] [MainThread]: Tracking: tracking
[0m08:53:56.706492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3af2b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3af2b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3af2b160>]}
[0m08:53:56.729492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:56.729668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:56.736314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf39dcf9d0>]}
[0m08:53:56.740706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3ae979d0>]}
[0m08:53:56.740956 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:53:56.741160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3ae97a00>]}
[0m08:53:56.742134 [info ] [MainThread]: 
[0m08:53:56.742483 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:53:56.743327 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:53:56.753767 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:53:56.753969 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:53:56.754078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:57.424245 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.67 seconds
[0m08:53:57.425976 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:53:57.519616 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:53:57.524718 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:53:57.524846 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:53:57.524946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:57.940504 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.42 seconds
[0m08:53:57.941912 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:53:58.026897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf38ffdf70>]}
[0m08:53:58.027282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:58.027499 [info ] [MainThread]: 
[0m08:53:58.030709 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:53:58.030941 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m08:53:58.031528 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:53:58.031666 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:53:58.031816 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:53:58.032006 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:53:58.032169 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:53:58.032413 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m08:53:58.033713 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:53:58.033959 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m08:53:58.034396 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:53:58.035038 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:53:58.035293 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:53:58.035435 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:53:58.035619 [debug] [Thread-1  ]: finished collecting timing info
[0m08:53:58.035808 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:53:58.036813 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:53:58.037014 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:53:58.037204 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:53:58.037502 [debug] [Thread-2  ]: finished collecting timing info
[0m08:53:58.049125 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:53:58.057823 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:53:58.058120 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:53:58.060443 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:53:58.060932 [debug] [Thread-3  ]: finished collecting timing info
[0m08:53:58.061327 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:53:58.061486 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:53:58.061805 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:53:58.061986 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:53:58.064338 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:53:58.064516 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:53:58.064698 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:53:58.064990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:53:58.065440 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:53:58.068949 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:53:58.069094 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:53:58.838648 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.77 seconds
[0m08:53:58.863285 [debug] [Thread-1  ]: finished collecting timing info
[0m08:53:58.863580 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:53:58.955677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf38f81b80>]}
[0m08:53:58.956052 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.92s]
[0m08:53:58.956453 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:53:58.957101 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:53:58.957353 [info ] [Thread-4  ]: 4 of 7 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m08:53:58.957822 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:58.957990 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:53:58.958172 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:53:58.960888 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:58.961283 [debug] [Thread-4  ]: finished collecting timing info
[0m08:53:58.961442 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:53:59.012260 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.94 seconds
[0m08:53:59.014968 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:59.016361 [debug] [Thread-3  ]: finished collecting timing info
[0m08:53:59.017065 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m08:53:59.017399 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:53:59.018980 [debug] [Thread-2  ]: finished collecting timing info
[0m08:53:59.019514 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:59.021163 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:53:59.021352 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m08:53:59.022712 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:53:59.125098 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381bdfa0>]}
[0m08:53:59.130611 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 1.09s]
[0m08:53:59.131089 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:53:59.131734 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381d61f0>]}
[0m08:53:59.137811 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 1.10s]
[0m08:53:59.143694 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:53:59.149335 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:53:59.150149 [info ] [Thread-3  ]: 5 of 7 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m08:53:59.150752 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:53:59.156084 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:53:59.161446 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:53:59.167024 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m08:53:59.169068 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:53:59.179439 [info ] [Thread-1  ]: 6 of 7 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:53:59.189029 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:59.189296 [debug] [Thread-3  ]: finished collecting timing info
[0m08:53:59.189476 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:53:59.189820 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:53:59.190403 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m08:53:59.192536 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:53:59.202807 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:53:59.203398 [debug] [Thread-1  ]: finished collecting timing info
[0m08:53:59.203555 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:53:59.204047 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:53:59.223364 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:59.223915 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m08:53:59.224179 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with src_reviews as (
    select * from airbnb.dev.src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m08:53:59.225091 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:53:59.225516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:54:00.522987 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.3 seconds
[0m08:54:00.529304 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:00.529440 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:54:00.601616 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m08:54:00.604095 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:00.604229 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:54:00.675410 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m08:54:00.685304 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:00.685459 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:54:00.748449 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m08:54:00.751567 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:00.751748 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:54:00.811627 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m08:54:00.819267 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:54:00.829943 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:54:00.830514 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:00.830652 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m08:54:00.905366 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.07 seconds
[0m08:54:00.905574 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:00.905693 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:54:00.911215 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.89 seconds
[0m08:54:00.915732 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:00.915865 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:54:00.953986 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.73 seconds
[0m08:54:00.955861 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:00.956023 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:54:01.000902 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3d72eeb0>]}
[0m08:54:01.001288 [info ] [Thread-4  ]: 4 of 7 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.04s]
[0m08:54:01.001679 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:54:01.070708 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3afa3820>]}
[0m08:54:01.071027 [info ] [Thread-3  ]: 5 of 7 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.92s]
[0m08:54:01.071329 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:54:01.071808 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:54:01.071991 [info ] [Thread-2  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m08:54:01.072318 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:54:01.072447 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:54:01.072571 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:54:01.074711 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:54:01.074983 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:01.075100 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:54:01.076672 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:54:01.077244 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:54:01.077347 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_id,
    h.host_name
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m08:54:01.077449 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:54:01.092234 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.19 seconds
[0m08:54:01.092458 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:54:01.092563 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:54:01.215436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m08:54:01.222139 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:01.222304 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m08:54:01.337728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381a10a0>]}
[0m08:54:01.338047 [info ] [Thread-1  ]: 6 of 7 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 2.15s]
[0m08:54:01.338365 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:54:01.431040 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a5ed55-3201-06f6-0000-d015000191d6
[0m08:54:01.431187 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 5 unexpected '.'.
syntax error line 24 at position 15 unexpected '('.
[0m08:54:01.431366 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:01.431481 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m08:54:01.518787 [debug] [Thread-2  ]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 5 unexpected '.'.
  syntax error line 24 at position 15 unexpected '('.
  compiled SQL at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m08:54:01.519061 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91804ed2-c647-44f7-b6df-8afd364c5dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf381a1af0>]}
[0m08:54:01.519320 [error] [Thread-2  ]: 7 of 7 ERROR creating table model dev.dim_listings_w_hosts ..................... [[31mERROR[0m in 0.45s]
[0m08:54:01.519620 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:54:01.521138 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:54:01.521462 [info ] [MainThread]: 
[0m08:54:01.521666 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 4.78 seconds (4.78s).
[0m08:54:01.521858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:01.521956 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:54:01.522051 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m08:54:01.522145 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:54:01.522244 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:54:01.526473 [info ] [MainThread]: 
[0m08:54:01.526678 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:54:01.526890 [info ] [MainThread]: 
[0m08:54:01.527070 [error] [MainThread]: [33mDatabase Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)[0m
[0m08:54:01.527244 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m08:54:01.527411 [error] [MainThread]:   syntax error line 20 at position 5 unexpected '.'.
[0m08:54:01.527576 [error] [MainThread]:   syntax error line 24 at position 15 unexpected '('.
[0m08:54:01.527744 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m08:54:01.527929 [info ] [MainThread]: 
[0m08:54:01.528105 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m08:54:01.528348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf38f2cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf38209f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf38f1a190>]}


============================== 2022-07-29 08:57:15.886789 | 3367a1f3-2d86-4ebb-a8e4-5a291d769032 ==============================
[0m08:57:15.886804 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:57:15.887093 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m08:57:15.887207 [debug] [MainThread]: Tracking: tracking
[0m08:57:15.887389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1d610a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1d61130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1d61190>]}
[0m08:57:15.907004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:15.907298 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m08:57:15.917247 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:57:15.930963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3367a1f3-2d86-4ebb-a8e4-5a291d769032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd01ed190>]}
[0m08:57:15.934905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3367a1f3-2d86-4ebb-a8e4-5a291d769032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1ca3640>]}
[0m08:57:15.935101 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:57:15.935251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3367a1f3-2d86-4ebb-a8e4-5a291d769032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd01ecfa0>]}
[0m08:57:15.935708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1dd8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1dd87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd1dd8a90>]}


============================== 2022-07-29 08:57:16.569666 | 9ab15201-b257-4b07-afee-74528e9039f7 ==============================
[0m08:57:16.569682 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:57:16.570022 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:57:16.570134 [debug] [MainThread]: Tracking: tracking
[0m08:57:16.570321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae4a7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae4a71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae4a7250>]}
[0m08:57:16.590402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:57:16.590574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:57:16.594677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ad38fac0>]}
[0m08:57:16.599344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae420ac0>]}
[0m08:57:16.599581 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:57:16.599777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae420af0>]}
[0m08:57:16.600729 [info ] [MainThread]: 
[0m08:57:16.601075 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:57:16.601868 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:57:16.611098 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:57:16.611290 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:57:16.611405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:17.228230 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.62 seconds
[0m08:57:17.230191 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:57:17.327676 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:57:17.334233 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:57:17.334365 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:57:17.334465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:17.906695 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.57 seconds
[0m08:57:17.907788 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:57:17.998933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ad38f8b0>]}
[0m08:57:17.999657 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:18.000109 [info ] [MainThread]: 
[0m08:57:18.003407 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:57:18.003610 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:57:18.004240 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m08:57:18.004511 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m08:57:18.004675 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:57:18.005116 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:57:18.005520 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:57:18.005775 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m08:57:18.006025 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:57:18.006205 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:57:18.006601 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:57:18.006816 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:57:18.007008 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:57:18.007183 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:57:18.008784 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:57:18.009794 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:57:18.009993 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:57:18.011316 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:57:18.011789 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:18.012003 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:57:18.012159 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:18.012313 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:18.023139 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:57:18.032257 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:57:18.032543 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:57:18.034477 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:57:18.036956 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:57:18.037827 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:57:18.038079 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:57:18.038215 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:57:18.038563 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:57:18.039493 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:57:18.039823 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:57:18.039968 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:57:18.041151 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:57:18.042789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:18.783758 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m08:57:18.798104 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:18.798281 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:57:18.819038 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m08:57:18.820494 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:18.820628 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:57:18.830505 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m08:57:18.832139 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:18.832271 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:57:18.894877 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ac135400>]}
[0m08:57:18.895347 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.89s]
[0m08:57:18.895852 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:57:18.896424 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m08:57:18.896741 [info ] [Thread-4  ]: 4 of 7 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:57:18.897275 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:18.897448 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:57:18.897624 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m08:57:18.907313 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:57:18.908146 [debug] [Thread-4  ]: finished collecting timing info
[0m08:57:18.908350 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:57:18.914317 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ad38f850>]}
[0m08:57:18.923063 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.91s]
[0m08:57:18.928751 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:57:18.968299 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:18.968498 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with src_reviews as (
    select * from airbnb.dev.src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m08:57:18.969249 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:57:18.969456 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:57:18.970512 [info ] [Thread-3  ]: 5 of 7 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m08:57:18.970908 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:57:18.971169 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:57:18.971414 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:57:18.973204 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:57:18.974735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ac166100>]}
[0m08:57:18.975011 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.97s]
[0m08:57:18.975317 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:57:18.976034 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:57:18.976185 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:18.976415 [info ] [Thread-2  ]: 6 of 7 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m08:57:18.976679 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:57:18.977082 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:18.984238 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:57:18.984448 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:57:18.984744 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:57:18.986300 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:18.986980 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:57:18.987105 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m08:57:18.987223 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:57:18.988933 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:18.989052 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:57:18.990607 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:18.991142 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:18.991243 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m08:57:18.991338 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:57:19.785522 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m08:57:19.792989 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:19.793115 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:57:19.861416 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m08:57:19.863953 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:19.864095 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:57:19.951276 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.09 seconds
[0m08:57:19.960847 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:19.960987 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:57:20.012923 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m08:57:20.015170 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:20.015301 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:57:20.069342 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m08:57:20.076350 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:57:20.086340 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:57:20.086791 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:20.086899 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m08:57:20.175694 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.09 seconds
[0m08:57:20.175942 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:20.176116 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:57:20.228349 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.24 seconds
[0m08:57:20.233125 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:20.233288 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:57:20.293939 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.31 seconds
[0m08:57:20.295867 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:20.296045 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:57:20.323498 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ac156130>]}
[0m08:57:20.323795 [info ] [Thread-2  ]: 6 of 7 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.35s]
[0m08:57:20.324105 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:57:20.335589 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.16 seconds
[0m08:57:20.335814 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:20.335930 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:57:20.379119 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b0ce1cd0>]}
[0m08:57:20.379452 [info ] [Thread-3  ]: 5 of 7 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.41s]
[0m08:57:20.379775 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:57:20.380266 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:57:20.380450 [info ] [Thread-1  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m08:57:20.380811 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:20.380945 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:57:20.381083 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:57:20.383178 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:20.383450 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:20.383563 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:57:20.385068 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:20.385634 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:20.385736 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m08:57:20.385834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:20.475040 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.14 seconds
[0m08:57:20.481746 [debug] [Thread-4  ]: finished collecting timing info
[0m08:57:20.481907 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: Close
[0m08:57:20.628382 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b3f8c130>]}
[0m08:57:20.628716 [info ] [Thread-4  ]: 4 of 7 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 1.73s]
[0m08:57:20.629061 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:57:20.725668 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5ed59-3201-06f6-0000-d015000191f2
[0m08:57:20.725829 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 5 unexpected '.'.
syntax error line 23 at position 15 unexpected '('.
[0m08:57:20.726016 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:20.726134 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m08:57:20.842934 [debug] [Thread-1  ]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 5 unexpected '.'.
  syntax error line 23 at position 15 unexpected '('.
  compiled SQL at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m08:57:20.843198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab15201-b257-4b07-afee-74528e9039f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ac1085b0>]}
[0m08:57:20.843446 [error] [Thread-1  ]: 7 of 7 ERROR creating table model dev.dim_listings_w_hosts ..................... [[31mERROR[0m in 0.46s]
[0m08:57:20.843746 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:57:20.844930 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:57:20.845230 [info ] [MainThread]: 
[0m08:57:20.845538 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m08:57:20.845747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:20.845849 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m08:57:20.845945 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:57:20.846040 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:57:20.846139 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:57:20.851158 [info ] [MainThread]: 
[0m08:57:20.851400 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:57:20.851607 [info ] [MainThread]: 
[0m08:57:20.851789 [error] [MainThread]: [33mDatabase Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)[0m
[0m08:57:20.851966 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m08:57:20.852136 [error] [MainThread]:   syntax error line 19 at position 5 unexpected '.'.
[0m08:57:20.852306 [error] [MainThread]:   syntax error line 23 at position 15 unexpected '('.
[0m08:57:20.852474 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m08:57:20.852659 [info ] [MainThread]: 
[0m08:57:20.852838 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m08:57:20.853119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b44744c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ac40b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ac40bd60>]}


============================== 2022-07-29 08:57:47.146543 | cc381a15-ed7d-4627-8e4f-7504a9c61724 ==============================
[0m08:57:47.146570 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:57:47.146878 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m08:57:47.146990 [debug] [MainThread]: Tracking: tracking
[0m08:57:47.147177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104da4a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104da4a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104da4a1c0>]}
[0m08:57:47.166781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:47.167095 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m08:57:47.176435 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:57:47.190335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc381a15-ed7d-4627-8e4f-7504a9c61724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104c0ed070>]}
[0m08:57:47.194387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc381a15-ed7d-4627-8e4f-7504a9c61724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104c974d00>]}
[0m08:57:47.194619 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:57:47.194780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc381a15-ed7d-4627-8e4f-7504a9c61724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104c0eee50>]}
[0m08:57:47.195284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104dac1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104dac1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104dac11f0>]}


============================== 2022-07-29 08:57:47.645081 | b23051de-1370-4ff3-a5d3-38a09a964ddc ==============================
[0m08:57:47.645096 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:57:47.645460 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:57:47.645580 [debug] [MainThread]: Tracking: tracking
[0m08:57:47.645776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d86f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d86f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d86f1f0>]}
[0m08:57:47.666833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:57:47.667003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:57:47.671020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5c74ea60>]}
[0m08:57:47.674996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d80da60>]}
[0m08:57:47.675214 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:57:47.675422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d80da90>]}
[0m08:57:47.676419 [info ] [MainThread]: 
[0m08:57:47.676786 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:57:47.677922 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:57:47.686903 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:57:47.687045 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:57:47.687154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:48.228561 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
[0m08:57:48.229833 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:57:48.318293 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:57:48.323721 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:57:48.323867 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:57:48.323974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:48.847314 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.52 seconds
[0m08:57:48.848444 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:57:48.941320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5c1544f0>]}
[0m08:57:48.941914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:48.942348 [info ] [MainThread]: 
[0m08:57:48.945962 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:57:48.946199 [info ] [Thread-1  ]: 1 of 7 START view model dev.src_hosts .......................................... [RUN]
[0m08:57:48.946812 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:57:48.946956 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:57:48.947101 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:57:48.948216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:57:48.948482 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:57:48.948687 [info ] [Thread-2  ]: 2 of 7 START view model dev.src_listings ....................................... [RUN]
[0m08:57:48.949256 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:57:48.949527 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:57:48.949749 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:57:48.950004 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:48.950240 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:57:48.950500 [info ] [Thread-3  ]: 3 of 7 START view model dev.src_reviews ........................................ [RUN]
[0m08:57:48.950711 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m08:57:48.951784 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:57:48.952209 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:57:48.976267 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m08:57:48.976467 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:48.976716 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:57:48.977175 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m08:57:48.977565 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:57:48.978148 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m08:57:48.980231 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.src_listings"
[0m08:57:48.981433 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:57:48.981647 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m08:57:48.982356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:48.982517 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:48.983560 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m08:57:48.983990 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m08:57:48.987873 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.src_reviews"
[0m08:57:48.988218 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace  view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m08:57:48.988476 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:57:48.990458 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m08:57:48.990576 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace  view airbnb.dev.src_reviews
  
   as (
    with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m08:57:48.990689 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:57:49.676688 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.69 seconds
[0m08:57:49.691995 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:49.692184 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m08:57:49.693128 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.71 seconds
[0m08:57:49.694481 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:49.694626 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m08:57:49.713822 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.73 seconds
[0m08:57:49.715592 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:49.715726 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m08:57:49.780714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b54356130>]}
[0m08:57:49.781140 [info ] [Thread-1  ]: 1 of 7 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.83s]
[0m08:57:49.781485 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:57:49.782013 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:57:49.782210 [info ] [Thread-4  ]: 4 of 7 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m08:57:49.782574 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:49.782708 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:57:49.782843 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:57:49.784634 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:49.785362 [debug] [Thread-4  ]: finished collecting timing info
[0m08:57:49.785497 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:57:49.792569 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d80d2b0>]}
[0m08:57:49.798231 [info ] [Thread-3  ]: 3 of 7 OK created view model dev.src_reviews ................................... [[32mSUCCESS 1[0m in 0.84s]
[0m08:57:49.800101 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:49.800481 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:57:49.801726 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m08:57:49.802119 [info ] [Thread-1  ]: 5 of 7 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:57:49.802544 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:57:49.802930 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:49.803412 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b54352130>]}
[0m08:57:49.803625 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m08:57:49.803909 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:57:49.804260 [info ] [Thread-2  ]: 2 of 7 OK created view model dev.src_listings .................................. [[32mSUCCESS 1[0m in 0.85s]
[0m08:57:49.804485 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:57:49.804690 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m08:57:49.805090 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:57:49.845648 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:57:49.846308 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:57:49.846966 [info ] [Thread-3  ]: 6 of 7 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m08:57:49.847358 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:57:49.847550 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:57:49.847686 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:57:49.849390 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:57:49.849655 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:49.849834 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:49.849990 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:57:49.850191 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:57:49.863062 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:57:49.873028 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:49.873325 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with src_reviews as (
    select * from airbnb.dev.src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m08:57:49.873615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:49.875908 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:57:49.876080 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with src_listings as(
    select * from airbnb.dev.src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m08:57:49.876340 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:57:50.891415 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.02 seconds
[0m08:57:50.898025 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:50.898170 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:57:50.974109 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m08:57:50.977454 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:50.977641 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:57:51.038987 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m08:57:51.055249 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:51.055467 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:57:51.079792 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m08:57:51.085603 [debug] [Thread-4  ]: finished collecting timing info
[0m08:57:51.085781 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:57:51.110277 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.23 seconds
[0m08:57:51.111910 [debug] [Thread-3  ]: finished collecting timing info
[0m08:57:51.112066 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:57:51.124047 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m08:57:51.126406 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:51.126529 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:57:51.178322 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b54307850>]}
[0m08:57:51.178658 [info ] [Thread-4  ]: 4 of 7 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.40s]
[0m08:57:51.178981 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:57:51.182733 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m08:57:51.189184 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:57:51.198246 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:57:51.198771 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:51.198887 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m08:57:51.201838 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5d8fc880>]}
[0m08:57:51.202097 [info ] [Thread-3  ]: 6 of 7 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.35s]
[0m08:57:51.202394 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:57:51.202869 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:57:51.203055 [info ] [Thread-2  ]: 7 of 7 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m08:57:51.203383 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:51.203523 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:57:51.203654 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:57:51.205574 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:51.205849 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:51.205969 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:57:51.207539 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:51.208138 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:57:51.208246 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m08:57:51.208349 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:57:51.279513 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m08:57:51.284976 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:51.285119 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:57:51.461860 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.18 seconds
[0m08:57:51.462102 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:57:51.462230 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:57:51.593605 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m08:57:51.595219 [debug] [Thread-1  ]: finished collecting timing info
[0m08:57:51.595372 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m08:57:51.694194 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5c154e20>]}
[0m08:57:51.694543 [info ] [Thread-1  ]: 5 of 7 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 1.89s]
[0m08:57:51.694901 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:57:52.403823 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.2 seconds
[0m08:57:52.405236 [debug] [Thread-2  ]: finished collecting timing info
[0m08:57:52.405379 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m08:57:52.488489 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b23051de-1370-4ff3-a5d3-38a09a964ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5430c580>]}
[0m08:57:52.488885 [info ] [Thread-2  ]: 7 of 7 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.29s]
[0m08:57:52.489278 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:57:52.490962 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:57:52.491341 [info ] [MainThread]: 
[0m08:57:52.491639 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m08:57:52.491930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:52.492076 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:57:52.492232 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m08:57:52.492378 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:57:52.492524 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:57:52.498621 [info ] [MainThread]: 
[0m08:57:52.498961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:57:52.499294 [info ] [MainThread]: 
[0m08:57:52.499576 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:57:52.499841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5c727ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5c085d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b5c085910>]}


============================== 2022-07-29 09:01:32.108225 | 252ab5a0-34ea-47cf-94bf-59a1fe21b6af ==============================
[0m09:01:32.108241 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:01:32.108620 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:01:32.108742 [debug] [MainThread]: Tracking: tracking
[0m09:01:32.108962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eaae310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eaae370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eaae3d0>]}
[0m09:01:32.124751 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:01:32.125043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eb3b430>]}
[0m09:01:32.133370 [debug] [MainThread]: Parsing macros/adapters.sql
[0m09:01:32.165314 [debug] [MainThread]: Parsing macros/catalog.sql
[0m09:01:32.166761 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m09:01:32.167496 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m09:01:32.170511 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m09:01:32.183842 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m09:01:32.186689 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m09:01:32.187762 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m09:01:32.191633 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m09:01:32.192098 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m09:01:32.192528 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m09:01:32.193025 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m09:01:32.193471 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m09:01:32.200867 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m09:01:32.212811 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m09:01:32.216252 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m09:01:32.218514 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m09:01:32.228510 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m09:01:32.230532 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m09:01:32.232192 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m09:01:32.237713 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m09:01:32.239691 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m09:01:32.240873 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m09:01:32.241950 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m09:01:32.248034 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m09:01:32.252076 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m09:01:32.252659 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m09:01:32.253273 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m09:01:32.253921 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m09:01:32.254936 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m09:01:32.256650 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m09:01:32.259590 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m09:01:32.260942 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m09:01:32.262238 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m09:01:32.265493 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m09:01:32.278832 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m09:01:32.283926 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m09:01:32.285212 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m09:01:32.293737 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m09:01:32.305528 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m09:01:32.315196 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m09:01:32.325606 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m09:01:32.337618 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m09:01:32.344440 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m09:01:32.345550 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m09:01:32.348763 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m09:01:32.351188 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m09:01:32.352124 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m09:01:32.355986 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m09:01:32.357682 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m09:01:32.359820 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m09:01:32.363947 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m09:01:32.365732 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m09:01:32.367279 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m09:01:32.367979 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m09:01:32.368961 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m09:01:32.369777 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m09:01:32.370487 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m09:01:32.371231 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m09:01:32.372174 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m09:01:32.373001 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m09:01:32.374523 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m09:01:32.375261 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m09:01:32.376000 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m09:01:32.376831 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m09:01:32.377618 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m09:01:32.378485 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m09:01:32.379447 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m09:01:32.380240 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m09:01:32.384780 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m09:01:32.385425 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m09:01:32.386050 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m09:01:32.386876 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m09:01:32.572296 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m09:01:32.580431 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m09:01:32.582108 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m09:01:32.583716 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m09:01:32.588733 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m09:01:32.589529 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m09:01:32.591419 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m09:01:32.593375 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m09:01:32.647272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eb31520>]}
[0m09:01:32.652119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eb31c10>]}
[0m09:01:32.652554 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:01:32.652789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eaa9e80>]}
[0m09:01:32.654183 [info ] [MainThread]: 
[0m09:01:32.654717 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m09:01:32.655612 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m09:01:32.664113 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m09:01:32.664341 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m09:01:32.664514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:33.465110 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.8 seconds
[0m09:01:33.466488 [debug] [ThreadPool]: On list_airbnb: Close
[0m09:01:33.629392 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m09:01:33.634073 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m09:01:33.634197 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m09:01:33.634299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:01:34.163584 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.53 seconds
[0m09:01:34.164728 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m09:01:34.271710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eb3f400>]}
[0m09:01:34.272088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:01:34.272300 [info ] [MainThread]: 
[0m09:01:34.276121 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m09:01:34.276536 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m09:01:34.275416 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m09:01:34.277146 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m09:01:34.277498 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m09:01:34.277792 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m09:01:34.277997 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m09:01:34.278154 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m09:01:34.278350 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m09:01:34.278559 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m09:01:34.278744 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m09:01:34.278930 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m09:01:34.280103 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m09:01:34.281027 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m09:01:34.281923 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m09:01:34.282684 [debug] [Thread-2  ]: finished collecting timing info
[0m09:01:34.282940 [debug] [Thread-1  ]: finished collecting timing info
[0m09:01:34.283301 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m09:01:34.283719 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m09:01:34.283853 [debug] [Thread-3  ]: finished collecting timing info
[0m09:01:34.284870 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m09:01:34.285136 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m09:01:34.285433 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m09:01:34.285658 [info ] [Thread-3  ]: 1 of 4 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m09:01:34.286054 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m09:01:34.286265 [info ] [Thread-4  ]: 2 of 4 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m09:01:34.286711 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m09:01:34.286961 [info ] [Thread-1  ]: 3 of 4 START incremental model dev.fct_reviews ................................. [RUN]
[0m09:01:34.287335 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m09:01:34.287475 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m09:01:34.287849 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:34.287997 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m09:01:34.288214 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m09:01:34.288392 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m09:01:34.288574 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m09:01:34.297155 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m09:01:34.297340 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m09:01:34.300984 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:01:34.307573 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m09:01:34.308297 [debug] [Thread-3  ]: finished collecting timing info
[0m09:01:34.308813 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m09:01:34.314874 [debug] [Thread-1  ]: finished collecting timing info
[0m09:01:34.315126 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m09:01:34.320502 [debug] [Thread-4  ]: finished collecting timing info
[0m09:01:34.336484 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m09:01:34.338821 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m09:01:34.348650 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:01:34.349397 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:34.349879 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m09:01:34.350313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:01:34.350953 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m09:01:34.352899 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m09:01:34.353038 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:01:34.355185 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m09:01:34.355417 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m09:01:34.355551 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:01:36.053436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.7 seconds
[0m09:01:36.061235 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.061410 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m09:01:36.148020 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.79 seconds
[0m09:01:36.165076 [debug] [Thread-3  ]: finished collecting timing info
[0m09:01:36.165255 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m09:01:36.171462 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.11 seconds
[0m09:01:36.173745 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.173861 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m09:01:36.231335 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m09:01:36.240992 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.241210 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m09:01:36.272204 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ebb5370>]}
[0m09:01:36.272548 [info ] [Thread-3  ]: 1 of 4 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.99s]
[0m09:01:36.272863 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m09:01:36.282044 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.93 seconds
[0m09:01:36.284020 [debug] [Thread-4  ]: finished collecting timing info
[0m09:01:36.284327 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m09:01:36.318479 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m09:01:36.320763 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.320920 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m09:01:36.377342 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ea7bf70>]}
[0m09:01:36.377640 [info ] [Thread-4  ]: 2 of 4 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 2.09s]
[0m09:01:36.377944 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m09:01:36.378716 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m09:01:36.385416 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:01:36.385676 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m09:01:36.395285 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m09:01:36.395727 [info ] [Thread-2  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m09:01:36.396294 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m09:01:36.396425 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m09:01:36.396554 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m09:01:36.398507 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:01:36.398957 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.399080 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m09:01:36.400603 [debug] [Thread-2  ]: finished collecting timing info
[0m09:01:36.400725 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m09:01:36.402493 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:01:36.403233 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m09:01:36.403352 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m09:01:36.403452 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:01:36.479704 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m09:01:36.479914 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.480034 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m09:01:36.645347 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.17 seconds
[0m09:01:36.645569 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:01:36.645674 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m09:01:36.780597 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m09:01:36.782547 [debug] [Thread-1  ]: finished collecting timing info
[0m09:01:36.782728 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m09:01:36.885143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ea7b280>]}
[0m09:01:36.885468 [info ] [Thread-1  ]: 3 of 4 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 2.60s]
[0m09:01:36.885789 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m09:01:37.686360 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m09:01:37.688095 [debug] [Thread-2  ]: finished collecting timing info
[0m09:01:37.688244 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m09:01:37.797427 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252ab5a0-34ea-47cf-94bf-59a1fe21b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771c547220>]}
[0m09:01:37.798474 [info ] [Thread-2  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.40s]
[0m09:01:37.798983 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m09:01:37.800107 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m09:01:37.800351 [info ] [MainThread]: 
[0m09:01:37.800556 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m09:01:37.800737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:37.800852 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m09:01:37.800950 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m09:01:37.801041 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m09:01:37.801115 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m09:01:37.806535 [info ] [MainThread]: 
[0m09:01:37.806765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:01:37.806972 [info ] [MainThread]: 
[0m09:01:37.807144 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:01:37.807385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eb2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ea73520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771ea73700>]}


============================== 2022-07-29 09:05:03.116114 | 1e2fc915-cdac-416a-bc1b-1eac1e115883 ==============================
[0m09:05:03.116131 [info ] [MainThread]: Running with dbt=1.2.0
[0m09:05:03.116495 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:05:03.116611 [debug] [MainThread]: Tracking: tracking
[0m09:05:03.116821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be775e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be775e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be775e400>]}
[0m09:05:03.137557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:05:03.137736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:05:03.141775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be7651a60>]}
[0m09:05:03.145959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be76d6a60>]}
[0m09:05:03.146172 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:05:03.146376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be76d6a90>]}
[0m09:05:03.147344 [info ] [MainThread]: 
[0m09:05:03.147688 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m09:05:03.148426 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m09:05:03.157820 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m09:05:03.158016 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m09:05:03.158131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:03.756643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.6 seconds
[0m09:05:03.757945 [debug] [ThreadPool]: On list_airbnb: Close
[0m09:05:03.842178 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m09:05:03.847711 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m09:05:03.847875 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m09:05:03.847996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:04.175128 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.33 seconds
[0m09:05:04.176172 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m09:05:04.263385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be685b4f0>]}
[0m09:05:04.263774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:05:04.264065 [info ] [MainThread]: 
[0m09:05:04.267265 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m09:05:04.267794 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m09:05:04.267935 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m09:05:04.268077 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m09:05:04.269155 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m09:05:04.269380 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m09:05:04.269663 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m09:05:04.269802 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m09:05:04.270055 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m09:05:04.270984 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m09:05:04.271163 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m09:05:04.271400 [debug] [Thread-1  ]: finished collecting timing info
[0m09:05:04.271730 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m09:05:04.271947 [debug] [Thread-2  ]: finished collecting timing info
[0m09:05:04.272324 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m09:05:04.272504 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m09:05:04.272845 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m09:05:04.273354 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m09:05:04.273513 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m09:05:04.274788 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m09:05:04.275115 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m09:05:04.275400 [info ] [Thread-4  ]: 1 of 4 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m09:05:04.275901 [info ] [Thread-2  ]: 2 of 4 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m09:05:04.276442 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:04.276901 [debug] [Thread-3  ]: finished collecting timing info
[0m09:05:04.277365 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m09:05:04.277609 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m09:05:04.278185 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m09:05:04.278450 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m09:05:04.278704 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m09:05:04.279084 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m09:05:04.285105 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m09:05:04.290066 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:04.295392 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m09:05:04.295893 [info ] [Thread-1  ]: 3 of 4 START incremental model dev.fct_reviews ................................. [RUN]
[0m09:05:04.296298 [debug] [Thread-4  ]: finished collecting timing info
[0m09:05:04.296848 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:04.297079 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m09:05:04.297346 [debug] [Thread-2  ]: finished collecting timing info
[0m09:05:04.297504 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m09:05:04.308173 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m09:05:04.322114 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:04.322342 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m09:05:04.324367 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m09:05:04.333219 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m09:05:04.334085 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:04.334825 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m09:05:04.335141 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
      );
[0m09:05:04.335302 [debug] [Thread-1  ]: finished collecting timing info
[0m09:05:04.335512 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
      );
[0m09:05:04.335710 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:05:04.335927 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m09:05:04.336075 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:05:04.359726 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:04.359935 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m09:05:04.360078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:05:05.443344 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.08 seconds
[0m09:05:05.458769 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.458939 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m09:05:05.469831 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.13 seconds
[0m09:05:05.486058 [debug] [Thread-4  ]: finished collecting timing info
[0m09:05:05.486235 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m09:05:05.529160 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m09:05:05.531530 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.531644 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m09:05:05.580206 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be67dbf70>]}
[0m09:05:05.581738 [info ] [Thread-4  ]: 1 of 4 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 1.30s]
[0m09:05:05.583741 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m09:05:05.588654 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m09:05:05.619666 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.619990 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m09:05:05.673631 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m09:05:05.675946 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.676067 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m09:05:05.746851 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m09:05:05.753613 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:05:05.762906 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m09:05:05.763778 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.43 seconds
[0m09:05:05.765270 [debug] [Thread-2  ]: finished collecting timing info
[0m09:05:05.765418 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m09:05:05.767134 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.767244 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m09:05:05.846830 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m09:05:05.847090 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.847241 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m09:05:05.857869 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be67ed940>]}
[0m09:05:05.858272 [info ] [Thread-2  ]: 2 of 4 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 1.58s]
[0m09:05:05.858714 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m09:05:05.859361 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m09:05:05.859627 [info ] [Thread-3  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m09:05:05.860112 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:05.860301 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m09:05:05.860484 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m09:05:05.863098 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:05.863483 [debug] [Thread-3  ]: finished collecting timing info
[0m09:05:05.863648 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m09:05:05.865625 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:05.866234 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:05.866344 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m09:05:05.866450 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:05:06.018757 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.17 seconds
[0m09:05:06.026713 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:06.026868 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m09:05:06.154129 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m09:05:06.155578 [debug] [Thread-1  ]: finished collecting timing info
[0m09:05:06.155710 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m09:05:06.259297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be77bf310>]}
[0m09:05:06.259609 [info ] [Thread-1  ]: 3 of 4 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 1.96s]
[0m09:05:06.259920 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m09:05:07.066148 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.2 seconds
[0m09:05:07.068336 [debug] [Thread-3  ]: finished collecting timing info
[0m09:05:07.068530 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m09:05:07.160740 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2fc915-cdac-416a-bc1b-1eac1e115883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be42033a0>]}
[0m09:05:07.161097 [info ] [Thread-3  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.30s]
[0m09:05:07.161413 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m09:05:07.162665 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m09:05:07.162918 [info ] [MainThread]: 
[0m09:05:07.163108 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m09:05:07.163289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:07.163387 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m09:05:07.163485 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m09:05:07.163577 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m09:05:07.163669 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m09:05:07.167718 [info ] [MainThread]: 
[0m09:05:07.167950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:07.168158 [info ] [MainThread]: 
[0m09:05:07.168331 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:05:07.168573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be678e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be678e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be678ed00>]}


============================== 2022-07-29 10:39:35.391410 | d0dc1720-9d7e-4fdc-ba02-a57c1c095d5d ==============================
[0m10:39:35.391430 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:39:35.391732 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:39:35.391845 [debug] [MainThread]: Tracking: tracking
[0m10:39:35.392037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e261152b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e26115310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e26115370>]}
[0m10:39:35.414622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:39:35.414934 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m10:39:35.424470 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m10:39:35.437815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0dc1720-9d7e-4fdc-ba02-a57c1c095d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e241abf70>]}
[0m10:39:35.441714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0dc1720-9d7e-4fdc-ba02-a57c1c095d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2605dc10>]}
[0m10:39:35.441935 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:39:35.442098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0dc1720-9d7e-4fdc-ba02-a57c1c095d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2604ce80>]}
[0m10:39:35.442577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2619aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2619ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2619a850>]}


============================== 2022-07-29 10:39:42.781010 | b4fd6606-3ce6-4f91-8f15-f700447a8120 ==============================
[0m10:39:42.781026 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:39:42.781318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:39:42.781430 [debug] [MainThread]: Tracking: tracking
[0m10:39:42.781613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d1602e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d160340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d1603a0>]}
[0m10:39:42.800745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:39:42.801062 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m10:39:42.811966 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m10:39:42.825175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4fd6606-3ce6-4f91-8f15-f700447a8120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0efeb190>]}
[0m10:39:42.829105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4fd6606-3ce6-4f91-8f15-f700447a8120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0efeafd0>]}
[0m10:39:42.829306 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:39:42.829459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4fd6606-3ce6-4f91-8f15-f700447a8120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d0a3eb0>]}
[0m10:39:42.829923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d1e31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d1e3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d1e31c0>]}


============================== 2022-07-29 10:41:24.794989 | 2cd49ff8-870a-4be1-b533-f9766496ce36 ==============================
[0m10:41:24.795013 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:41:24.795530 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:41:24.795745 [debug] [MainThread]: Tracking: tracking
[0m10:41:24.796067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdcda2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdcda22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdcda2310>]}
[0m10:41:24.818856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:24.819165 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m10:41:24.828797 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m10:41:24.842160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd49ff8-870a-4be1-b533-f9766496ce36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdc06dd60>]}
[0m10:41:24.846080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd49ff8-870a-4be1-b533-f9766496ce36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdccf5fa0>]}
[0m10:41:24.846291 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:41:24.846442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd49ff8-870a-4be1-b533-f9766496ce36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdcce2d30>]}
[0m10:41:24.846905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdde54130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdde54820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fdde54100>]}


============================== 2022-07-29 10:43:29.914002 | 25dab7cc-3905-4bdf-b1bb-d3af04e4356b ==============================
[0m10:43:29.914019 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:43:29.914304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m10:43:29.914417 [debug] [MainThread]: Tracking: tracking
[0m10:43:29.914598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974f291280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974f2912e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974f291340>]}
[0m10:43:29.934458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:29.934752 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m10:43:29.944156 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m10:43:29.957584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25dab7cc-3905-4bdf-b1bb-d3af04e4356b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974c123f70>]}
[0m10:43:29.961488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25dab7cc-3905-4bdf-b1bb-d3af04e4356b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974e1b4fd0>]}
[0m10:43:29.961738 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:43:29.961891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dab7cc-3905-4bdf-b1bb-d3af04e4356b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974e1a2d60>]}
[0m10:43:29.962392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974f328160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974f3287f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974f3284c0>]}


============================== 2022-07-29 10:45:05.397880 | cec7f4a9-14ab-4f42-8221-2b11237d912d ==============================
[0m10:45:05.397896 [info ] [MainThread]: Running with dbt=1.2.0
[0m10:45:05.398240 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:45:05.398369 [debug] [MainThread]: Tracking: tracking
[0m10:45:05.398560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f869f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f869f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f869f460>]}
[0m10:45:05.420646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:45:05.420842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:45:05.424923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f754fac0>]}
[0m10:45:05.428862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f75d9ac0>]}
[0m10:45:05.429082 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:45:05.429298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f75d9af0>]}
[0m10:45:05.430335 [info ] [MainThread]: 
[0m10:45:05.430725 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:45:05.431551 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m10:45:05.440486 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m10:45:05.440627 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m10:45:05.440733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:06.050317 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.61 seconds
[0m10:45:06.051646 [debug] [ThreadPool]: On list_airbnb: Close
[0m10:45:06.146349 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m10:45:06.152766 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m10:45:06.152912 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m10:45:06.152997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:45:06.672688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.52 seconds
[0m10:45:06.673728 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m10:45:06.763635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f754f8b0>]}
[0m10:45:06.764197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:45:06.764516 [info ] [MainThread]: 
[0m10:45:06.769032 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m10:45:06.769303 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m10:45:06.770252 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m10:45:06.770613 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m10:45:06.771088 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m10:45:06.771495 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m10:45:06.771773 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m10:45:06.772046 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m10:45:06.772309 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m10:45:06.772601 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m10:45:06.772853 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m10:45:06.773113 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m10:45:06.774720 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m10:45:06.776000 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m10:45:06.777237 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m10:45:06.778233 [debug] [Thread-1  ]: finished collecting timing info
[0m10:45:06.778451 [debug] [Thread-3  ]: finished collecting timing info
[0m10:45:06.779086 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m10:45:06.779320 [debug] [Thread-2  ]: finished collecting timing info
[0m10:45:06.779989 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m10:45:06.781069 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m10:45:06.781302 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m10:45:06.782740 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m10:45:06.783084 [info ] [Thread-4  ]: 1 of 4 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m10:45:06.783467 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m10:45:06.783836 [info ] [Thread-1  ]: 2 of 4 START incremental model dev.fct_reviews ................................. [RUN]
[0m10:45:06.784504 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m10:45:06.784852 [info ] [Thread-3  ]: 3 of 4 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m10:45:06.785403 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:06.785629 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m10:45:06.786129 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:45:06.786370 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m10:45:06.786610 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m10:45:06.786846 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m10:45:06.787092 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m10:45:06.796383 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m10:45:06.796623 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m10:45:06.805075 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m10:45:06.810917 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:45:06.811524 [debug] [Thread-4  ]: finished collecting timing info
[0m10:45:06.811682 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m10:45:06.817209 [debug] [Thread-1  ]: finished collecting timing info
[0m10:45:06.822832 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m10:45:06.827893 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m10:45:06.833386 [debug] [Thread-3  ]: finished collecting timing info
[0m10:45:06.854698 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m10:45:06.860192 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m10:45:06.861987 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:06.862184 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m10:45:06.863916 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m10:45:06.864154 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m10:45:06.864439 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:45:06.865938 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:45:06.866153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:45:06.867990 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m10:45:06.869699 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:45:07.605299 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.74 seconds
[0m10:45:07.611572 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m10:45:07.612385 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m10:45:07.612495 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m10:45:07.644741 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m10:45:07.645844 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m10:45:07.646480 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m10:45:07.646587 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m10:45:07.787805 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m10:45:07.799093 [debug] [Thread-3  ]: finished collecting timing info
[0m10:45:07.799245 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m10:45:07.804768 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
[0m10:45:07.806016 [debug] [Thread-4  ]: finished collecting timing info
[0m10:45:07.806203 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m10:45:07.892145 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f669ff10>]}
[0m10:45:07.893613 [info ] [Thread-4  ]: 1 of 4 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.11s]
[0m10:45:07.895317 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m10:45:07.897811 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f669dcd0>]}
[0m10:45:07.900217 [info ] [Thread-3  ]: 3 of 4 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.11s]
[0m10:45:07.901457 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m10:45:07.903091 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m10:45:07.904088 [info ] [Thread-2  ]: 4 of 4 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m10:45:07.905428 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m10:45:07.905785 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m10:45:07.906170 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m10:45:07.908248 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m10:45:07.908482 [debug] [Thread-2  ]: finished collecting timing info
[0m10:45:07.908598 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m10:45:07.915386 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m10:45:07.916053 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m10:45:07.916166 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m10:45:07.916273 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:45:08.386758 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.52 seconds
[0m10:45:08.392922 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:08.393052 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m10:45:08.463576 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m10:45:08.466411 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:08.466580 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m10:45:08.530105 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m10:45:08.540148 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:08.540301 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m10:45:08.603723 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m10:45:08.605939 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:08.606062 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m10:45:08.661852 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m10:45:08.668411 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:45:08.677055 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m10:45:08.677514 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:08.677623 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m10:45:08.756601 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m10:45:08.756797 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:08.756908 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m10:45:09.031035 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.27 seconds
[0m10:45:09.031339 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m10:45:09.031513 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m10:45:09.155082 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m10:45:09.159852 [debug] [Thread-1  ]: finished collecting timing info
[0m10:45:09.160008 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m10:45:09.560311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f669f250>]}
[0m10:45:09.560620 [info ] [Thread-1  ]: 2 of 4 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 2.77s]
[0m10:45:09.560970 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m10:45:11.020768 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.1 seconds
[0m10:45:11.025502 [debug] [Thread-2  ]: finished collecting timing info
[0m10:45:11.025643 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m10:45:11.449071 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec7f4a9-14ab-4f42-8221-2b11237d912d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74faec8550>]}
[0m10:45:11.449394 [info ] [Thread-2  ]: 4 of 4 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.54s]
[0m10:45:11.449722 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m10:45:11.450900 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m10:45:11.451176 [info ] [MainThread]: 
[0m10:45:11.451394 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m10:45:11.451603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:11.451711 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m10:45:11.451821 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m10:45:11.451930 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m10:45:11.452038 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m10:45:11.456797 [info ] [MainThread]: 
[0m10:45:11.457047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:11.457272 [info ] [MainThread]: 
[0m10:45:11.457451 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:45:11.457707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f669d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f669dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f86c9b20>]}


============================== 2022-07-29 11:02:40.546176 | 2e2e3f4c-b647-4d41-9f4b-66ea3b6e9283 ==============================
[0m11:02:40.546194 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:02:40.546532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:02:40.546650 [debug] [MainThread]: Tracking: tracking
[0m11:02:40.546842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a16663a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a1666400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a1666460>]}
[0m11:02:40.567236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:02:40.567503 [debug] [MainThread]: Partial parsing: added file: dbtlearn://seeds/003 seed-full-moon-dates.csv
[0m11:02:40.590153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e2e3f4c-b647-4d41-9f4b-66ea3b6e9283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0533160>]}
[0m11:02:40.594861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e2e3f4c-b647-4d41-9f4b-66ea3b6e9283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a05b3880>]}
[0m11:02:40.595139 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:02:40.595351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2e3f4c-b647-4d41-9f4b-66ea3b6e9283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a0532f40>]}
[0m11:02:40.596315 [info ] [MainThread]: 
[0m11:02:40.596726 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:02:40.597875 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:02:40.609650 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:02:40.609822 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:02:40.609927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:41.484112 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.87 seconds
[0m11:02:41.485495 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:02:41.606521 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:02:41.611448 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:02:41.611571 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:02:41.611675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:42.001974 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.39 seconds
[0m11:02:42.003155 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:02:42.113414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2e3f4c-b647-4d41-9f4b-66ea3b6e9283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a16f72b0>]}
[0m11:02:42.113801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:42.114013 [info ] [MainThread]: 
[0m11:02:42.116886 [debug] [Thread-1  ]: Began running node seed.dbtlearn.003 seed-full-moon-dates
[0m11:02:42.117109 [info ] [Thread-1  ]: 1 of 1 START seed file dev.003 seed-full-moon-dates ............................ [RUN]
[0m11:02:42.118204 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.dbtlearn.003 seed-full-moon-dates"
[0m11:02:42.118434 [debug] [Thread-1  ]: Began compiling node seed.dbtlearn.003 seed-full-moon-dates
[0m11:02:42.118651 [debug] [Thread-1  ]: finished collecting timing info
[0m11:02:42.118826 [debug] [Thread-1  ]: Began executing node seed.dbtlearn.003 seed-full-moon-dates
[0m11:02:42.148709 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.003 seed-full-moon-dates"
[0m11:02:42.148848 [debug] [Thread-1  ]: On seed.dbtlearn.003 seed-full-moon-dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.003 seed-full-moon-dates"} */
create table airbnb.dev.003 seed-full-moon-dates (full_moon_date date)
[0m11:02:42.148950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:02:42.877064 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5edd6-3201-070e-0000-d0150001b30e
[0m11:02:42.877244 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 23 unexpected '.003'.
[0m11:02:42.877478 [debug] [Thread-1  ]: finished collecting timing info
[0m11:02:42.877620 [debug] [Thread-1  ]: On seed.dbtlearn.003 seed-full-moon-dates: Close
[0m11:02:43.025664 [debug] [Thread-1  ]: Database Error in seed 003 seed-full-moon-dates (seeds/003 seed-full-moon-dates.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 23 unexpected '.003'.
[0m11:02:43.025931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2e3f4c-b647-4d41-9f4b-66ea3b6e9283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249b570ac0>]}
[0m11:02:43.026143 [error] [Thread-1  ]: 1 of 1 ERROR loading seed file dev.003 seed-full-moon-dates .................... [[31mERROR[0m in 0.91s]
[0m11:02:43.026456 [debug] [Thread-1  ]: Finished running node seed.dbtlearn.003 seed-full-moon-dates
[0m11:02:43.027544 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:02:43.027770 [info ] [MainThread]: 
[0m11:02:43.027964 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m11:02:43.028150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:43.028245 [debug] [MainThread]: Connection 'seed.dbtlearn.003 seed-full-moon-dates' was properly closed.
[0m11:02:43.032332 [info ] [MainThread]: 
[0m11:02:43.032562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:02:43.032791 [info ] [MainThread]: 
[0m11:02:43.032979 [error] [MainThread]: [33mDatabase Error in seed 003 seed-full-moon-dates (seeds/003 seed-full-moon-dates.csv)[0m
[0m11:02:43.033166 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:02:43.033339 [error] [MainThread]:   syntax error line 1 at position 23 unexpected '.003'.
[0m11:02:43.033521 [info ] [MainThread]: 
[0m11:02:43.033703 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:43.033966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a1694d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249b553d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24a16f7280>]}


============================== 2022-07-29 11:04:09.709116 | 504368c5-6eb5-43c8-bef0-e7afd772e7e8 ==============================
[0m11:04:09.709132 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:04:09.709468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:04:09.709582 [debug] [MainThread]: Tracking: tracking
[0m11:04:09.709769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf708f22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf708f2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf708f2370>]}
[0m11:04:09.730927 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:04:09.731212 [debug] [MainThread]: Partial parsing: added file: dbtlearn://seeds/seed-full-moon-dates.csv
[0m11:04:09.731324 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://seeds/003 seed-full-moon-dates.csv
[0m11:04:09.754539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '504368c5-6eb5-43c8-bef0-e7afd772e7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6f774790>]}
[0m11:04:09.758578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '504368c5-6eb5-43c8-bef0-e7afd772e7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf70818e80>]}
[0m11:04:09.758802 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:04:09.759001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504368c5-6eb5-43c8-bef0-e7afd772e7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6f7f8af0>]}
[0m11:04:09.759881 [info ] [MainThread]: 
[0m11:04:09.760214 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:04:09.760954 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:04:09.769851 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:04:09.770031 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:04:09.770143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:11.029084 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.26 seconds
[0m11:04:11.030376 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:04:11.283882 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:04:11.288503 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:04:11.288628 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:04:11.288728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:12.041045 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
[0m11:04:12.042095 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:04:12.155217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504368c5-6eb5-43c8-bef0-e7afd772e7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6f781ac0>]}
[0m11:04:12.155625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:12.155842 [info ] [MainThread]: 
[0m11:04:12.159045 [debug] [Thread-1  ]: Began running node seed.dbtlearn.seed-full-moon-dates
[0m11:04:12.159266 [info ] [Thread-1  ]: 1 of 1 START seed file dev.seed-full-moon-dates ................................ [RUN]
[0m11:04:12.160397 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.dbtlearn.seed-full-moon-dates"
[0m11:04:12.160545 [debug] [Thread-1  ]: Began compiling node seed.dbtlearn.seed-full-moon-dates
[0m11:04:12.160692 [debug] [Thread-1  ]: finished collecting timing info
[0m11:04:12.160863 [debug] [Thread-1  ]: Began executing node seed.dbtlearn.seed-full-moon-dates
[0m11:04:12.191974 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed-full-moon-dates"
[0m11:04:12.192108 [debug] [Thread-1  ]: On seed.dbtlearn.seed-full-moon-dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed-full-moon-dates"} */
create table airbnb.dev.seed-full-moon-dates (full_moon_date date)
[0m11:04:12.192210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:04:12.542654 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5edd8-3201-070e-0000-d0150001b31a
[0m11:04:12.543050 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 28 unexpected '-'.
[0m11:04:12.543657 [debug] [Thread-1  ]: finished collecting timing info
[0m11:04:12.544043 [debug] [Thread-1  ]: On seed.dbtlearn.seed-full-moon-dates: Close
[0m11:04:12.650392 [debug] [Thread-1  ]: Database Error in seed seed-full-moon-dates (seeds/seed-full-moon-dates.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 28 unexpected '-'.
[0m11:04:12.650689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504368c5-6eb5-43c8-bef0-e7afd772e7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6e934640>]}
[0m11:04:12.650923 [error] [Thread-1  ]: 1 of 1 ERROR loading seed file dev.seed-full-moon-dates ........................ [[31mERROR[0m in 0.49s]
[0m11:04:12.651237 [debug] [Thread-1  ]: Finished running node seed.dbtlearn.seed-full-moon-dates
[0m11:04:12.652330 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:04:12.652570 [info ] [MainThread]: 
[0m11:04:12.652764 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m11:04:12.652985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:12.653089 [debug] [MainThread]: Connection 'seed.dbtlearn.seed-full-moon-dates' was properly closed.
[0m11:04:12.657534 [info ] [MainThread]: 
[0m11:04:12.657778 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:04:12.658010 [info ] [MainThread]: 
[0m11:04:12.658311 [error] [MainThread]: [33mDatabase Error in seed seed-full-moon-dates (seeds/seed-full-moon-dates.csv)[0m
[0m11:04:12.658608 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:04:12.658799 [error] [MainThread]:   syntax error line 1 at position 28 unexpected '-'.
[0m11:04:12.659002 [info ] [MainThread]: 
[0m11:04:12.659232 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:04:12.659514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6f7f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6f781b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6f71fe50>]}


============================== 2022-07-29 11:06:17.422072 | 77b9f7b3-3357-470c-9c27-8d331656b1a3 ==============================
[0m11:06:17.422087 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:06:17.422443 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:06:17.422561 [debug] [MainThread]: Tracking: tracking
[0m11:06:17.422753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd785960340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7859603a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd785960400>]}
[0m11:06:17.446045 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:06:17.446321 [debug] [MainThread]: Partial parsing: added file: dbtlearn://seeds/seed_full_moon_dates.csv
[0m11:06:17.446436 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://seeds/seed-full-moon-dates.csv
[0m11:06:17.468231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77b9f7b3-3357-470c-9c27-8d331656b1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd785834850>]}
[0m11:06:17.472201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77b9f7b3-3357-470c-9c27-8d331656b1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7858c9fd0>]}
[0m11:06:17.472424 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:06:17.472632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b9f7b3-3357-470c-9c27-8d331656b1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7858b9bb0>]}
[0m11:06:17.473667 [info ] [MainThread]: 
[0m11:06:17.474131 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:06:17.474771 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:06:17.483379 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:06:17.483530 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:06:17.483632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:18.143039 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.66 seconds
[0m11:06:18.144390 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:06:18.235698 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:06:18.240467 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:06:18.240599 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:06:18.240702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:18.836836 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.6 seconds
[0m11:06:18.838083 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:06:18.923984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b9f7b3-3357-470c-9c27-8d331656b1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd785841be0>]}
[0m11:06:18.924437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:06:18.924673 [info ] [MainThread]: 
[0m11:06:18.928154 [debug] [Thread-1  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m11:06:18.928415 [info ] [Thread-1  ]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m11:06:18.929761 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:06:18.929922 [debug] [Thread-1  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m11:06:18.930067 [debug] [Thread-1  ]: finished collecting timing info
[0m11:06:18.930195 [debug] [Thread-1  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m11:06:18.958836 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:06:18.958974 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
create table airbnb.dev.seed_full_moon_dates (full_moon_date date)
[0m11:06:18.959076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:06:19.371078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.41 seconds
[0m11:06:19.383024 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:06:19.383154 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m11:06:19.464603 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m11:06:19.471325 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:06:19.471783 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
insert into airbnb.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m11:06:20.410131 [debug] [Thread-1  ]: SQL status: SUCCESS 272 in 0.94 seconds
[0m11:06:20.410375 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:06:20.410485 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m11:06:20.631658 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m11:06:20.641381 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m11:06:20.666380 [debug] [Thread-1  ]: finished collecting timing info
[0m11:06:20.666556 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m11:06:20.772320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77b9f7b3-3357-470c-9c27-8d331656b1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7849da250>]}
[0m11:06:20.772602 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 1.84s]
[0m11:06:20.772986 [debug] [Thread-1  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m11:06:20.774426 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:06:20.774713 [info ] [MainThread]: 
[0m11:06:20.774934 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m11:06:20.775148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:20.775258 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m11:06:20.779718 [info ] [MainThread]: 
[0m11:06:20.779954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:20.780171 [info ] [MainThread]: 
[0m11:06:20.780352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:06:20.780609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7858b9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7848adf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7858c9910>]}


============================== 2022-07-29 11:34:58.303075 | 1c7addf9-95e2-4308-9f29-5dd49c8c5246 ==============================
[0m11:34:58.303092 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:34:58.303398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m11:34:58.303511 [debug] [MainThread]: Tracking: tracking
[0m11:34:58.303696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77793a62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77793a6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77793a6370>]}
[0m11:34:58.325052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:34:58.325307 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m11:34:58.335261 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m11:34:58.349087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c7addf9-95e2-4308-9f29-5dd49c8c5246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777806c760>]}
[0m11:34:58.353520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c7addf9-95e2-4308-9f29-5dd49c8c5246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777930bdc0>]}
[0m11:34:58.353763 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:34:58.353921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c7addf9-95e2-4308-9f29-5dd49c8c5246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777930beb0>]}
[0m11:34:58.354422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777930bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777930bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777930ba30>]}


============================== 2022-07-29 11:35:07.104504 | 3edb5bb1-6994-45ab-81a0-44d3cf635059 ==============================
[0m11:35:07.104520 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:35:07.104863 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:35:07.104974 [debug] [MainThread]: Tracking: tracking
[0m11:35:07.105170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edee92340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edee923a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edee92400>]}
[0m11:35:07.126355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:07.126527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:07.130909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd5d100>]}
[0m11:35:07.135951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd482e0>]}
[0m11:35:07.136229 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:35:07.136444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd5bee0>]}
[0m11:35:07.137581 [info ] [MainThread]: 
[0m11:35:07.137988 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:35:07.138855 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:35:07.148239 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:35:07.148428 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:35:07.148539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:07.946905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.8 seconds
[0m11:35:07.948132 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:35:08.033135 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:35:08.037874 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:35:08.038047 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:35:08.038177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:08.375774 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.34 seconds
[0m11:35:08.376849 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:35:08.464849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd5d190>]}
[0m11:35:08.465664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:35:08.466143 [info ] [MainThread]: 
[0m11:35:08.472315 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m11:35:08.472673 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m11:35:08.473724 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m11:35:08.474186 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m11:35:08.474854 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m11:35:08.475567 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m11:35:08.476020 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m11:35:08.476324 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m11:35:08.476599 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m11:35:08.476925 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m11:35:08.477217 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m11:35:08.477511 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m11:35:08.479408 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:35:08.480832 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:35:08.482139 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:35:08.483212 [debug] [Thread-1  ]: finished collecting timing info
[0m11:35:08.483919 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m11:35:08.484621 [debug] [Thread-2  ]: finished collecting timing info
[0m11:35:08.484847 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:35:08.485272 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m11:35:08.485523 [debug] [Thread-3  ]: finished collecting timing info
[0m11:35:08.485875 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m11:35:08.486690 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m11:35:08.486899 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:35:08.487459 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:35:08.488200 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m11:35:08.488545 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m11:35:08.488744 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:35:08.489288 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:35:08.489592 [info ] [Thread-3  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m11:35:08.489812 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m11:35:08.489996 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:35:08.490517 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:08.500347 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:35:08.500641 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m11:35:08.500912 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m11:35:08.510984 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:35:08.511373 [debug] [Thread-3  ]: Compiling model.dbtlearn.fct_reviews
[0m11:35:08.511515 [debug] [Thread-4  ]: finished collecting timing info
[0m11:35:08.526194 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m11:35:08.526421 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:35:08.526630 [debug] [Thread-1  ]: finished collecting timing info
[0m11:35:08.537609 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:35:08.551424 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:35:08.552671 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:35:08.553636 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:35:08.553877 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m11:35:08.554107 [debug] [Thread-3  ]: finished collecting timing info
[0m11:35:08.554858 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:35:08.555008 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:35:08.555228 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m11:35:08.555416 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m11:35:08.573129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:35:08.584071 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:08.584453 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m11:35:08.584622 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:35:09.306354 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m11:35:09.319473 [debug] [Thread-4  ]: finished collecting timing info
[0m11:35:09.319707 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:35:09.436224 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.86 seconds
[0m11:35:09.437695 [debug] [Thread-1  ]: finished collecting timing info
[0m11:35:09.438007 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:35:09.458524 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edc85d4f0>]}
[0m11:35:09.458862 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.97s]
[0m11:35:09.459195 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:35:09.755829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edcd4ea60>]}
[0m11:35:09.756141 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.27s]
[0m11:35:09.756449 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:35:09.756843 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m11:35:09.757030 [info ] [Thread-2  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m11:35:09.757391 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:35:09.757503 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m11:35:09.757612 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m11:35:09.759778 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:35:09.760041 [debug] [Thread-2  ]: finished collecting timing info
[0m11:35:09.760159 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m11:35:09.767259 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:35:09.768146 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:35:09.768300 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m11:35:09.768414 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:35:11.052351 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.47 seconds
[0m11:35:11.058922 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.059105 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:35:11.189375 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.13 seconds
[0m11:35:11.192045 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.192180 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m11:35:11.258223 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m11:35:11.268338 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.268511 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:35:11.322507 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m11:35:11.324768 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.324891 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m11:35:11.382097 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m11:35:11.388411 [debug] [Thread-3  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:35:11.397325 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m11:35:11.397855 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.397964 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m11:35:11.476250 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m11:35:11.476453 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.476562 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m11:35:11.663947 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.19 seconds
[0m11:35:11.664171 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:35:11.664277 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m11:35:11.796135 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m11:35:11.800746 [debug] [Thread-3  ]: finished collecting timing info
[0m11:35:11.800906 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: Close
[0m11:35:11.901161 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd66790>]}
[0m11:35:11.901951 [info ] [Thread-3  ]: 3 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 3.41s]
[0m11:35:11.902812 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m11:35:11.903978 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m11:35:11.904527 [info ] [Thread-1  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m11:35:11.905419 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:35:11.905755 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m11:35:11.906075 [debug] [Thread-1  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m11:35:11.912341 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:35:11.913178 [debug] [Thread-1  ]: finished collecting timing info
[0m11:35:11.913543 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m11:35:11.918134 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:35:11.920163 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:35:11.920652 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)

select
    r.*,
    CASE
        when fm.full_moon_dates is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_dates))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m11:35:11.921155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:35:12.213889 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.45 seconds
[0m11:35:12.215580 [debug] [Thread-2  ]: finished collecting timing info
[0m11:35:12.215724 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m11:35:12.285423 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5edf7-3201-070e-0000-d0150001b4e2
[0m11:35:12.285580 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 45
invalid identifier 'FM.FULL_MOON_DATES'
[0m11:35:12.285757 [debug] [Thread-1  ]: finished collecting timing info
[0m11:35:12.285872 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m11:35:12.309719 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecd78ccd0>]}
[0m11:35:12.310060 [info ] [Thread-2  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 2.55s]
[0m11:35:12.310377 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m11:35:12.375751 [debug] [Thread-1  ]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  000904 (42000): SQL compilation error: error line 22 at position 45
  invalid identifier 'FM.FULL_MOON_DATES'
  compiled SQL at target/run/dbtlearn/models/mart/mart_fullmoon_reviews.sql
[0m11:35:12.376003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edb5bb1-6994-45ab-81a0-44d3cf635059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecd765850>]}
[0m11:35:12.376249 [error] [Thread-1  ]: 5 of 5 ERROR creating table model dev.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.47s]
[0m11:35:12.376537 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m11:35:12.377785 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:35:12.378037 [info ] [MainThread]: 
[0m11:35:12.378230 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m11:35:12.378414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:12.378510 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m11:35:12.378606 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m11:35:12.378701 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m11:35:12.378798 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m11:35:12.383046 [info ] [MainThread]: 
[0m11:35:12.383271 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:35:12.383479 [info ] [MainThread]: 
[0m11:35:12.383661 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)[0m
[0m11:35:12.383839 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 22 at position 45
[0m11:35:12.384011 [error] [MainThread]:   invalid identifier 'FM.FULL_MOON_DATES'
[0m11:35:12.384184 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/mart/mart_fullmoon_reviews.sql
[0m11:35:12.384368 [info ] [MainThread]: 
[0m11:35:12.384558 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:35:12.384813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edeebc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd48460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eddd44ee0>]}


============================== 2022-07-29 11:36:29.969764 | 423ff77e-1120-4207-8cb9-b424155393cf ==============================
[0m11:36:29.969780 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:36:29.970069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m11:36:29.970179 [debug] [MainThread]: Tracking: tracking
[0m11:36:29.970364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa73332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7333340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa73333a0>]}
[0m11:36:29.991066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:29.991361 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m11:36:30.001171 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m11:36:30.014911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '423ff77e-1120-4207-8cb9-b424155393cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa41e6ac0>]}
[0m11:36:30.019130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '423ff77e-1120-4207-8cb9-b424155393cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7318eb0>]}
[0m11:36:30.019352 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:36:30.019506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '423ff77e-1120-4207-8cb9-b424155393cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7289e50>]}
[0m11:36:30.020024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7289f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7297a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa7297cd0>]}


============================== 2022-07-29 11:36:51.190495 | b670fbc9-17bc-4822-a748-98287cde6a3f ==============================
[0m11:36:51.190511 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:36:51.190867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:36:51.190982 [debug] [MainThread]: Tracking: tracking
[0m11:36:51.191169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08610b92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08610b9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08610b93a0>]}
[0m11:36:51.212420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:36:51.212652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:36:51.216862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b670fbc9-17bc-4822-a748-98287cde6a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ff5b0a0>]}
[0m11:36:51.221519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b670fbc9-17bc-4822-a748-98287cde6a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ff462b0>]}
[0m11:36:51.221755 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:36:51.221957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b670fbc9-17bc-4822-a748-98287cde6a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ff58e80>]}
[0m11:36:51.222874 [info ] [MainThread]: 
[0m11:36:51.223216 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:36:51.223826 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:36:51.232915 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:36:51.233089 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:36:51.233199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:51.821735 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.59 seconds
[0m11:36:51.822969 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:36:51.913383 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:36:51.919111 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:36:51.919252 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:36:51.919358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:52.466155 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.55 seconds
[0m11:36:52.467623 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:36:52.566227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b670fbc9-17bc-4822-a748-98287cde6a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ff43ee0>]}
[0m11:36:52.566953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:52.567383 [info ] [MainThread]: 
[0m11:36:52.572460 [debug] [Thread-1  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m11:36:52.572728 [info ] [Thread-1  ]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m11:36:52.573084 [debug] [Thread-1  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:52.573199 [debug] [Thread-1  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m11:36:52.573559 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:52.573679 [debug] [Thread-1  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m11:36:52.607944 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:52.608221 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m11:36:52.608406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:52.953451 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.35 seconds
[0m11:36:52.953948 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:52.954267 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
truncate table "AIRBNB"."DEV"."SEED_FULL_MOON_DATES"
  ;
[0m11:36:53.170079 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.22 seconds
[0m11:36:53.170412 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:53.170591 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m11:36:53.376597 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m11:36:53.391424 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:53.391566 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m11:36:53.485575 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.09 seconds
[0m11:36:53.487045 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:53.487164 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
insert into airbnb.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m11:36:53.974873 [debug] [Thread-1  ]: SQL status: SUCCESS 272 in 0.49 seconds
[0m11:36:53.975175 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:53.975326 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m11:36:54.178806 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.2 seconds
[0m11:36:54.185208 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m11:36:54.200268 [debug] [Thread-1  ]: finished collecting timing info
[0m11:36:54.200448 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m11:36:54.284611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b670fbc9-17bc-4822-a748-98287cde6a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085c38ecd0>]}
[0m11:36:54.284908 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 1.71s]
[0m11:36:54.285287 [debug] [Thread-1  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m11:36:54.286598 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:36:54.286872 [info ] [MainThread]: 
[0m11:36:54.287106 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m11:36:54.287332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:54.287448 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m11:36:54.291849 [info ] [MainThread]: 
[0m11:36:54.292072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:54.292285 [info ] [MainThread]: 
[0m11:36:54.292462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:36:54.292724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ff463d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ff3e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085ffdab80>]}


============================== 2022-07-29 11:37:14.208732 | 0d6ebfe4-bc2c-43bd-8db8-065654e8c910 ==============================
[0m11:37:14.208747 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:37:14.209094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:37:14.209208 [debug] [MainThread]: Tracking: tracking
[0m11:37:14.209409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6dcb8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6dcb83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6dcb8430>]}
[0m11:37:14.230839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:14.231003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:14.235158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cb9b130>]}
[0m11:37:14.239473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cb86340>]}
[0m11:37:14.239708 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:37:14.239912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cb99f10>]}
[0m11:37:14.240963 [info ] [MainThread]: 
[0m11:37:14.241312 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:37:14.242060 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:37:14.251312 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:37:14.251486 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:37:14.251591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:14.775999 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.52 seconds
[0m11:37:14.777207 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:37:14.868111 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:37:14.873262 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:37:14.873390 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:37:14.873491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:15.207856 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.33 seconds
[0m11:37:15.209004 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:37:15.299419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cb9b1c0>]}
[0m11:37:15.299854 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:37:15.300091 [info ] [MainThread]: 
[0m11:37:15.303307 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m11:37:15.303864 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m11:37:15.304027 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m11:37:15.304190 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m11:37:15.305386 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:37:15.305667 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m11:37:15.306031 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m11:37:15.306210 [debug] [Thread-1  ]: finished collecting timing info
[0m11:37:15.306381 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m11:37:15.306571 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m11:37:15.307029 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m11:37:15.307299 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m11:37:15.307627 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m11:37:15.309080 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:37:15.309273 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:37:15.309511 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m11:37:15.310004 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m11:37:15.310237 [debug] [Thread-2  ]: finished collecting timing info
[0m11:37:15.310469 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m11:37:15.311034 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:37:15.311503 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m11:37:15.313299 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:37:15.313626 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:37:15.314377 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:37:15.314836 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m11:37:15.315383 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m11:37:15.315552 [debug] [Thread-3  ]: finished collecting timing info
[0m11:37:15.325441 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:37:15.325937 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:37:15.326407 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m11:37:15.326679 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:37:15.327379 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m11:37:15.327679 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m11:37:15.335490 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:37:15.335839 [info ] [Thread-2  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m11:37:15.335993 [debug] [Thread-4  ]: finished collecting timing info
[0m11:37:15.336349 [debug] [Thread-1  ]: finished collecting timing info
[0m11:37:15.336751 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:15.336948 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:37:15.337133 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:37:15.337320 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m11:37:15.363307 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:37:15.363543 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m11:37:15.364751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:37:15.372850 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m11:37:15.373956 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:37:15.374097 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m11:37:15.374359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:15.374862 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:37:15.375717 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m11:37:15.376948 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:37:15.377802 [debug] [Thread-2  ]: finished collecting timing info
[0m11:37:15.378029 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m11:37:15.406140 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:15.406301 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m11:37:15.406406 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:37:15.921575 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m11:37:15.934519 [debug] [Thread-1  ]: finished collecting timing info
[0m11:37:15.934684 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:37:16.020127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a67c9c7f0>]}
[0m11:37:16.020470 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.69s]
[0m11:37:16.020832 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:37:16.100220 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.72 seconds
[0m11:37:16.101686 [debug] [Thread-4  ]: finished collecting timing info
[0m11:37:16.101820 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:37:16.188640 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6dce29a0>]}
[0m11:37:16.188968 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.88s]
[0m11:37:16.189308 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:37:16.189817 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m11:37:16.190022 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m11:37:16.190391 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:37:16.190538 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m11:37:16.190679 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m11:37:16.193049 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:37:16.193356 [debug] [Thread-3  ]: finished collecting timing info
[0m11:37:16.193470 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m11:37:16.200215 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:37:16.200910 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:37:16.201023 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m11:37:16.201137 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:37:16.506412 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.1 seconds
[0m11:37:16.526179 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:16.526637 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:37:16.594156 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m11:37:16.596437 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:16.596554 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m11:37:16.652351 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m11:37:16.662639 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:16.662813 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:37:16.739554 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m11:37:16.742158 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:16.742277 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m11:37:16.795354 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m11:37:16.802298 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:37:16.811676 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m11:37:16.812185 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:16.812303 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m11:37:16.894291 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m11:37:16.894494 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:16.894606 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m11:37:17.040274 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.15 seconds
[0m11:37:17.041088 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:37:17.041525 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m11:37:17.165702 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m11:37:17.170279 [debug] [Thread-2  ]: finished collecting timing info
[0m11:37:17.170422 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m11:37:17.271400 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6471e5e0>]}
[0m11:37:17.271810 [info ] [Thread-2  ]: 3 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 1.93s]
[0m11:37:17.272253 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m11:37:17.272936 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m11:37:17.273248 [info ] [Thread-4  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m11:37:17.273809 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:37:17.273992 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m11:37:17.274169 [debug] [Thread-4  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m11:37:17.277506 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:37:17.277893 [debug] [Thread-4  ]: finished collecting timing info
[0m11:37:17.278080 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m11:37:17.279866 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:37:17.280528 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:37:17.280640 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)
 
select
    r.*,
    CASE
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_dates))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m11:37:17.280748 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:37:17.435198 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.23 seconds
[0m11:37:17.437266 [debug] [Thread-3  ]: finished collecting timing info
[0m11:37:17.437418 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m11:37:17.528282 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a646df430>]}
[0m11:37:17.528607 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.34s]
[0m11:37:17.528939 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m11:37:17.628758 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a5edf9-3201-06f6-0000-d0150001951a
[0m11:37:17.628916 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 45
invalid identifier 'FM.FULL_MOON_DATES'
[0m11:37:17.629104 [debug] [Thread-4  ]: finished collecting timing info
[0m11:37:17.629221 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m11:37:17.728601 [debug] [Thread-4  ]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  000904 (42000): SQL compilation error: error line 22 at position 45
  invalid identifier 'FM.FULL_MOON_DATES'
  compiled SQL at target/run/dbtlearn/models/mart/mart_fullmoon_reviews.sql
[0m11:37:17.729449 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d6ebfe4-bc2c-43bd-8db8-065654e8c910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a646fbc40>]}
[0m11:37:17.730329 [error] [Thread-4  ]: 5 of 5 ERROR creating table model dev.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.46s]
[0m11:37:17.731557 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m11:37:17.736515 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:37:17.737629 [info ] [MainThread]: 
[0m11:37:17.738391 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m11:37:17.738938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:17.739272 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m11:37:17.739554 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m11:37:17.739836 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m11:37:17.740113 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m11:37:17.750587 [info ] [MainThread]: 
[0m11:37:17.751099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:37:17.751508 [info ] [MainThread]: 
[0m11:37:17.751866 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)[0m
[0m11:37:17.752220 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 22 at position 45
[0m11:37:17.752563 [error] [MainThread]:   invalid identifier 'FM.FULL_MOON_DATES'
[0m11:37:17.752905 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/mart/mart_fullmoon_reviews.sql
[0m11:37:17.753281 [info ] [MainThread]: 
[0m11:37:17.753648 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:37:17.754095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cb86460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cbfdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6cb83d90>]}


============================== 2022-07-29 11:38:55.870541 | 8020ad48-2b59-461a-a262-514bdeef95ce ==============================
[0m11:38:55.870556 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:38:55.870855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m11:38:55.870969 [debug] [MainThread]: Tracking: tracking
[0m11:38:55.871185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31da02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31da0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31da03a0>]}
[0m11:38:55.892299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:55.892454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:55.896353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8020ad48-2b59-461a-a262-514bdeef95ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31c9d0a0>]}
[0m11:38:55.900709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8020ad48-2b59-461a-a262-514bdeef95ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31c892b0>]}
[0m11:38:55.901003 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:38:55.901171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8020ad48-2b59-461a-a262-514bdeef95ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31c9be80>]}
[0m11:38:55.901707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31c9be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31c890d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b31c890a0>]}


============================== 2022-07-29 11:39:16.355099 | c4218b15-2ab8-4dfd-a2be-7ab6e5b23794 ==============================
[0m11:39:16.355116 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:39:16.355463 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:39:16.355578 [debug] [MainThread]: Tracking: tracking
[0m11:39:16.355770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86428f43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86428f4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86428f4490>]}
[0m11:39:16.382313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:16.382477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:16.386511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864179d190>]}
[0m11:39:16.390866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8641785370>]}
[0m11:39:16.391099 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:39:16.391303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864179af70>]}
[0m11:39:16.393341 [info ] [MainThread]: 
[0m11:39:16.393949 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:39:16.395116 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:39:16.408520 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:39:16.408700 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:39:16.408821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:17.006619 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.6 seconds
[0m11:39:17.007879 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:39:17.095418 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:39:17.102176 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:39:17.102321 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:39:17.102424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:17.630869 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.53 seconds
[0m11:39:17.631924 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:39:17.725115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8641784f10>]}
[0m11:39:17.725526 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:17.725751 [info ] [MainThread]: 
[0m11:39:17.729216 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m11:39:17.729766 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m11:39:17.729939 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m11:39:17.730115 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m11:39:17.730299 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m11:39:17.730652 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m11:39:17.730967 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m11:39:17.731291 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m11:39:17.731494 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m11:39:17.732871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:39:17.733099 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m11:39:17.733326 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m11:39:17.733641 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m11:39:17.734819 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:39:17.735042 [debug] [Thread-1  ]: finished collecting timing info
[0m11:39:17.736254 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:39:17.736890 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m11:39:17.737830 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:39:17.738318 [debug] [Thread-2  ]: finished collecting timing info
[0m11:39:17.738493 [debug] [Thread-3  ]: finished collecting timing info
[0m11:39:17.738833 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m11:39:17.739359 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m11:39:17.739824 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m11:39:17.740355 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:39:17.741493 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:39:17.741673 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:39:17.741840 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m11:39:17.742202 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m11:39:17.742431 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m11:39:17.742792 [info ] [Thread-2  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m11:39:17.743597 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:39:17.752572 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:39:17.753159 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:17.753353 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:39:17.753740 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m11:39:17.754059 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m11:39:17.754233 [debug] [Thread-4  ]: finished collecting timing info
[0m11:39:17.754462 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m11:39:17.760611 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:39:17.760944 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:39:17.775637 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m11:39:17.793226 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:39:17.793430 [debug] [Thread-1  ]: finished collecting timing info
[0m11:39:17.793714 [debug] [Thread-2  ]: finished collecting timing info
[0m11:39:17.794365 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:39:17.794534 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:39:17.794730 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m11:39:17.794915 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m11:39:17.796862 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:39:17.807581 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:39:17.822183 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:17.824137 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m11:39:17.824270 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:39:17.826426 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:39:17.826555 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m11:39:17.826675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:39:18.584804 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.78 seconds
[0m11:39:18.598122 [debug] [Thread-4  ]: finished collecting timing info
[0m11:39:18.598284 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:39:18.601025 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.77 seconds
[0m11:39:18.602251 [debug] [Thread-1  ]: finished collecting timing info
[0m11:39:18.602369 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:39:18.684462 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864083f370>]}
[0m11:39:18.684803 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.94s]
[0m11:39:18.685108 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:39:18.687098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86408d4e50>]}
[0m11:39:18.687352 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.94s]
[0m11:39:18.687681 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:39:18.688176 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m11:39:18.688376 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m11:39:18.688750 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:39:18.688873 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m11:39:18.688991 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m11:39:18.691318 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:39:18.691599 [debug] [Thread-3  ]: finished collecting timing info
[0m11:39:18.691725 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m11:39:18.698515 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:39:18.699232 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:39:18.699347 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m11:39:18.699449 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:39:18.781984 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.96 seconds
[0m11:39:18.798454 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:18.803724 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:39:18.889032 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m11:39:18.892106 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:18.892248 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m11:39:18.946530 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m11:39:18.958484 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:18.958675 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:39:19.016781 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m11:39:19.019257 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:19.019381 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m11:39:19.074319 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m11:39:19.080885 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:39:19.090049 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m11:39:19.090583 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:19.090704 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m11:39:19.166021 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m11:39:19.166242 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:19.166355 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m11:39:19.401843 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.24 seconds
[0m11:39:19.402138 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:39:19.402296 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m11:39:19.520576 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m11:39:19.525702 [debug] [Thread-2  ]: finished collecting timing info
[0m11:39:19.525846 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m11:39:19.633013 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640843ac0>]}
[0m11:39:19.633336 [info ] [Thread-2  ]: 3 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 1.88s]
[0m11:39:19.633658 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m11:39:19.634140 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m11:39:19.634336 [info ] [Thread-1  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m11:39:19.634679 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:39:19.634814 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m11:39:19.634944 [debug] [Thread-1  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m11:39:19.637108 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:39:19.637394 [debug] [Thread-1  ]: finished collecting timing info
[0m11:39:19.637509 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m11:39:19.639023 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:39:19.639634 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:39:19.639741 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)
 
select
    r.*,
    CASE
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_dates))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m11:39:19.639844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:39:19.707919 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.01 seconds
[0m11:39:19.726674 [debug] [Thread-3  ]: finished collecting timing info
[0m11:39:19.732061 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m11:39:19.830632 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864083f970>]}
[0m11:39:19.836131 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.14s]
[0m11:39:19.836468 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m11:39:20.008816 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5edfb-3201-070e-0000-d0150001b52a
[0m11:39:20.008980 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 45
invalid identifier 'FM.FULL_MOON_DATES'
[0m11:39:20.009170 [debug] [Thread-1  ]: finished collecting timing info
[0m11:39:20.009289 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m11:39:20.096908 [debug] [Thread-1  ]: Database Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  000904 (42000): SQL compilation error: error line 22 at position 45
  invalid identifier 'FM.FULL_MOON_DATES'
  compiled SQL at target/run/dbtlearn/models/mart/mart_fullmoon_reviews.sql
[0m11:39:20.097221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4218b15-2ab8-4dfd-a2be-7ab6e5b23794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640331610>]}
[0m11:39:20.097543 [error] [Thread-1  ]: 5 of 5 ERROR creating table model dev.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.46s]
[0m11:39:20.097921 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m11:39:20.099506 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:39:20.099857 [info ] [MainThread]: 
[0m11:39:20.100116 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m11:39:20.100365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:20.100499 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m11:39:20.100627 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m11:39:20.100754 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m11:39:20.100969 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m11:39:20.107783 [info ] [MainThread]: 
[0m11:39:20.108036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:39:20.108244 [info ] [MainThread]: 
[0m11:39:20.108429 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)[0m
[0m11:39:20.108606 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 22 at position 45
[0m11:39:20.108805 [error] [MainThread]:   invalid identifier 'FM.FULL_MOON_DATES'
[0m11:39:20.109076 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/mart/mart_fullmoon_reviews.sql
[0m11:39:20.109262 [info ] [MainThread]: 
[0m11:39:20.109441 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:39:20.109702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864289fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86417854f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8641784b20>]}


============================== 2022-07-29 11:42:36.417636 | ef54c425-148d-4744-87be-20da5eb5059f ==============================
[0m11:42:36.417654 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:42:36.417956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m11:42:36.418067 [debug] [MainThread]: Tracking: tracking
[0m11:42:36.418255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a0745340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a07453a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a0745400>]}
[0m11:42:36.438719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:36.439054 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m11:42:36.448738 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m11:42:36.462575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef54c425-148d-4744-87be-20da5eb5059f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f419d5e6b20>]}
[0m11:42:36.466679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef54c425-148d-4744-87be-20da5eb5059f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a0732850>]}
[0m11:42:36.466885 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:42:36.467041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef54c425-148d-4744-87be-20da5eb5059f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a069aeb0>]}
[0m11:42:36.467542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a069af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a06b3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41a06b3a60>]}


============================== 2022-07-29 11:42:36.635216 | d6268845-13ab-490b-856d-c6ea33bc4202 ==============================
[0m11:42:36.635231 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:42:36.635561 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:42:36.635673 [debug] [MainThread]: Tracking: tracking
[0m11:42:36.635867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a89062e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8906340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a89063a0>]}
[0m11:42:36.659221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:42:36.659382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:42:36.663340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a77db0a0>]}
[0m11:42:36.667989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a77c62b0>]}
[0m11:42:36.668286 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m11:42:36.668527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a77d8e80>]}
[0m11:42:36.669653 [info ] [MainThread]: 
[0m11:42:36.670114 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:42:36.670949 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m11:42:36.679806 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m11:42:36.679938 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m11:42:36.680038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:37.276578 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.6 seconds
[0m11:42:37.278144 [debug] [ThreadPool]: On list_airbnb: Close
[0m11:42:37.371490 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m11:42:37.376501 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m11:42:37.376619 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m11:42:37.376720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:37.882555 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.51 seconds
[0m11:42:37.883644 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m11:42:37.976755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a779ad90>]}
[0m11:42:37.977155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:42:37.977373 [info ] [MainThread]: 
[0m11:42:37.980424 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m11:42:37.980952 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m11:42:37.981100 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m11:42:37.981246 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m11:42:37.982356 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:42:37.982600 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m11:42:37.982969 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m11:42:37.983214 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m11:42:37.983359 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m11:42:37.983590 [debug] [Thread-1  ]: finished collecting timing info
[0m11:42:37.984437 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:42:37.984598 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m11:42:37.984994 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m11:42:37.985451 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m11:42:37.985598 [debug] [Thread-2  ]: finished collecting timing info
[0m11:42:37.986101 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m11:42:37.986265 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:42:37.986621 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m11:42:37.986876 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m11:42:37.987126 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m11:42:37.988215 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:42:37.988515 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:42:37.988872 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:42:37.989209 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m11:42:37.989421 [debug] [Thread-3  ]: finished collecting timing info
[0m11:42:37.989604 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:42:37.989979 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:42:37.990320 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m11:42:37.990508 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m11:42:37.990705 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:42:37.996345 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m11:42:37.999626 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:42:38.005327 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m11:42:38.006444 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:42:38.006913 [info ] [Thread-2  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m11:42:38.007151 [debug] [Thread-4  ]: finished collecting timing info
[0m11:42:38.007686 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:38.007895 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:42:38.008127 [debug] [Thread-1  ]: finished collecting timing info
[0m11:42:38.008294 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m11:42:38.018961 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:42:38.029597 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:42:38.029800 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m11:42:38.031739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:42:38.040739 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m11:42:38.041997 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:42:38.042633 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:42:38.042783 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m11:42:38.042932 [debug] [Thread-2  ]: finished collecting timing info
[0m11:42:38.043110 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from "AIRBNB"."RAW"."RAW_HOSTS"
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m11:42:38.043304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:38.043505 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m11:42:38.043683 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:42:38.072601 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:38.072794 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m11:42:38.072933 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:42:38.564649 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m11:42:38.587222 [debug] [Thread-1  ]: finished collecting timing info
[0m11:42:38.587551 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:42:38.673978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a6935f10>]}
[0m11:42:38.674310 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 0.68s]
[0m11:42:38.674627 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:42:38.806970 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.76 seconds
[0m11:42:38.814411 [debug] [Thread-4  ]: finished collecting timing info
[0m11:42:38.815139 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:42:38.906084 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a692d9d0>]}
[0m11:42:38.906392 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.92s]
[0m11:42:38.906701 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:42:38.907182 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m11:42:38.907365 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m11:42:38.907702 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:42:38.907834 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m11:42:38.907965 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m11:42:38.910249 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:42:38.910533 [debug] [Thread-3  ]: finished collecting timing info
[0m11:42:38.910653 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m11:42:38.918060 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m11:42:38.918826 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m11:42:38.918947 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m11:42:38.919051 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:42:39.026057 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.95 seconds
[0m11:42:39.042580 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.042725 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:42:39.119708 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m11:42:39.122221 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.122359 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m11:42:39.177064 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m11:42:39.186881 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.187041 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m11:42:39.242942 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m11:42:39.247034 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.247164 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m11:42:39.300844 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.05 seconds
[0m11:42:39.308138 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:42:39.318221 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m11:42:39.318789 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.318907 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m11:42:39.394778 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m11:42:39.394985 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.395095 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m11:42:39.560630 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.17 seconds
[0m11:42:39.560888 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m11:42:39.561010 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m11:42:39.681363 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.12 seconds
[0m11:42:39.686773 [debug] [Thread-2  ]: finished collecting timing info
[0m11:42:39.686938 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m11:42:39.785846 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a779a550>]}
[0m11:42:39.786207 [info ] [Thread-2  ]: 3 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 1.78s]
[0m11:42:39.786587 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m11:42:39.787171 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m11:42:39.787407 [info ] [Thread-4  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m11:42:39.787840 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:42:39.788011 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m11:42:39.788176 [debug] [Thread-4  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m11:42:39.790745 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:42:39.790999 [debug] [Thread-4  ]: finished collecting timing info
[0m11:42:39.791113 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m11:42:39.792631 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m11:42:39.793228 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m11:42:39.793340 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)
 
select
    r.*,
    CASE
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_date))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m11:42:39.793442 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:42:40.085759 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.17 seconds
[0m11:42:40.087649 [debug] [Thread-3  ]: finished collecting timing info
[0m11:42:40.087817 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m11:42:40.181420 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a43eb0a0>]}
[0m11:42:40.181742 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.27s]
[0m11:42:40.182062 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m11:42:48.233475 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 8.44 seconds
[0m11:42:48.235045 [debug] [Thread-4  ]: finished collecting timing info
[0m11:42:48.235191 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m11:42:48.394400 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6268845-13ab-490b-856d-c6ea33bc4202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8928910>]}
[0m11:42:48.394709 [info ] [Thread-4  ]: 5 of 5 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 8.61s]
[0m11:42:48.395031 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m11:42:48.396259 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m11:42:48.396561 [info ] [MainThread]: 
[0m11:42:48.396772 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m11:42:48.396965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:48.397064 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m11:42:48.397162 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m11:42:48.397259 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m11:42:48.397355 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m11:42:48.401805 [info ] [MainThread]: 
[0m11:42:48.402041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:48.402260 [info ] [MainThread]: 
[0m11:42:48.402443 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:42:48.402700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a8928760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a77c63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a77c3ee0>]}


============================== 2022-07-29 11:56:04.563449 | 7fbcfc9c-0cf4-473a-a298-adea4dc65649 ==============================
[0m11:56:04.563465 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:56:04.563762 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m11:56:04.563874 [debug] [MainThread]: Tracking: tracking
[0m11:56:04.564064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0414d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0414d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0414d310>]}
[0m11:56:04.578228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0408dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0408dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0408dac0>]}


============================== 2022-07-29 11:56:38.086381 | a0b01a41-5237-475d-9dc0-2e1b0cef24c0 ==============================
[0m11:56:38.086399 [info ] [MainThread]: Running with dbt=1.2.0
[0m11:56:38.086702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m11:56:38.086817 [debug] [MainThread]: Tracking: tracking
[0m11:56:38.087006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3985f61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3985f612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3985f61310>]}
[0m11:56:38.101046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3985ee4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3985ee4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3985ee4ac0>]}


============================== 2022-07-29 12:00:55.715349 | 32ad836d-39fc-4017-b7b0-35f5d56b6f3f ==============================
[0m12:00:55.715366 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:00:55.715672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m12:00:55.715790 [debug] [MainThread]: Tracking: tracking
[0m12:00:55.715983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f086c8220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f086c8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f086c82e0>]}
[0m12:00:55.739402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f08645c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f08645ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f08645a90>]}


============================== 2022-07-29 12:00:56.046784 | 0e3abba7-d4ca-4a66-bc6b-8efdf1494d5d ==============================
[0m12:00:56.046800 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:00:56.047134 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:00:56.047267 [debug] [MainThread]: Tracking: tracking
[0m12:00:56.047457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfda2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfda2370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfda23d0>]}
[0m12:00:56.065495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfc83cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfc83d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfc83b50>]}


============================== 2022-07-29 12:02:04.396620 | 70a8238d-c9a9-4b27-820b-d809838293ed ==============================
[0m12:02:04.396636 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:02:04.396992 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:02:04.397108 [debug] [MainThread]: Tracking: tracking
[0m12:02:04.397300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae59603d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5960430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5960490>]}
[0m12:02:04.411909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5842dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5842e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae5842c40>]}


============================== 2022-07-29 12:06:40.370294 | fe56b751-18ff-46f0-acbe-75a193ffd2b0 ==============================
[0m12:06:40.370309 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:06:40.370656 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:06:40.370773 [debug] [MainThread]: Tracking: tracking
[0m12:06:40.370976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b70c833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b70c83430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b70c83490>]}
[0m12:06:40.394789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:06:40.395147 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/sources.yml
[0m12:06:40.395362 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_hosts.sql
[0m12:06:40.395583 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m12:06:40.408257 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:06:40.417525 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:06:40.438767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe56b751-18ff-46f0-acbe-75a193ffd2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6dae4250>]}
[0m12:06:40.443508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe56b751-18ff-46f0-acbe-75a193ffd2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6db26310>]}
[0m12:06:40.443750 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:06:40.443951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe56b751-18ff-46f0-acbe-75a193ffd2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6dae7fd0>]}
[0m12:06:40.444991 [info ] [MainThread]: 
[0m12:06:40.445322 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m12:06:40.446024 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m12:06:40.454374 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m12:06:40.454543 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m12:06:40.454653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:41.080730 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.63 seconds
[0m12:06:41.083423 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m12:06:41.206597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe56b751-18ff-46f0-acbe-75a193ffd2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6db0bee0>]}
[0m12:06:41.207022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:06:41.207269 [info ] [MainThread]: 
[0m12:06:41.211789 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m12:06:41.212017 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m12:06:41.212359 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m12:06:41.212545 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m12:06:41.212901 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m12:06:41.213072 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m12:06:41.213292 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m12:06:41.213611 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m12:06:41.213810 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m12:06:41.214136 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m12:06:41.214361 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m12:06:41.214555 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m12:06:41.214746 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m12:06:41.214940 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m12:06:41.217972 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:06:41.218223 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m12:06:41.219895 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:06:41.220114 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m12:06:41.221303 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:06:41.222656 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m12:06:41.223054 [debug] [Thread-1  ]: finished collecting timing info
[0m12:06:41.223242 [debug] [Thread-2  ]: finished collecting timing info
[0m12:06:41.223478 [debug] [Thread-4  ]: finished collecting timing info
[0m12:06:41.224024 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m12:06:41.224170 [debug] [Thread-3  ]: finished collecting timing info
[0m12:06:41.224532 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m12:06:41.224733 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m12:06:41.225159 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m12:06:41.225611 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:06:41.225922 [debug] [Thread-4  ]: finished collecting timing info
[0m12:06:41.226784 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:06:41.226954 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:06:41.227424 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m12:06:41.227652 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m12:06:41.227773 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:06:41.228058 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:06:41.228619 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m12:06:41.228873 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m12:06:41.229125 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:06:41.229363 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m12:06:41.238404 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:06:41.238642 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m12:06:41.238881 [debug] [Thread-3  ]: Compiling model.dbtlearn.fct_reviews
[0m12:06:41.245788 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:06:41.254429 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:06:41.255032 [debug] [Thread-2  ]: finished collecting timing info
[0m12:06:41.255207 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:06:41.255470 [debug] [Thread-2  ]: finished collecting timing info
[0m12:06:41.255613 [debug] [Thread-1  ]: finished collecting timing info
[0m12:06:41.256006 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:06:41.256139 [debug] [Thread-3  ]: finished collecting timing info
[0m12:06:41.256316 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:06:41.256811 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m12:06:41.257055 [debug] [Thread-1  ]: finished collecting timing info
[0m12:06:41.257309 [debug] [Thread-3  ]: finished collecting timing info
[0m12:06:41.257723 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:06:41.258093 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m12:06:41.258807 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:06:41.259100 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:06:41.259375 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:06:41.259631 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m12:06:41.259785 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m12:06:41.260251 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m12:06:41.262347 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:06:41.262542 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m12:06:41.262798 [debug] [Thread-2  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m12:06:41.265255 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m12:06:41.265561 [debug] [Thread-2  ]: finished collecting timing info
[0m12:06:41.265693 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m12:06:41.265825 [debug] [Thread-2  ]: finished collecting timing info
[0m12:06:41.266124 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m12:06:41.266429 [debug] [Thread-4  ]: finished collecting timing info
[0m12:06:41.266545 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:06:41.266654 [debug] [Thread-4  ]: finished collecting timing info
[0m12:06:41.266920 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:06:41.267938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:41.268051 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m12:06:41.268150 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m12:06:41.268246 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m12:06:41.268341 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m12:06:41.306044 [info ] [MainThread]: Done.
[0m12:06:41.306360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cccae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6cccaa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b76768160>]}


============================== 2022-07-29 12:27:09.450980 | 24bce6bc-85d4-4a89-ab46-0a5ecb28ff79 ==============================
[0m12:27:09.450997 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:27:09.451347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m12:27:09.451462 [debug] [MainThread]: Tracking: tracking
[0m12:27:09.451653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015ef0a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015ef0a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015ef0a490>]}
[0m12:27:09.475409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:09.475880 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.listings
[0m12:27:09.476074 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.hosts
[0m12:27:09.476173 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.reviews
[0m12:27:09.476284 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/sources.yml
[0m12:27:09.486541 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:27:09.495244 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:27:09.497108 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:27:09.499041 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:27:09.500820 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:27:09.512743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015dd9f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015c0f7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015c0f73a0>]}


============================== 2022-07-29 12:27:30.413348 | 1eb585fa-72bc-4b82-a023-0ffb7444e8b0 ==============================
[0m12:27:30.413364 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:27:30.413699 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m12:27:30.413814 [debug] [MainThread]: Tracking: tracking
[0m12:27:30.414006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48da1234c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48da123520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48da123580>]}
[0m12:27:30.438791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:30.439343 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.listings
[0m12:27:30.439548 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.hosts
[0m12:27:30.439650 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.reviews
[0m12:27:30.439763 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/sources.yml
[0m12:27:30.451315 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:27:30.460905 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:27:30.464001 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:27:30.467245 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:27:30.469079 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:27:30.481023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d8fdd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d813e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d813e430>]}


============================== 2022-07-29 12:28:12.021961 | b785113e-b6ae-42aa-99a9-713d26f9e496 ==============================
[0m12:28:12.021977 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:28:12.022325 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m12:28:12.022441 [debug] [MainThread]: Tracking: tracking
[0m12:28:12.022635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ea59f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ea59f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ea59f430>]}
[0m12:28:12.049188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:12.049654 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.listings
[0m12:28:12.049844 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.hosts
[0m12:28:12.049942 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.reviews
[0m12:28:12.050051 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/sources.yml
[0m12:28:12.059782 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:28:12.068588 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:28:12.070365 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:28:12.072299 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:28:12.074057 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:28:12.085964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ea49d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71e846d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71e83f8820>]}


============================== 2022-07-29 12:29:20.491795 | 60624004-003b-4624-8a18-1d3eb0d96302 ==============================
[0m12:29:20.491813 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:29:20.492161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m12:29:20.492295 [debug] [MainThread]: Tracking: tracking
[0m12:29:20.492486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c1b08340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c1b083a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c1b08400>]}
[0m12:29:20.514848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:20.515294 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.listings
[0m12:29:20.515487 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.hosts
[0m12:29:20.515586 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.reviews
[0m12:29:20.515695 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/sources.yml
[0m12:29:20.525575 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:29:20.534026 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:29:20.535604 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:29:20.537464 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:29:20.539305 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:29:20.550955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c09a0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c097e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c0109790>]}


============================== 2022-07-29 12:30:09.188726 | fe5dd88a-d0d9-4bd7-8eef-6681f900dcb7 ==============================
[0m12:30:09.188746 [info ] [MainThread]: Running with dbt=1.2.0
[0m12:30:09.189102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m12:30:09.189220 [debug] [MainThread]: Tracking: tracking
[0m12:30:09.189429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b179c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b179c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b179c3d0>]}
[0m12:30:09.214577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:09.215044 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.listings
[0m12:30:09.215242 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.hosts
[0m12:30:09.215343 [debug] [MainThread]: Partial parsing: deleted source source.dbtlearn.airbnb.reviews
[0m12:30:09.215453 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/sources.yml
[0m12:30:09.224928 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m12:30:09.233766 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m12:30:09.235591 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m12:30:09.237511 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m12:30:09.239341 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m12:30:09.257510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe5dd88a-d0d9-4bd7-8eef-6681f900dcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38b5ee190>]}
[0m12:30:09.261997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe5dd88a-d0d9-4bd7-8eef-6681f900dcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b0071520>]}
[0m12:30:09.262192 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m12:30:09.262389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5dd88a-d0d9-4bd7-8eef-6681f900dcb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b169e640>]}
[0m12:30:09.263241 [info ] [MainThread]: 
[0m12:30:09.263439 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m12:30:09.267151 [info ] [MainThread]: Done.
[0m12:30:09.267440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b00711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b00719d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3b00714c0>]}


============================== 2022-07-29 13:18:04.973701 | fbfa7c53-92b3-4b1a-96d8-bfaba785b074 ==============================
[0m13:18:04.973716 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:18:04.974175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m13:18:04.974303 [debug] [MainThread]: Tracking: tracking
[0m13:18:04.974526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ba6323d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ba632430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ba632490>]}
[0m13:18:05.000367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:18:05.000652 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_listings.sql
[0m13:18:05.019865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b94cc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b94f0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b9487040>]}


============================== 2022-07-29 13:18:45.627006 | 016253ca-0b70-4c45-9d79-8cd37f63a944 ==============================
[0m13:18:45.627023 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:18:45.627389 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m13:18:45.627514 [debug] [MainThread]: Tracking: tracking
[0m13:18:45.627719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ffc413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ffc41400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ffc41460>]}
[0m13:18:45.657410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:18:45.657708 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_listings.sql
[0m13:18:45.669736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65feb0d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65feb31250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65feac8a00>]}


============================== 2022-07-29 13:19:25.360802 | f09036ef-de54-4c26-9344-eeefa7684a0b ==============================
[0m13:19:25.360817 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:19:25.361164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m13:19:25.361276 [debug] [MainThread]: Tracking: tracking
[0m13:19:25.361464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ee852e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ee85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ee853a0>]}
[0m13:19:25.383217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:19:25.383495 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_listings.sql
[0m13:19:25.409076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f09036ef-de54-4c26-9344-eeefa7684a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2dc41c10>]}
[0m13:19:25.413636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f09036ef-de54-4c26-9344-eeefa7684a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2dd89e50>]}
[0m13:19:25.413887 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:19:25.414098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09036ef-de54-4c26-9344-eeefa7684a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2dd89cd0>]}
[0m13:19:25.415101 [info ] [MainThread]: 
[0m13:19:25.415450 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:25.416053 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:19:25.424383 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:19:25.424521 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:19:25.424624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:26.890656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.47 seconds
[0m13:19:26.892332 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:19:27.246901 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:19:27.251630 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:19:27.251754 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:19:27.251854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:27.924593 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.67 seconds
[0m13:19:27.925691 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:19:28.075136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09036ef-de54-4c26-9344-eeefa7684a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ee852e0>]}
[0m13:19:28.075546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:28.075780 [info ] [MainThread]: 
[0m13:19:28.079206 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m13:19:28.079466 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m13:19:28.080056 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:19:28.080177 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m13:19:28.080308 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m13:19:28.082747 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:28.082921 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m13:19:28.124552 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.dbtlearn.scd_raw_listings"
[0m13:19:28.125285 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:19:28.125396 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace transient table airbnb.dev.scd_raw_listings  as
      (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select * from airbnb.raw.raw_listings

    ) sbq



      );
[0m13:19:28.125497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:30.129200 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:19:30.145901 [debug] [Thread-1  ]: finished collecting timing info
[0m13:19:30.146081 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m13:19:30.233939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f09036ef-de54-4c26-9344-eeefa7684a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ce48b80>]}
[0m13:19:30.234281 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 2.15s]
[0m13:19:30.234600 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m13:19:30.235696 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:19:30.236083 [info ] [MainThread]: 
[0m13:19:30.236367 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m13:19:30.236668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:30.236765 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m13:19:30.241672 [info ] [MainThread]: 
[0m13:19:30.241915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:30.242130 [info ] [MainThread]: 
[0m13:19:30.242306 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:30.242571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2dd05f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ce103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2ce10610>]}


============================== 2022-07-29 13:27:07.894738 | 5f1e0f9c-d350-4797-b1e5-703c12824768 ==============================
[0m13:27:07.894757 [info ] [MainThread]: Running with dbt=1.2.0
[0m13:27:07.895115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m13:27:07.895231 [debug] [MainThread]: Tracking: tracking
[0m13:27:07.895431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8f652e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8f65340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8f653a0>]}
[0m13:27:07.919694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:07.919910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:07.924200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f1e0f9c-d350-4797-b1e5-703c12824768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8e66130>]}
[0m13:27:07.928830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f1e0f9c-d350-4797-b1e5-703c12824768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8e4d3a0>]}
[0m13:27:07.929053 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m13:27:07.929252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1e0f9c-d350-4797-b1e5-703c12824768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8e65f10>]}
[0m13:27:07.930205 [info ] [MainThread]: 
[0m13:27:07.930592 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:27:07.931382 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m13:27:07.940979 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m13:27:07.941157 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m13:27:07.941265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:08.515627 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.57 seconds
[0m13:27:08.517082 [debug] [ThreadPool]: On list_airbnb: Close
[0m13:27:08.609112 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m13:27:08.613744 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m13:27:08.613866 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m13:27:08.613964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:09.111445 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.5 seconds
[0m13:27:09.112965 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m13:27:09.207036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f1e0f9c-d350-4797-b1e5-703c12824768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a8f87760>]}
[0m13:27:09.207426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:09.207630 [info ] [MainThread]: 
[0m13:27:09.210793 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m13:27:09.211036 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m13:27:09.211661 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:09.211805 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m13:27:09.211951 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m13:27:09.215376 [debug] [Thread-1  ]: finished collecting timing info
[0m13:27:09.215658 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m13:27:09.256417 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:09.256595 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m13:27:09.256700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:27:09.575855 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.32 seconds
[0m13:27:09.596910 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:09.597073 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"  as
      (with snapshot_query as (

        



select * from airbnb.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

      );
[0m13:27:10.960570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.36 seconds
[0m13:27:10.962424 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:10.962541 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m13:27:11.037444 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0.07 seconds
[0m13:27:11.040391 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.040530 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m13:27:11.224606 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.18 seconds
[0m13:27:11.227822 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.227950 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m13:27:11.447419 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0.22 seconds
[0m13:27:11.460154 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.460755 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m13:27:11.605167 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0.14 seconds
[0m13:27:11.610446 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.610608 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m13:27:11.666038 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0.06 seconds
[0m13:27:11.672775 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.673564 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.673676 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
BEGIN
[0m13:27:11.841924 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.17 seconds
[0m13:27:11.842186 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:11.842316 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:27:12.573457 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.73 seconds
[0m13:27:12.573718 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m13:27:12.573851 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
COMMIT
[0m13:27:12.788823 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.21 seconds
[0m13:27:12.817636 [debug] [Thread-1  ]: finished collecting timing info
[0m13:27:12.817810 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m13:27:12.934774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1e0f9c-d350-4797-b1e5-703c12824768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62a41dec40>]}
[0m13:27:12.935129 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 3.72s]
[0m13:27:12.935453 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m13:27:12.936630 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m13:27:12.936940 [info ] [MainThread]: 
[0m13:27:12.937182 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m13:27:12.937371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:12.937467 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m13:27:12.985585 [info ] [MainThread]: 
[0m13:27:12.985816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:12.986027 [info ] [MainThread]: 
[0m13:27:12.986210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:27:12.986567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62aef37280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ab786cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ab786c70>]}


============================== 2022-07-30 00:29:48.422860 | 4fb36663-3c51-4350-a994-2579252e6b97 ==============================
[0m00:29:48.422875 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:29:48.423669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:29:48.423759 [debug] [MainThread]: Tracking: tracking
[0m00:29:48.423918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153ba1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153ba1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153ba12e0>]}
[0m00:29:48.475372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:48.475514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:48.479666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153aac070>]}
[0m00:29:48.484359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153a932e0>]}
[0m00:29:48.484551 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m00:29:48.484713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153aabe50>]}
[0m00:29:48.485752 [info ] [MainThread]: 
[0m00:29:48.486043 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m00:29:48.486715 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m00:29:48.495111 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m00:29:48.495212 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m00:29:48.495283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:49.276407 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.78 seconds
[0m00:29:49.277650 [debug] [ThreadPool]: On list_airbnb: Close
[0m00:29:49.400439 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m00:29:49.410160 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m00:29:49.410355 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m00:29:49.410497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:50.304039 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.89 seconds
[0m00:29:50.305138 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m00:29:50.406738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153a8ee20>]}
[0m00:29:50.407094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:50.407270 [info ] [MainThread]: 
[0m00:29:50.412593 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m00:29:50.413060 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m00:29:50.413179 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m00:29:50.413299 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m00:29:50.415231 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m00:29:50.415472 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m00:29:50.415756 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m00:29:50.415896 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m00:29:50.416008 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m00:29:50.417654 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m00:29:50.417971 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m00:29:50.418217 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m00:29:50.418517 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m00:29:50.418638 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m00:29:50.419680 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m00:29:50.420186 [debug] [Thread-3  ]: finished collecting timing info
[0m00:29:50.420498 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m00:29:50.421093 [debug] [Thread-2  ]: finished collecting timing info
[0m00:29:50.421358 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m00:29:50.421511 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m00:29:50.421779 [debug] [Thread-1  ]: finished collecting timing info
[0m00:29:50.421960 [info ] [Thread-2  ]: 1 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m00:29:50.422585 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m00:29:50.422759 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m00:29:50.423154 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:50.423483 [info ] [Thread-3  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m00:29:50.423882 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m00:29:50.424074 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m00:29:50.424490 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m00:29:50.424706 [info ] [Thread-1  ]: 3 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m00:29:50.424869 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m00:29:50.425035 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m00:29:50.425375 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m00:29:50.436040 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m00:29:50.439171 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m00:29:50.439363 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m00:29:50.444418 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m00:29:50.444675 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m00:29:50.448130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m00:29:50.448640 [debug] [Thread-2  ]: finished collecting timing info
[0m00:29:50.448785 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m00:29:50.464404 [debug] [Thread-3  ]: finished collecting timing info
[0m00:29:50.464600 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m00:29:50.480484 [debug] [Thread-1  ]: finished collecting timing info
[0m00:29:50.491139 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m00:29:50.496109 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m00:29:50.497264 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m00:29:50.500624 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:50.500753 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m00:29:50.500864 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:29:50.503107 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m00:29:50.503232 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT * FROM airbnb.raw.raw_listings
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m00:29:50.503342 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:29:50.505297 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m00:29:50.505387 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m00:29:50.505487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:29:51.391249 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m00:29:51.418292 [debug] [Thread-3  ]: finished collecting timing info
[0m00:29:51.418440 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m00:29:51.517882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
[0m00:29:51.519318 [debug] [Thread-1  ]: finished collecting timing info
[0m00:29:51.519453 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m00:29:51.521885 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa152b212e0>]}
[0m00:29:51.522112 [info ] [Thread-3  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.10s]
[0m00:29:51.522427 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m00:29:51.618223 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa152b21a90>]}
[0m00:29:51.618512 [info ] [Thread-1  ]: 3 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.19s]
[0m00:29:51.618806 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m00:29:51.619243 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m00:29:51.619422 [info ] [Thread-4  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m00:29:51.619777 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m00:29:51.619884 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m00:29:51.619990 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m00:29:51.622156 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m00:29:51.622387 [debug] [Thread-4  ]: finished collecting timing info
[0m00:29:51.622469 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m00:29:51.629095 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m00:29:51.629663 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m00:29:51.629747 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m00:29:51.629818 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:29:52.529591 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.03 seconds
[0m00:29:52.536285 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:52.536406 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m00:29:52.679631 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.14 seconds
[0m00:29:52.682387 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:52.682487 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m00:29:52.749452 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m00:29:52.759067 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:52.759176 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m00:29:52.830514 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.07 seconds
[0m00:29:52.832856 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:52.832966 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m00:29:52.911590 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.08 seconds
[0m00:29:52.918327 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:29:52.926853 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m00:29:52.927645 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:52.927732 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m00:29:53.026004 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.1 seconds
[0m00:29:53.026176 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:53.026251 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m00:29:53.407390 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 0.38 seconds
[0m00:29:53.407581 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m00:29:53.407654 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m00:29:53.540911 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m00:29:53.545276 [debug] [Thread-2  ]: finished collecting timing info
[0m00:29:53.545391 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m00:29:53.651702 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa152bebc40>]}
[0m00:29:53.652384 [info ] [Thread-2  ]: 1 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 3.23s]
[0m00:29:53.653297 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m00:29:53.654335 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m00:29:53.654840 [info ] [Thread-1  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m00:29:53.655798 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m00:29:53.656019 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m00:29:53.656244 [debug] [Thread-1  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m00:29:53.661084 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m00:29:53.661991 [debug] [Thread-1  ]: finished collecting timing info
[0m00:29:53.662171 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m00:29:53.665342 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m00:29:53.666784 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m00:29:53.666947 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)
 
select
    r.*,
    CASE
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_date))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m00:29:53.667069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:29:53.687573 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.06 seconds
[0m00:29:53.690229 [debug] [Thread-4  ]: finished collecting timing info
[0m00:29:53.690442 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m00:29:53.796273 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153ab6df0>]}
[0m00:29:53.796595 [info ] [Thread-4  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 2.18s]
[0m00:29:53.797025 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m00:29:58.129568 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.46 seconds
[0m00:29:58.131052 [debug] [Thread-1  ]: finished collecting timing info
[0m00:29:58.131162 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m00:29:58.241407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb36663-3c51-4350-a994-2579252e6b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1505e9b20>]}
[0m00:29:58.241703 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 4.59s]
[0m00:29:58.241989 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m00:29:58.243181 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m00:29:58.243413 [info ] [MainThread]: 
[0m00:29:58.243572 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m00:29:58.243724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:58.243796 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m00:29:58.243857 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m00:29:58.243917 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m00:29:58.243977 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m00:29:58.248021 [info ] [MainThread]: 
[0m00:29:58.248179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:58.248356 [info ] [MainThread]: 
[0m00:29:58.248531 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:29:58.248723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa152c37670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa152bebb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153a87d00>]}


============================== 2022-07-30 00:30:18.628119 | 2c31c8d7-cdab-438f-98a1-2c89fe631833 ==============================
00:30:18.628128 [info ] [MainThread]: Running with dbt=1.1.1
00:30:18.628396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
00:30:18.628509 [debug] [MainThread]: Tracking: tracking
00:30:18.628706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a68a1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a68a1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a68a16d0>]}
00:30:18.641814 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
00:30:18.642028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c31c8d7-cdab-438f-98a1-2c89fe631833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a68c5ac0>]}
00:30:18.659290 [debug] [MainThread]: Parsing macros/adapters.sql
00:30:18.686226 [debug] [MainThread]: Parsing macros/catalog.sql
00:30:18.687640 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:30:18.688309 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:30:18.691075 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:30:18.697508 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:30:18.699744 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:30:18.700725 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:30:18.704560 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:30:18.711383 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:30:18.718117 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:30:18.721377 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:30:18.723526 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:30:18.725621 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:30:18.727224 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:30:18.732621 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:30:18.734502 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:30:18.735667 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:30:18.736751 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:30:18.743076 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:30:18.746251 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:30:18.746783 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:30:18.747394 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:30:18.748045 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:30:18.749067 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:30:18.750800 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:30:18.753648 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:30:18.754995 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:30:18.756454 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:30:18.759887 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:30:18.771298 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:30:18.775984 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:30:18.777202 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:30:18.784771 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:30:18.796416 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:30:18.806353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:30:18.817797 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:30:18.829489 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:30:18.837097 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:30:18.838245 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:30:18.841502 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:30:18.843460 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:30:18.844424 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:30:18.849505 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:30:18.851555 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:30:18.853700 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:30:18.859127 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:30:19.011043 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
00:30:19.019220 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
00:30:19.021059 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
00:30:19.023014 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
00:30:19.028814 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
00:30:19.030045 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
00:30:19.032041 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
00:30:19.034000 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
00:30:19.036013 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
00:30:19.083329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c31c8d7-cdab-438f-98a1-2c89fe631833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a4193310>]}
00:30:19.087468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c31c8d7-cdab-438f-98a1-2c89fe631833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a691d100>]}
00:30:19.087725 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 181 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
00:30:19.087894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c31c8d7-cdab-438f-98a1-2c89fe631833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a4149040>]}
00:30:19.088447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a68cb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a415c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a57ec1c0>]}


============================== 2022-07-30 00:41:05.046052 | 8d083d63-53a1-4227-92aa-8a63e919575c ==============================
[0m00:41:05.046068 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:41:05.046415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m00:41:05.046534 [debug] [MainThread]: Tracking: tracking
[0m00:41:05.046727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180cf7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180cf73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180cf7400>]}
[0m00:41:05.058667 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m00:41:05.058970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d083d63-53a1-4227-92aa-8a63e919575c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180d18820>]}
[0m00:41:05.067684 [debug] [MainThread]: Parsing macros/adapters.sql
[0m00:41:05.098148 [debug] [MainThread]: Parsing macros/catalog.sql
[0m00:41:05.099534 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m00:41:05.100234 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m00:41:05.103121 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m00:41:05.110285 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m00:41:05.113107 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m00:41:05.114120 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m00:41:05.117970 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:41:05.118332 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:41:05.118739 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:41:05.119310 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:41:05.119761 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m00:41:05.126707 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m00:41:05.137590 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m00:41:05.141013 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m00:41:05.143198 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m00:41:05.153597 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m00:41:05.155628 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m00:41:05.157286 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m00:41:05.162557 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m00:41:05.164494 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m00:41:05.165727 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m00:41:05.166858 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m00:41:05.173007 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m00:41:05.176272 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m00:41:05.176807 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m00:41:05.177419 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m00:41:05.178061 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m00:41:05.179082 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m00:41:05.180786 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m00:41:05.183887 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m00:41:05.185231 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m00:41:05.186550 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m00:41:05.189757 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m00:41:05.203502 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m00:41:05.208294 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m00:41:05.209546 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m00:41:05.218032 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m00:41:05.230370 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m00:41:05.240335 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m00:41:05.251629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m00:41:05.263861 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m00:41:05.270284 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m00:41:05.271425 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m00:41:05.274451 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m00:41:05.276985 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m00:41:05.278008 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m00:41:05.281693 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m00:41:05.283429 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m00:41:05.285572 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m00:41:05.289603 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m00:41:05.291484 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m00:41:05.293059 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m00:41:05.293768 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m00:41:05.294717 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m00:41:05.295518 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m00:41:05.296236 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m00:41:05.296943 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m00:41:05.297897 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m00:41:05.298760 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m00:41:05.300227 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m00:41:05.300947 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m00:41:05.301694 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m00:41:05.302533 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m00:41:05.303339 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m00:41:05.304174 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m00:41:05.305178 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m00:41:05.306002 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m00:41:05.310539 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m00:41:05.311219 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m00:41:05.311856 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m00:41:05.312690 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m00:41:05.498440 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m00:41:05.505995 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m00:41:05.507776 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m00:41:05.509524 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m00:41:05.514743 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m00:41:05.515883 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m00:41:05.517783 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m00:41:05.519730 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m00:41:05.521658 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m00:41:05.610127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d083d63-53a1-4227-92aa-8a63e919575c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180cec2b0>]}
[0m00:41:05.614274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d083d63-53a1-4227-92aa-8a63e919575c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180ca9f10>]}
[0m00:41:05.614469 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m00:41:05.614667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d083d63-53a1-4227-92aa-8a63e919575c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417daf9280>]}
[0m00:41:05.615608 [info ] [MainThread]: 
[0m00:41:05.615840 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m00:41:05.619653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417db5cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180d54af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4180cec1c0>]}


============================== 2022-07-30 00:44:13.120137 | e2c4b617-9d13-4bab-8008-6cfebaa2e40c ==============================
[0m00:44:13.120153 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:44:13.120482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m00:44:13.120585 [debug] [MainThread]: Tracking: tracking
[0m00:44:13.120767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff9acc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff9acc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff9acc2b0>]}
[0m00:44:13.141685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:44:13.141839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:44:13.146017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2c4b617-9d13-4bab-8008-6cfebaa2e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff89ae670>]}
[0m00:44:13.150740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2c4b617-9d13-4bab-8008-6cfebaa2e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff8993610>]}
[0m00:44:13.150931 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m00:44:13.151114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2c4b617-9d13-4bab-8008-6cfebaa2e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff89934f0>]}
[0m00:44:13.151995 [info ] [MainThread]: 
[0m00:44:13.152184 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m00:44:13.155883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff9ad9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff9acc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff9b4a0a0>]}


============================== 2022-07-30 00:46:02.740164 | 82777661-75ac-405e-8256-3f4a2044a272 ==============================
[0m00:46:02.740181 [info ] [MainThread]: Running with dbt=1.2.0
[0m00:46:02.740521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m00:46:02.740634 [debug] [MainThread]: Tracking: tracking
[0m00:46:02.740820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31025152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3102515340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31025153a0>]}
[0m00:46:02.771527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:02.771792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:02.779775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82777661-75ac-405e-8256-3f4a2044a272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31013ec6d0>]}
[0m00:46:02.787393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82777661-75ac-405e-8256-3f4a2044a272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3102486670>]}
[0m00:46:02.787623 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m00:46:02.787829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82777661-75ac-405e-8256-3f4a2044a272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31024864f0>]}
[0m00:46:02.788742 [info ] [MainThread]: 
[0m00:46:02.788955 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m00:46:02.792709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3102529fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31025152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31025a4100>]}


============================== 2022-07-30 01:25:39.448936 | a97ff2ee-3ab9-46f2-b5af-d70c8cdb2870 ==============================
[0m01:25:39.448951 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:25:39.449325 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m01:25:39.449443 [debug] [MainThread]: Tracking: tracking
[0m01:25:39.449639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d9f622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d9f62340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d9f623a0>]}
[0m01:25:39.471382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:25:39.471784 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m01:25:39.481289 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m01:25:39.510113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97ff2ee-3ab9-46f2-b5af-d70c8cdb2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d81e9b80>]}
[0m01:25:39.514981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97ff2ee-3ab9-46f2-b5af-d70c8cdb2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d81b6100>]}
[0m01:25:39.515168 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m01:25:39.515361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97ff2ee-3ab9-46f2-b5af-d70c8cdb2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d81b61f0>]}
[0m01:25:39.516372 [info ] [MainThread]: 
[0m01:25:39.516708 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m01:25:39.517556 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m01:25:39.525865 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m01:25:39.526044 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m01:25:39.526168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:40.213083 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.69 seconds
[0m01:25:40.214471 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m01:25:40.302032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97ff2ee-3ab9-46f2-b5af-d70c8cdb2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d9e31bb0>]}
[0m01:25:40.302495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:25:40.302718 [info ] [MainThread]: 
[0m01:25:40.305770 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:25:40.305979 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:25:40.306121 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m01:25:40.306382 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m01:25:40.306783 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:25:40.307191 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:25:40.307336 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:25:40.307513 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:25:40.307677 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:25:40.307849 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:25:40.316659 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:25:40.321393 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:25:40.322120 [debug] [Thread-1  ]: finished collecting timing info
[0m01:25:40.322298 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:25:40.327583 [debug] [Thread-2  ]: finished collecting timing info
[0m01:25:40.327755 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:25:40.337514 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:25:40.339081 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:25:40.339781 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:25:40.339907 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m01:25:40.340022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:25:40.342028 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:25:40.342138 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:25:40.342235 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:25:41.649044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.31 seconds
[0m01:25:41.655332 [debug] [Thread-1  ]: finished collecting timing info
[0m01:25:41.655482 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m01:25:41.762599 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.46s]
[0m01:25:41.763019 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:25:41.767875 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.43 seconds
[0m01:25:41.768950 [debug] [Thread-2  ]: finished collecting timing info
[0m01:25:41.769079 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m01:25:41.860109 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.55s]
[0m01:25:41.860480 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:25:41.861569 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m01:25:41.861798 [info ] [MainThread]: 
[0m01:25:41.861986 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m01:25:41.862168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:41.862267 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m01:25:41.862360 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m01:25:41.866792 [info ] [MainThread]: 
[0m01:25:41.866998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:41.867206 [info ] [MainThread]: 
[0m01:25:41.867383 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:25:41.867626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d814a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a2fd60a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a2fd61f0>]}


============================== 2022-07-30 01:42:51.273246 | 06100be3-b71e-493a-8e0d-430515de571d ==============================
[0m01:42:51.273262 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:42:51.273614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m01:42:51.273729 [debug] [MainThread]: Tracking: tracking
[0m01:42:51.273921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3110ab33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3110ab3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3110ab3490>]}
[0m01:42:51.289572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3110a5b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3110a5b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3110a5b430>]}


============================== 2022-07-30 01:44:11.623757 | efae4784-1929-4817-b2bf-916d723ae034 ==============================
[0m01:44:11.623772 [info ] [MainThread]: Running with dbt=1.2.0
[0m01:44:11.624130 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m01:44:11.624248 [debug] [MainThread]: Tracking: tracking
[0m01:44:11.624453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66d411c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66d41220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66d41280>]}
[0m01:44:11.652453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:44:11.652869 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m01:44:11.662272 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m01:44:11.709214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efae4784-1929-4817-b2bf-916d723ae034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a65bf2760>]}
[0m01:44:11.714045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efae4784-1929-4817-b2bf-916d723ae034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66caacd0>]}
[0m01:44:11.714254 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m01:44:11.714455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efae4784-1929-4817-b2bf-916d723ae034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66caae50>]}
[0m01:44:11.715614 [info ] [MainThread]: 
[0m01:44:11.715972 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m01:44:11.716878 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m01:44:11.725379 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m01:44:11.725535 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m01:44:11.725647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:12.379927 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.65 seconds
[0m01:44:12.381366 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m01:44:12.590139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efae4784-1929-4817-b2bf-916d723ae034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66caa970>]}
[0m01:44:12.590540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:44:12.590747 [info ] [MainThread]: 
[0m01:44:12.594003 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m01:44:12.594163 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m01:44:12.594509 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m01:44:12.594643 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m01:44:12.594783 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m01:44:12.599061 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m01:44:12.599326 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m01:44:12.599726 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:44:12.599962 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m01:44:12.600138 [debug] [Thread-1  ]: finished collecting timing info
[0m01:44:12.600376 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m01:44:12.600600 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m01:44:12.600791 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m01:44:12.601019 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m01:44:12.601552 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m01:44:12.601993 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:44:12.602439 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m01:44:12.613067 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m01:44:12.613606 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m01:44:12.613802 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:44:12.613992 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m01:44:12.614186 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m01:44:12.614457 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:44:12.614995 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m01:44:12.615175 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m01:44:12.620468 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m01:44:12.623346 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:44:12.623579 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m01:44:12.627729 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m01:44:12.628347 [debug] [Thread-2  ]: finished collecting timing info
[0m01:44:12.628496 [debug] [Thread-3  ]: finished collecting timing info
[0m01:44:12.628696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:44:12.629073 [debug] [Thread-4  ]: finished collecting timing info
[0m01:44:12.629238 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m01:44:12.629431 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:44:12.631426 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m01:44:12.670176 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:44:12.671416 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m01:44:12.673077 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m01:44:12.674149 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m01:44:12.674590 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m01:44:12.674894 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:44:12.675249 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m01:44:12.675432 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m01:44:12.675588 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:44:12.675782 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m01:44:12.675966 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:44:12.677967 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:44:13.600519 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.92 seconds
[0m01:44:13.602118 [debug] [Thread-3  ]: finished collecting timing info
[0m01:44:13.602253 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m01:44:13.697321 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.10s]
[0m01:44:13.697777 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m01:44:13.697971 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:44:13.698134 [info ] [Thread-3  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m01:44:13.698663 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:44:13.698809 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:44:13.698945 [debug] [Thread-3  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:44:13.703928 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:44:13.704257 [debug] [Thread-3  ]: finished collecting timing info
[0m01:44:13.704399 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:44:13.705884 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:44:13.706442 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m01:44:13.706554 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:44:13.706657 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:44:14.051791 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.35 seconds
[0m01:44:14.053047 [debug] [Thread-3  ]: finished collecting timing info
[0m01:44:14.053198 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m01:44:14.138216 [info ] [Thread-3  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.44s]
[0m01:44:14.138882 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m01:44:14.356904 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.68 seconds
[0m01:44:14.358021 [debug] [Thread-2  ]: finished collecting timing info
[0m01:44:14.358165 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m01:44:14.424547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.8 seconds
[0m01:44:14.425666 [debug] [Thread-1  ]: finished collecting timing info
[0m01:44:14.425805 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m01:44:14.450206 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.85s]
[0m01:44:14.450593 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m01:44:14.525247 [info ] [Thread-1  ]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.93s]
[0m01:44:14.525650 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m01:44:14.827649 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.15 seconds
[0m01:44:14.828738 [debug] [Thread-4  ]: finished collecting timing info
[0m01:44:14.828878 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m01:44:14.917189 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 2.31s]
[0m01:44:14.917639 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m01:44:14.918933 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m01:44:14.919205 [info ] [MainThread]: 
[0m01:44:14.919424 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m01:44:14.919618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:14.919717 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m01:44:14.919817 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m01:44:14.919922 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m01:44:14.920021 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m01:44:14.925394 [info ] [MainThread]: 
[0m01:44:14.925633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:44:14.925851 [info ] [MainThread]: 
[0m01:44:14.926029 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:44:14.926323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a36c77220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a36cffbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a641687f0>]}


============================== 2022-07-30 02:13:37.050812 | b2e3696a-7f12-4d26-9a42-2720257552ca ==============================
[0m02:13:37.050827 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:13:37.051168 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:13:37.051283 [debug] [MainThread]: Tracking: tracking
[0m02:13:37.051473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c7522b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c752310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c752370>]}
[0m02:13:37.067316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c64ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c64ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5c64a910>]}


============================== 2022-07-30 02:14:09.298824 | 4e451722-8581-4ce6-a7ed-7426184ff5af ==============================
[0m02:14:09.298842 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:14:09.299198 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:14:09.299311 [debug] [MainThread]: Tracking: tracking
[0m02:14:09.299503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d562310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d562370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d5623d0>]}
[0m02:14:09.321200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:14:09.321605 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m02:14:09.332291 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:14:09.383383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e451722-8581-4ce6-a7ed-7426184ff5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0c198c40>]}
[0m02:14:09.388221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e451722-8581-4ce6-a7ed-7426184ff5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d487220>]}
[0m02:14:09.388439 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:14:09.388639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e451722-8581-4ce6-a7ed-7426184ff5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d487430>]}
[0m02:14:09.389736 [info ] [MainThread]: 
[0m02:14:09.390075 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:14:09.390906 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:14:09.399590 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:14:09.399771 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:14:09.399867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:10.064485 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.66 seconds
[0m02:14:10.065977 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:14:10.158599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e451722-8581-4ce6-a7ed-7426184ff5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d45feb0>]}
[0m02:14:10.159093 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:14:10.159351 [info ] [MainThread]: 
[0m02:14:10.163070 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743
[0m02:14:10.163325 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:14:10.163542 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:14:10.163757 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:14:10.164003 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:14:10.164218 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:14:10.164801 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743"
[0m02:14:10.165048 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:14:10.165408 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:14:10.166179 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:14:10.166410 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743
[0m02:14:10.166921 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:14:10.167396 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:14:10.167628 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:14:10.167885 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743
[0m02:14:10.168124 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:14:10.168351 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:14:10.168572 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:14:10.173513 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743"
[0m02:14:10.173789 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:14:10.173954 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:14:10.180022 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:14:10.182773 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:14:10.186188 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:14:10.186562 [debug] [Thread-1  ]: finished collecting timing info
[0m02:14:10.187258 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743
[0m02:14:10.192762 [debug] [Thread-3  ]: finished collecting timing info
[0m02:14:10.193066 [debug] [Thread-2  ]: finished collecting timing info
[0m02:14:10.193237 [debug] [Thread-4  ]: finished collecting timing info
[0m02:14:10.198829 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:14:10.198105 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743"
[0m02:14:10.198622 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:14:10.198364 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:14:10.232665 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:14:10.234055 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:14:10.234656 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743"
[0m02:14:10.235938 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:14:10.236311 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt--break','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:14:10.237009 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:14:10.237329 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:14:10.237601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:10.237996 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:14:10.238176 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:14:10.238358 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:14:10.240050 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:14:10.240234 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:14:10.240430 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:14:10.240631 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:14:11.694729 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.45 seconds
[0m02:14:11.696641 [debug] [Thread-2  ]: finished collecting timing info
[0m02:14:11.696808 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:14:11.710090 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.47 seconds
[0m02:14:11.711305 [debug] [Thread-3  ]: finished collecting timing info
[0m02:14:11.711480 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:14:11.818400 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.65s]
[0m02:14:11.818812 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:14:11.818984 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:14:11.819122 [info ] [Thread-2  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:14:11.819454 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:14:11.819588 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:14:11.819725 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:14:11.824373 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:14:11.824792 [debug] [Thread-2  ]: finished collecting timing info
[0m02:14:11.824921 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:14:11.826297 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:14:11.826788 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:14:11.826896 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:14:11.826998 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:14:11.838345 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.6 seconds
[0m02:14:11.839439 [debug] [Thread-4  ]: finished collecting timing info
[0m02:14:11.839577 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:14:11.853001 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.69s]
[0m02:14:11.853375 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:14:11.888316 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.65 seconds
[0m02:14:11.889407 [debug] [Thread-1  ]: finished collecting timing info
[0m02:14:11.889557 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743: Close
[0m02:14:11.966819 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.80s]
[0m02:14:11.967234 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:14:12.052559 [error] [Thread-1  ]: 1 of 5 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room  [[31mFAIL 1[0m in 1.89s]
[0m02:14:12.053013 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743
[0m02:14:12.373749 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.55 seconds
[0m02:14:12.374898 [debug] [Thread-2  ]: finished collecting timing info
[0m02:14:12.375038 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:14:12.491771 [info ] [Thread-2  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.67s]
[0m02:14:12.492242 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:14:12.493678 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:14:12.494028 [info ] [MainThread]: 
[0m02:14:12.494294 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m02:14:12.494546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:12.494677 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room.a54637c743' was properly closed.
[0m02:14:12.494814 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:14:12.495037 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:14:12.495209 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:14:12.501533 [info ] [MainThread]: 
[0m02:14:12.501841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:14:12.502212 [info ] [MainThread]: 
[0m02:14:12.502487 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt_break__Private_room__Shared_room__Hotel_room (models/schema.yml)[0m
[0m02:14:12.502849 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:14:12.503060 [info ] [MainThread]: 
[0m02:14:12.503242 [info ] [MainThread]:   compiled SQL at target/compiled/dbtlearn/models/schema.yml/accepted_values_dim_listings_c_25b46ab02fbf2dfbf1a7ef6864a52e64.sql
[0m02:14:12.503431 [info ] [MainThread]: 
[0m02:14:12.503607 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m02:14:12.503887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d487400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d487310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb0d459d30>]}


============================== 2022-07-30 02:16:05.185431 | 5377177a-3a4c-4fbd-ab3a-61fb94e01f5b ==============================
[0m02:16:05.185454 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:16:05.185921 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:16:05.186040 [debug] [MainThread]: Tracking: tracking
[0m02:16:05.186262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd762310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd762370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd7623d0>]}
[0m02:16:05.208442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:16:05.208887 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m02:16:05.218639 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:16:05.267143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5377177a-3a4c-4fbd-ab3a-61fb94e01f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedc1e83a0>]}
[0m02:16:05.272145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5377177a-3a4c-4fbd-ab3a-61fb94e01f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd683220>]}
[0m02:16:05.272365 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:16:05.272571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5377177a-3a4c-4fbd-ab3a-61fb94e01f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd683430>]}
[0m02:16:05.273776 [info ] [MainThread]: 
[0m02:16:05.274141 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:16:05.275080 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:16:05.283360 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:16:05.283540 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:16:05.283646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:05.893903 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.61 seconds
[0m02:16:05.895307 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:16:05.987473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5377177a-3a4c-4fbd-ab3a-61fb94e01f5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd65aeb0>]}
[0m02:16:05.987891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:05.988104 [info ] [MainThread]: 
[0m02:16:05.991204 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0
[0m02:16:05.991385 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:05.991531 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:16:05.991713 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:05.991917 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:16:05.992041 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:05.992490 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0"
[0m02:16:05.992664 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:16:05.993060 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:05.993235 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:16:05.993441 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0
[0m02:16:05.993802 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:05.993955 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:05.994347 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:05.994527 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0
[0m02:16:05.994701 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:05.994841 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:05.995011 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:05.999386 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0"
[0m02:16:05.999633 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:06.005188 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:06.005925 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:06.008562 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:06.011980 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:06.012135 [debug] [Thread-1  ]: finished collecting timing info
[0m02:16:06.012828 [debug] [Thread-3  ]: finished collecting timing info
[0m02:16:06.013004 [debug] [Thread-4  ]: finished collecting timing info
[0m02:16:06.013223 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0
[0m02:16:06.013330 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:06.013521 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:06.013709 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:06.023752 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0"
[0m02:16:06.023936 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:06.058639 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:06.059848 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:06.061236 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:06.061771 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0"
[0m02:16:06.062310 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:06.062775 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:16:06.063159 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:16:06.063709 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:06.063913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:16:06.064245 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:06.064422 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:16:06.064624 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:16:06.066388 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:16:06.068111 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:16:06.068394 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:16:07.153931 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.09 seconds
[0m02:16:07.155553 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:07.155700 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:16:07.190262 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.12 seconds
[0m02:16:07.191351 [debug] [Thread-4  ]: finished collecting timing info
[0m02:16:07.191494 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:16:07.209813 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.15 seconds
[0m02:16:07.210928 [debug] [Thread-3  ]: finished collecting timing info
[0m02:16:07.211074 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:16:07.243301 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.25s]
[0m02:16:07.243692 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:07.243849 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:07.243980 [info ] [Thread-2  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:16:07.244314 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:07.244443 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:07.244569 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:07.249445 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:07.249924 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:07.250039 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:07.251618 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:07.252246 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:07.252372 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:16:07.252527 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:16:07.293742 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.30s]
[0m02:16:07.294121 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:07.302159 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.31s]
[0m02:16:07.302530 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:07.422195 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.36 seconds
[0m02:16:07.423342 [debug] [Thread-1  ]: finished collecting timing info
[0m02:16:07.423493 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0: Close
[0m02:16:07.519478 [error] [Thread-1  ]: 1 of 5 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room  [[31mFAIL 1[0m in 1.53s]
[0m02:16:07.519957 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0
[0m02:16:07.587143 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.33 seconds
[0m02:16:07.588284 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:07.588420 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:16:07.685278 [info ] [Thread-2  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.44s]
[0m02:16:07.685695 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:07.686998 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:16:07.687258 [info ] [MainThread]: 
[0m02:16:07.687459 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m02:16:07.687650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:07.687750 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room.f812384cc0' was properly closed.
[0m02:16:07.687849 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:16:07.687947 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:16:07.688043 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:16:07.692891 [info ] [MainThread]: 
[0m02:16:07.693146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:16:07.693343 [info ] [MainThread]: 
[0m02:16:07.693517 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_home__Private_room__Shared_room__Hotel_room (models/schema.yml)[0m
[0m02:16:07.693705 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:16:07.693889 [info ] [MainThread]: 
[0m02:16:07.694080 [info ] [MainThread]:   compiled SQL at target/compiled/dbtlearn/models/schema.yml/accepted_values_dim_listings_c_e8bf51c0be867c82f64900a9d8236df8.sql
[0m02:16:07.694258 [info ] [MainThread]: 
[0m02:16:07.694428 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m02:16:07.694671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd683400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd683310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd654d30>]}


============================== 2022-07-30 02:16:35.564987 | 89b34487-c8fd-4dec-ac52-4b1704a1a1c4 ==============================
[0m02:16:35.565008 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:16:35.565380 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:16:35.565497 [debug] [MainThread]: Tracking: tracking
[0m02:16:35.565706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704dd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704dd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704dd370>]}
[0m02:16:35.590001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:16:35.590433 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m02:16:35.599759 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:16:35.647345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b34487-c8fd-4dec-ac52-4b1704a1a1c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006d327550>]}
[0m02:16:35.651934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b34487-c8fd-4dec-ac52-4b1704a1a1c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f3c81f0>]}
[0m02:16:35.652132 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:16:35.652333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b34487-c8fd-4dec-ac52-4b1704a1a1c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f3c8400>]}
[0m02:16:35.653454 [info ] [MainThread]: 
[0m02:16:35.653773 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:16:35.654623 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:16:35.663042 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:16:35.663211 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:16:35.663317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:36.200736 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.54 seconds
[0m02:16:36.202182 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:16:36.306234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b34487-c8fd-4dec-ac52-4b1704a1a1c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f39ff70>]}
[0m02:16:36.306711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:36.306929 [info ] [MainThread]: 
[0m02:16:36.310118 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:16:36.310290 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:16:36.310676 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:16:36.310815 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:16:36.310956 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:16:36.315547 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:16:36.315920 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:36.316115 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:16:36.316583 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:36.316862 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:36.317026 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:36.317334 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:36.317591 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:16:36.317802 [debug] [Thread-1  ]: finished collecting timing info
[0m02:16:36.317988 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:36.318191 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:16:36.318551 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:16:36.318986 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:36.325399 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:36.325861 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:36.336582 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:36.337320 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:16:36.337719 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:36.337993 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:36.338183 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:36.338564 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:36.339066 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:16:36.341769 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:36.342008 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:36.346236 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:36.346494 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:16:36.381828 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:36.382441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:16:36.383028 [debug] [Thread-3  ]: finished collecting timing info
[0m02:16:36.385546 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:36.383174 [debug] [Thread-4  ]: finished collecting timing info
[0m02:16:36.384286 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:16:36.386973 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:36.387164 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:36.387352 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:16:36.388713 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:36.389214 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:16:36.389402 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:16:36.389704 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:16:36.390360 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:16:36.392037 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:16:36.392202 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:16:36.392938 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:16:37.370833 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.98 seconds
[0m02:16:37.372488 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:37.372628 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:16:37.466184 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.15s]
[0m02:16:37.466566 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:16:37.466724 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:37.466853 [info ] [Thread-2  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:16:37.467176 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:37.467306 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:37.467431 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:37.472226 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:37.475356 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.09 seconds
[0m02:16:37.476754 [debug] [Thread-1  ]: finished collecting timing info
[0m02:16:37.476910 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:16:37.478627 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:37.478780 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:37.480298 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:37.480793 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:16:37.480898 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:16:37.480998 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:16:37.538530 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.15 seconds
[0m02:16:37.539616 [debug] [Thread-3  ]: finished collecting timing info
[0m02:16:37.539769 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:16:37.552419 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.16 seconds
[0m02:16:37.558710 [debug] [Thread-4  ]: finished collecting timing info
[0m02:16:37.558870 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:16:37.598347 [info ] [Thread-1  ]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.29s]
[0m02:16:37.604047 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:16:37.648837 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.33s]
[0m02:16:37.649302 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:16:37.658816 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 1.33s]
[0m02:16:37.659269 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:16:38.005211 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m02:16:38.006529 [debug] [Thread-2  ]: finished collecting timing info
[0m02:16:38.006691 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:16:38.098783 [info ] [Thread-2  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.63s]
[0m02:16:38.099176 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:16:38.100661 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:16:38.100985 [info ] [MainThread]: 
[0m02:16:38.101202 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m02:16:38.101416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:38.101519 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m02:16:38.101620 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:16:38.101720 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:16:38.101818 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:16:38.107125 [info ] [MainThread]: 
[0m02:16:38.107359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:16:38.107575 [info ] [MainThread]: 
[0m02:16:38.107750 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m02:16:38.107995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f3c83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f3c82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006f399d00>]}


============================== 2022-07-30 02:20:39.362064 | e25d43d3-0c29-4dfd-acc0-d9014487f29b ==============================
[0m02:20:39.362083 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:20:39.362445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:20:39.362566 [debug] [MainThread]: Tracking: tracking
[0m02:20:39.362772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524d9e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524d9e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524d9e460>]}
[0m02:20:39.386662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:20:39.386972 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m02:20:39.414144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e25d43d3-0c29-4dfd-acc0-d9014487f29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524c34790>]}
[0m02:20:39.419185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e25d43d3-0c29-4dfd-acc0-d9014487f29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524ca0d90>]}
[0m02:20:39.419422 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:20:39.419643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e25d43d3-0c29-4dfd-acc0-d9014487f29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524ca0d60>]}
[0m02:20:39.420843 [info ] [MainThread]: 
[0m02:20:39.421188 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:20:39.422033 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:20:39.431328 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:20:39.431582 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:20:39.431707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:40.034830 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.6 seconds
[0m02:20:40.036554 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:20:40.136154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e25d43d3-0c29-4dfd-acc0-d9014487f29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524ca0ac0>]}
[0m02:20:40.136565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:20:40.136779 [info ] [MainThread]: 
[0m02:20:40.140258 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:20:40.140415 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:20:40.140770 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:20:40.140900 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:20:40.141039 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:20:40.146448 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:20:40.151141 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:20:40.151389 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:20:40.151588 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:20:40.151766 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:20:40.152100 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:20:40.152625 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:20:40.152831 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:20:40.153252 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:20:40.153455 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:20:40.153651 [debug] [Thread-1  ]: finished collecting timing info
[0m02:20:40.154039 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:20:40.154224 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:20:40.154415 [debug] [Thread-2  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:20:40.154614 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:20:40.154785 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:20:40.154981 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:20:40.156731 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:20:40.162199 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:20:40.168173 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:20:40.172871 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:20:40.175479 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:20:40.177086 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:20:40.177240 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:20:40.177512 [debug] [Thread-2  ]: finished collecting timing info
[0m02:20:40.177659 [debug] [Thread-3  ]: finished collecting timing info
[0m02:20:40.177815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:40.177987 [debug] [Thread-4  ]: finished collecting timing info
[0m02:20:40.178198 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:20:40.178394 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:20:40.180286 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:20:40.181767 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:20:40.183755 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:20:40.185202 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:20:40.185849 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:20:40.186445 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:20:40.186697 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:20:40.187642 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:20:40.188830 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:20:40.188955 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:20:40.189763 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:20:40.191669 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:20:40.191798 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:20:41.093644 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.92 seconds
[0m02:20:41.095250 [debug] [Thread-1  ]: finished collecting timing info
[0m02:20:41.095386 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:20:41.188480 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:20:41.189645 [debug] [Thread-4  ]: finished collecting timing info
[0m02:20:41.190282 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:20:41.192353 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:20:41.193417 [debug] [Thread-3  ]: finished collecting timing info
[0m02:20:41.193557 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:20:41.195315 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.05s]
[0m02:20:41.195647 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:20:41.195809 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:20:41.195940 [info ] [Thread-1  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:20:41.196248 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:20:41.196372 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:20:41.196495 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:20:41.202089 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:20:41.202496 [debug] [Thread-1  ]: finished collecting timing info
[0m02:20:41.202625 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:20:41.204023 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:20:41.204596 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:20:41.204703 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:20:41.204802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:41.300210 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.15s]
[0m02:20:41.311284 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.16s]
[0m02:20:41.311685 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:20:41.317347 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:20:41.322960 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:20:41.344099 [info ] [Thread-4  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:20:41.344535 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:20:41.344670 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:20:41.344801 [debug] [Thread-4  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:20:41.349149 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:20:41.359814 [debug] [Thread-4  ]: finished collecting timing info
[0m02:20:41.368061 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:20:41.371047 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:20:41.372566 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:20:41.372704 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:20:41.372824 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:20:41.436940 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.25 seconds
[0m02:20:41.438085 [debug] [Thread-2  ]: finished collecting timing info
[0m02:20:41.438223 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:20:41.544407 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.39s]
[0m02:20:41.547907 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:20:41.579375 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.37 seconds
[0m02:20:41.580470 [debug] [Thread-1  ]: finished collecting timing info
[0m02:20:41.580607 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:20:41.677777 [info ] [Thread-1  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.48s]
[0m02:20:41.678199 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:20:41.746553 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.37 seconds
[0m02:20:41.754254 [debug] [Thread-4  ]: finished collecting timing info
[0m02:20:41.756225 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:20:41.851386 [info ] [Thread-4  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.51s]
[0m02:20:41.851780 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:20:41.852982 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:20:41.853250 [info ] [MainThread]: 
[0m02:20:41.853454 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m02:20:41.853639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:41.853735 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:20:41.853831 [debug] [MainThread]: Connection 'test.dbtlearn.dim_listings_minimum_nights' was properly closed.
[0m02:20:41.853908 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m02:20:41.853995 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:20:41.858808 [info ] [MainThread]: 
[0m02:20:41.859022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:41.859236 [info ] [MainThread]: 
[0m02:20:41.859417 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:20:41.859667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524c99df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f451fda51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f451fda5310>]}


============================== 2022-07-30 02:22:55.664628 | 67383714-59fe-4fbf-9bf6-4bd8f9560b3c ==============================
[0m02:22:55.664646 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:22:55.665031 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m02:22:55.665154 [debug] [MainThread]: Tracking: tracking
[0m02:22:55.665365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db4519340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db45193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db4519400>]}
[0m02:22:55.686950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:22:55.687122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:22:55.691496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67383714-59fe-4fbf-9bf6-4bd8f9560b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db3381820>]}
[0m02:22:55.696624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67383714-59fe-4fbf-9bf6-4bd8f9560b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db448b610>]}
[0m02:22:55.696865 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:22:55.697080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67383714-59fe-4fbf-9bf6-4bd8f9560b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db448b940>]}
[0m02:22:55.698223 [info ] [MainThread]: 
[0m02:22:55.698606 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:22:55.699520 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:22:55.711963 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:22:55.712306 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:22:55.712489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:56.353339 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.64 seconds
[0m02:22:56.354806 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:22:56.454697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67383714-59fe-4fbf-9bf6-4bd8f9560b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db448b130>]}
[0m02:22:56.455117 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:22:56.455325 [info ] [MainThread]: 
[0m02:22:56.458680 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:22:56.458845 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:22:56.459211 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:22:56.459350 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:22:56.459485 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:22:56.464874 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:22:56.470619 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:22:56.470827 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:22:56.471121 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:22:56.471274 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:22:56.471482 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:22:56.471930 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:22:56.472206 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:22:56.472670 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:22:56.472869 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:22:56.473084 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:56.473465 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:22:56.473642 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:22:56.473830 [debug] [Thread-2  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:22:56.474031 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:22:56.474202 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:22:56.474381 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:22:56.476127 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:22:56.481684 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:22:56.489881 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:22:56.494474 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:22:56.497146 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:22:56.497396 [debug] [Thread-2  ]: finished collecting timing info
[0m02:22:56.498392 [debug] [Thread-3  ]: finished collecting timing info
[0m02:22:56.498654 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:22:56.499145 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:22:56.499353 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:22:56.501180 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:22:56.501322 [debug] [Thread-4  ]: finished collecting timing info
[0m02:22:56.501529 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:22:56.503543 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:22:56.503829 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:22:56.504233 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:22:56.504408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:22:56.505819 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:22:56.506145 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:22:56.506317 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:22:56.508266 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:22:56.508625 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:22:56.509326 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:22:56.509581 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:22:56.510343 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:22:56.513002 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:22:57.538355 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.03 seconds
[0m02:22:57.540165 [debug] [Thread-4  ]: finished collecting timing info
[0m02:22:57.540333 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:22:57.624870 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.15s]
[0m02:22:57.625254 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:22:57.625423 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:22:57.625555 [info ] [Thread-4  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:22:57.625875 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:22:57.626002 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:22:57.626128 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:22:57.632424 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:22:57.632778 [debug] [Thread-4  ]: finished collecting timing info
[0m02:22:57.632915 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:22:57.634351 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:22:57.635010 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:22:57.635120 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:22:57.635220 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:22:57.752082 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.25 seconds
[0m02:22:57.758396 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:57.763823 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:22:57.776220 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.27 seconds
[0m02:22:57.792071 [debug] [Thread-3  ]: finished collecting timing info
[0m02:22:57.794809 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:22:57.796858 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.29 seconds
[0m02:22:57.797780 [debug] [Thread-2  ]: finished collecting timing info
[0m02:22:57.797921 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:22:57.872525 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.41s]
[0m02:22:57.872892 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:22:57.873085 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:22:57.873215 [info ] [Thread-1  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:22:57.873543 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:22:57.873670 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:22:57.873799 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:22:57.878545 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:22:57.879407 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:57.879601 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:22:57.882771 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:22:57.883434 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:22:57.883556 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:22:57.883661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:22:57.887891 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.42s]
[0m02:22:57.888238 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:22:57.893284 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.42s]
[0m02:22:57.893639 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:22:58.145413 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m02:22:58.146567 [debug] [Thread-4  ]: finished collecting timing info
[0m02:22:58.146705 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:22:58.232912 [info ] [Thread-4  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.61s]
[0m02:22:58.233301 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:22:58.261844 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.38 seconds
[0m02:22:58.262969 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:58.263108 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:22:58.351999 [info ] [Thread-1  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.48s]
[0m02:22:58.352364 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:22:58.353591 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:22:58.353833 [info ] [MainThread]: 
[0m02:22:58.354045 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m02:22:58.354232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:58.354328 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:22:58.354423 [debug] [MainThread]: Connection 'test.dbtlearn.dim_listings_minimum_nights' was properly closed.
[0m02:22:58.354516 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m02:22:58.354615 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:22:58.359896 [info ] [MainThread]: 
[0m02:22:58.360156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:22:58.360377 [info ] [MainThread]: 
[0m02:22:58.360557 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:22:58.360813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db24e6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db25b5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db25b5c40>]}


============================== 2022-07-30 02:37:00.370319 | c61b8c03-b72f-47a7-ac70-b80857f3763c ==============================
[0m02:37:00.370334 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:37:00.370663 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed', 'fct_reviews'], 'which': 'test', 'rpc_method': 'test'}
[0m02:37:00.370776 [debug] [MainThread]: Tracking: tracking
[0m02:37:00.370966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e799b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e799b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e799b490>]}
[0m02:37:00.392842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:37:00.393187 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/consistent_created_at.sql
[0m02:37:00.415821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c61b8c03-b72f-47a7-ac70-b80857f3763c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e782fcd0>]}
[0m02:37:00.420756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c61b8c03-b72f-47a7-ac70-b80857f3763c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e789bf10>]}
[0m02:37:00.420979 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:37:00.421175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c61b8c03-b72f-47a7-ac70-b80857f3763c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e789be20>]}
[0m02:37:00.422284 [info ] [MainThread]: 
[0m02:37:00.422608 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:37:00.423463 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:37:00.432194 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:37:00.432371 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:37:00.432477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:01.043874 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.61 seconds
[0m02:37:01.045274 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:37:01.137690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c61b8c03-b72f-47a7-ac70-b80857f3763c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e789bc10>]}
[0m02:37:01.138137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:37:01.138359 [info ] [MainThread]: 
[0m02:37:01.142017 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:01.142196 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:37:01.142585 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:01.142722 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:01.142870 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:01.148242 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:01.153170 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:01.153381 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:01.153541 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:37:01.153700 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:01.154022 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:37:01.154536 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:01.154732 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:37:01.154924 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:01.155316 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:01.155505 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:01.155919 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:01.156138 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:01.156316 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:01.156557 [debug] [Thread-2  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:37:01.156720 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:01.167382 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:01.167921 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:01.169748 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:01.170007 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:01.174815 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:01.175695 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:01.175910 [debug] [Thread-2  ]: finished collecting timing info
[0m02:37:01.178484 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:01.178899 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:37:01.179038 [debug] [Thread-3  ]: finished collecting timing info
[0m02:37:01.179230 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:01.179525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:37:01.179744 [debug] [Thread-4  ]: finished collecting timing info
[0m02:37:01.179909 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:01.181181 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:01.183054 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:01.184333 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:01.186087 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:01.186497 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:01.187240 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:01.187482 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:37:01.187843 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:01.188059 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:37:01.188252 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:37:01.188444 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:37:01.188626 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:37:01.189479 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:37:02.195639 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.02 seconds
[0m02:37:02.197263 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:02.197399 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:37:02.199193 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.01 seconds
[0m02:37:02.200037 [debug] [Thread-2  ]: finished collecting timing info
[0m02:37:02.200255 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:37:02.287955 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.15s]
[0m02:37:02.288359 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:02.288531 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:02.288672 [info ] [Thread-1  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:37:02.289011 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:02.289148 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:02.289282 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:02.295277 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:02.296390 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:02.296528 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:02.297943 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:02.298520 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.14s]
[0m02:37:02.298861 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:02.299040 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:02.299319 [info ] [Thread-2  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:37:02.299707 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:02.299946 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:02.300193 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:02.304626 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:02.305292 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:02.305436 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:37:02.305564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:37:02.307364 [debug] [Thread-2  ]: finished collecting timing info
[0m02:37:02.307507 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:02.308940 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:02.309576 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:02.309687 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:37:02.309786 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:37:02.344772 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.16 seconds
[0m02:37:02.345898 [debug] [Thread-3  ]: finished collecting timing info
[0m02:37:02.346032 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:37:02.354013 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.16 seconds
[0m02:37:02.355193 [debug] [Thread-4  ]: finished collecting timing info
[0m02:37:02.355353 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:37:02.468688 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.31s]
[0m02:37:02.469243 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:02.509926 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.35s]
[0m02:37:02.517682 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:02.788813 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.48 seconds
[0m02:37:02.791159 [debug] [Thread-2  ]: finished collecting timing info
[0m02:37:02.791462 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:37:02.819205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m02:37:02.821578 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:02.821898 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:37:02.894428 [info ] [Thread-2  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.59s]
[0m02:37:02.895069 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:02.917000 [info ] [Thread-1  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.63s]
[0m02:37:02.917364 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:02.918739 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:37:02.919102 [info ] [MainThread]: 
[0m02:37:02.919367 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m02:37:02.919560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:02.919656 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:37:02.919751 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:37:02.919844 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m02:37:02.919936 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:37:02.925458 [info ] [MainThread]: 
[0m02:37:02.925684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:37:02.925894 [info ] [MainThread]: 
[0m02:37:02.926066 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:37:02.926310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e784dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e784de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e784de80>]}


============================== 2022-07-30 02:37:43.504639 | 81f23dba-4070-4ec5-81a9-565a03ef39f2 ==============================
[0m02:37:43.504657 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:37:43.505048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:37:43.505166 [debug] [MainThread]: Tracking: tracking
[0m02:37:43.505371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5766a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5766a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5766a310>]}
[0m02:37:43.527637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:37:43.527804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:37:43.532039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81f23dba-4070-4ec5-81a9-565a03ef39f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c564c1ac0>]}
[0m02:37:43.537151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81f23dba-4070-4ec5-81a9-565a03ef39f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5659cac0>]}
[0m02:37:43.537346 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:37:43.537548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81f23dba-4070-4ec5-81a9-565a03ef39f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5659cbb0>]}
[0m02:37:43.538859 [info ] [MainThread]: 
[0m02:37:43.539242 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:37:43.540125 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:37:43.548762 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:37:43.548920 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:37:43.549023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:44.146890 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.6 seconds
[0m02:37:44.148845 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:37:44.242456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81f23dba-4070-4ec5-81a9-565a03ef39f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5659c610>]}
[0m02:37:44.242861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:37:44.243082 [info ] [MainThread]: 
[0m02:37:44.246252 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:44.246422 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:37:44.246793 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:44.246930 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:44.247070 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:44.247229 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m02:37:44.252804 [info ] [Thread-2  ]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m02:37:44.253344 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m02:37:44.253612 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m02:37:44.259000 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:44.260109 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:44.260276 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m02:37:44.260434 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:44.260655 [info ] [Thread-3  ]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:37:44.261843 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m02:37:44.262098 [info ] [Thread-4  ]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:37:44.262300 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:44.262682 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:44.263200 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:44.263413 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:44.263547 [debug] [Thread-2  ]: finished collecting timing info
[0m02:37:44.263732 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:44.263920 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:44.274667 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m02:37:44.275824 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:44.276072 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:37:44.276252 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:44.277776 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m02:37:44.279478 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:44.283824 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:44.284310 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:37:44.285135 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m02:37:44.285439 [debug] [Thread-3  ]: finished collecting timing info
[0m02:37:44.285668 [debug] [Thread-4  ]: finished collecting timing info
[0m02:37:44.285815 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:37:44.285994 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select f.review_date < d.created_at
from "AIRBNB"."DEV"."FCT_REVIEWS" f
left join "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" d
on f.listing_id = d.listing_id
      
    ) dbt_internal_test
[0m02:37:44.286187 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:44.286366 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:44.286549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:37:44.286729 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:37:44.288745 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:44.290124 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:44.294310 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:37:44.294525 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:37:44.294774 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:37:44.296527 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:37:44.296643 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:37:44.296742 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:37:45.216448 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.92 seconds
[0m02:37:45.218070 [debug] [Thread-4  ]: finished collecting timing info
[0m02:37:45.218206 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:37:45.299157 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
[0m02:37:45.300335 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:45.300488 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:37:45.311605 [info ] [Thread-4  ]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.05s]
[0m02:37:45.312025 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:37:45.312203 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:45.312350 [info ] [Thread-4  ]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:37:45.312705 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:45.312850 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:45.313005 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:45.316400 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:45.316733 [debug] [Thread-4  ]: finished collecting timing info
[0m02:37:45.316868 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:45.318361 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:45.318859 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:37:45.318981 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:37:45.319097 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:37:45.366278 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.07 seconds
[0m02:37:45.367375 [debug] [Thread-3  ]: finished collecting timing info
[0m02:37:45.367516 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:37:45.397852 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.15s]
[0m02:37:45.408617 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:37:45.414095 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:45.419502 [info ] [Thread-1  ]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:37:45.430581 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:45.435934 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:45.436087 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:45.447185 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:45.468245 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:45.469156 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:45.483768 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:45.487485 [info ] [Thread-3  ]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.22s]
[0m02:37:45.488032 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:37:45.488362 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:45.489117 [info ] [Thread-3  ]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:37:45.489733 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:45.494028 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:37:45.494720 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:45.495447 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:37:45.495744 [debug] [Thread-3  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:45.496947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:37:45.501982 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:45.508667 [debug] [Thread-3  ]: finished collecting timing info
[0m02:37:45.509291 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:45.511185 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:45.512975 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:37:45.513214 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:37:45.513878 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:37:45.551910 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.27 seconds
[0m02:37:45.554164 [debug] [Thread-2  ]: finished collecting timing info
[0m02:37:45.554310 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m02:37:45.679455 [error] [Thread-2  ]: 2 of 7 FAIL 409698 consistent_created_at ....................................... [[31mFAIL 409698[0m in 1.43s]
[0m02:37:45.690375 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m02:37:45.717494 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.4 seconds
[0m02:37:45.729012 [debug] [Thread-4  ]: finished collecting timing info
[0m02:37:45.739558 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:37:45.852568 [info ] [Thread-4  ]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.54s]
[0m02:37:45.852975 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:37:45.982901 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m02:37:45.984074 [debug] [Thread-3  ]: finished collecting timing info
[0m02:37:45.984219 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:37:46.030317 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
[0m02:37:46.031419 [debug] [Thread-1  ]: finished collecting timing info
[0m02:37:46.031554 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:37:46.071126 [info ] [Thread-3  ]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.58s]
[0m02:37:46.071481 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:37:46.126915 [info ] [Thread-1  ]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.70s]
[0m02:37:46.127288 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:37:46.128741 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:37:46.129005 [info ] [MainThread]: 
[0m02:37:46.129203 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m02:37:46.129388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:46.129483 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:37:46.129583 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m02:37:46.129677 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:37:46.129770 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:37:46.134739 [info ] [MainThread]: 
[0m02:37:46.134975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:37:46.135182 [info ] [MainThread]: 
[0m02:37:46.135373 [error] [MainThread]: [31mFailure in test consistent_created_at (tests/consistent_created_at.sql)[0m
[0m02:37:46.135565 [error] [MainThread]:   Got 409698 results, configured to fail if != 0
[0m02:37:46.135748 [info ] [MainThread]: 
[0m02:37:46.135947 [info ] [MainThread]:   compiled SQL at target/compiled/dbtlearn/tests/consistent_created_at.sql
[0m02:37:46.136136 [info ] [MainThread]: 
[0m02:37:46.136314 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m02:37:46.136581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c55568160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c556dc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c556dc160>]}


============================== 2022-07-30 02:40:01.090774 | 382e0e3a-1b26-4261-8786-791266b0d10b ==============================
[0m02:40:01.090792 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:40:01.091135 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:40:01.091248 [debug] [MainThread]: Tracking: tracking
[0m02:40:01.091441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a566310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a566370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a5663d0>]}
[0m02:40:01.114449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:40:01.114791 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/consistent_created_at.sql
[0m02:40:01.126080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a4690d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a420100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a420640>]}


============================== 2022-07-30 02:42:37.449171 | b361167d-e935-4521-9245-efcd241e315b ==============================
[0m02:42:37.449189 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:42:37.449566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:42:37.449682 [debug] [MainThread]: Tracking: tracking
[0m02:42:37.449875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d4ff3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d4ff430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d4ff490>]}
[0m02:42:37.475433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:42:37.475765 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/consistent_created_at.sql
[0m02:42:37.492791 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtlearn.consistent_created_at' (tests/consistent_created_at.sql) depends on a node named 'DIM_LISTINGS_CLEANSED' which was not found
[0m02:42:37.499828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b361167d-e935-4521-9245-efcd241e315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518c333eb0>]}
[0m02:42:37.504957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b361167d-e935-4521-9245-efcd241e315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d43da60>]}
[0m02:42:37.505222 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:42:37.505425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b361167d-e935-4521-9245-efcd241e315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518c3c8790>]}
[0m02:42:37.506606 [info ] [MainThread]: 
[0m02:42:37.506945 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:42:37.507852 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:42:37.517052 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:42:37.517245 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:42:37.517334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:38.081260 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.56 seconds
[0m02:42:38.082844 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:42:38.191470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b361167d-e935-4521-9245-efcd241e315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d43daf0>]}
[0m02:42:38.192214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:42:38.192628 [info ] [MainThread]: 
[0m02:42:38.198257 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:42:38.198479 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:42:38.198660 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:42:38.198839 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:42:38.199052 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:42:38.199203 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:42:38.199669 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:42:38.199862 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:42:38.200278 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:42:38.200441 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:42:38.200655 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:42:38.201046 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:42:38.201234 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:42:38.201636 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:42:38.201848 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:42:38.202033 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:42:38.202330 [debug] [Thread-2  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:42:38.202515 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:42:38.212385 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:42:38.212628 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:42:38.214539 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:42:38.214807 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:42:38.220744 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:42:38.223536 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:42:38.223733 [debug] [Thread-1  ]: finished collecting timing info
[0m02:42:38.224223 [debug] [Thread-3  ]: finished collecting timing info
[0m02:42:38.224650 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:42:38.224786 [debug] [Thread-2  ]: finished collecting timing info
[0m02:42:38.225133 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:42:38.225327 [debug] [Thread-4  ]: finished collecting timing info
[0m02:42:38.235555 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:42:38.235779 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:42:38.237195 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:42:38.237395 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:42:38.238873 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:42:38.239384 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:42:38.240771 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:42:38.241467 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:42:38.241843 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:42:38.242002 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:42:38.242267 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:42:38.242701 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:42:38.242849 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:42:38.243031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:42:38.243228 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:42:38.243378 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:42:38.243569 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:42:38.248586 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:42:39.231523 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.99 seconds
[0m02:42:39.233162 [debug] [Thread-3  ]: finished collecting timing info
[0m02:42:39.233300 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:42:39.265124 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.02 seconds
[0m02:42:39.266354 [debug] [Thread-1  ]: finished collecting timing info
[0m02:42:39.266504 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:42:39.325623 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.12s]
[0m02:42:39.326030 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:42:39.326197 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:42:39.326330 [info ] [Thread-3  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:42:39.326659 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:42:39.326790 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:42:39.326920 [debug] [Thread-3  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:42:39.334838 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:42:39.335189 [debug] [Thread-3  ]: finished collecting timing info
[0m02:42:39.335330 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:42:39.337136 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:42:39.337838 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:42:39.337953 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:42:39.338109 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:42:39.357351 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.16s]
[0m02:42:39.357719 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:42:39.357884 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:42:39.358013 [info ] [Thread-1  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:42:39.358329 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:42:39.358459 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:42:39.358698 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:42:39.363317 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:42:39.363908 [debug] [Thread-1  ]: finished collecting timing info
[0m02:42:39.364163 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:42:39.366241 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:42:39.368491 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:42:39.368638 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:42:39.368749 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:42:39.451058 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.21 seconds
[0m02:42:39.463020 [debug] [Thread-2  ]: finished collecting timing info
[0m02:42:39.468499 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:42:39.512982 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.26 seconds
[0m02:42:39.543227 [debug] [Thread-4  ]: finished collecting timing info
[0m02:42:39.543550 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:42:39.616275 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.42s]
[0m02:42:39.616987 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:42:39.647008 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.45s]
[0m02:42:39.653296 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:42:39.819357 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.45 seconds
[0m02:42:39.820608 [debug] [Thread-1  ]: finished collecting timing info
[0m02:42:39.820774 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:42:39.832533 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m02:42:39.833850 [debug] [Thread-3  ]: finished collecting timing info
[0m02:42:39.834013 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:42:39.914634 [info ] [Thread-1  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.56s]
[0m02:42:39.915111 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:42:39.915594 [info ] [Thread-3  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.59s]
[0m02:42:39.915896 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:42:39.917021 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:42:39.917297 [info ] [MainThread]: 
[0m02:42:39.917487 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m02:42:39.917666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:39.917760 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:42:39.917851 [debug] [MainThread]: Connection 'test.dbtlearn.dim_listings_minimum_nights' was properly closed.
[0m02:42:39.917941 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:42:39.918031 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:42:39.923457 [info ] [MainThread]: 
[0m02:42:39.923687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:39.923900 [info ] [MainThread]: 
[0m02:42:39.924079 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:42:39.924332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518c3c8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518c3c87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518c3c8730>]}


============================== 2022-07-30 02:43:22.758466 | 927a775b-5ada-4bc6-a3af-5d17440a8986 ==============================
[0m02:43:22.758481 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:43:22.758819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:43:22.758936 [debug] [MainThread]: Tracking: tracking
[0m02:43:22.759122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef9dc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef9dc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef9dc460>]}
[0m02:43:22.782441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:43:22.782844 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/consistent_created_at.sql
[0m02:43:22.800028 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbtlearn.consistent_created_at' (tests/consistent_created_at.sql) depends on a node named 'DIM_LISTINGS_CLEANSED' which was not found
[0m02:43:22.807453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '927a775b-5ada-4bc6-a3af-5d17440a8986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef874eb0>]}
[0m02:43:22.812406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '927a775b-5ada-4bc6-a3af-5d17440a8986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef959e50>]}
[0m02:43:22.812612 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:43:22.812815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '927a775b-5ada-4bc6-a3af-5d17440a8986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef908760>]}
[0m02:43:22.814008 [info ] [MainThread]: 
[0m02:43:22.814343 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:43:22.815209 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:43:22.824292 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:43:22.824459 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:43:22.824562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:23.375072 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.55 seconds
[0m02:43:23.376540 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:43:23.676185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '927a775b-5ada-4bc6-a3af-5d17440a8986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef959a60>]}
[0m02:43:23.676760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:43:23.677075 [info ] [MainThread]: 
[0m02:43:23.682544 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:43:23.682826 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:43:23.683157 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:43:23.683401 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:43:23.683635 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:43:23.683985 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:43:23.684238 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:43:23.684912 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:43:23.685191 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:43:23.685769 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:43:23.686465 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:43:23.686741 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:43:23.687378 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:43:23.687669 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:43:23.687978 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:43:23.688256 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:43:23.688523 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:43:23.688947 [debug] [Thread-2  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:43:23.689217 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:43:23.700197 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:43:23.702076 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:43:23.704338 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:43:23.711635 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:43:23.714688 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:43:23.716201 [debug] [Thread-3  ]: finished collecting timing info
[0m02:43:23.716671 [debug] [Thread-2  ]: finished collecting timing info
[0m02:43:23.717042 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:43:23.717187 [debug] [Thread-4  ]: finished collecting timing info
[0m02:43:23.717469 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:43:23.717753 [debug] [Thread-1  ]: finished collecting timing info
[0m02:43:23.728356 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:43:23.728499 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:43:23.729867 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:43:23.730063 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:43:23.731258 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:43:23.732061 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:43:23.732439 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:43:23.733632 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:43:23.734040 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:43:23.734408 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:43:23.734603 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:43:23.735011 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:43:23.735247 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:43:23.735520 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:43:23.736041 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:43:23.736959 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:43:23.739575 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:43:23.742374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:24.662642 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m02:43:24.664350 [debug] [Thread-3  ]: finished collecting timing info
[0m02:43:24.664502 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:43:24.755697 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 1.07s]
[0m02:43:24.756085 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:43:24.756253 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:43:24.756385 [info ] [Thread-3  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:43:24.756706 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:43:24.756836 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:43:24.756963 [debug] [Thread-3  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:43:24.762741 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:43:24.763026 [debug] [Thread-3  ]: finished collecting timing info
[0m02:43:24.763149 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:43:24.764451 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:43:24.765014 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:43:24.765118 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:43:24.765218 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:43:24.791512 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
[0m02:43:24.792638 [debug] [Thread-1  ]: finished collecting timing info
[0m02:43:24.792777 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:43:24.819725 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.08 seconds
[0m02:43:24.821377 [debug] [Thread-2  ]: finished collecting timing info
[0m02:43:24.821552 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:43:24.898900 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.16 seconds
[0m02:43:24.905308 [debug] [Thread-4  ]: finished collecting timing info
[0m02:43:24.906019 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.22s]
[0m02:43:24.906205 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:43:24.922227 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:43:24.926384 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:43:24.927366 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.24s]
[0m02:43:24.928435 [info ] [Thread-1  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:43:24.928998 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:43:24.930034 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:43:24.934717 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:43:24.935212 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:43:24.939891 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:43:24.940542 [debug] [Thread-1  ]: finished collecting timing info
[0m02:43:24.940702 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:43:24.942176 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:43:24.942914 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:43:24.943891 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:43:24.944045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:25.034379 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.35s]
[0m02:43:25.040124 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:43:25.141406 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.38 seconds
[0m02:43:25.142554 [debug] [Thread-3  ]: finished collecting timing info
[0m02:43:25.142709 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:43:25.239967 [info ] [Thread-3  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.48s]
[0m02:43:25.240346 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:43:25.296355 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.35 seconds
[0m02:43:25.297476 [debug] [Thread-1  ]: finished collecting timing info
[0m02:43:25.297613 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:43:25.394534 [info ] [Thread-1  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.46s]
[0m02:43:25.394952 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:43:25.396195 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:43:25.396470 [info ] [MainThread]: 
[0m02:43:25.396704 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m02:43:25.396932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:25.397042 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:43:25.397152 [debug] [MainThread]: Connection 'test.dbtlearn.dim_listings_minimum_nights' was properly closed.
[0m02:43:25.397265 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:43:25.397373 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:43:25.403384 [info ] [MainThread]: 
[0m02:43:25.403653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:25.403952 [info ] [MainThread]: 
[0m02:43:25.404175 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:43:25.404477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef9086d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef9087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bef908700>]}


============================== 2022-07-30 02:44:17.560561 | eb65fe4b-f820-4fa7-a6fc-1a14a5a9a56a ==============================
[0m02:44:17.560577 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:44:17.560920 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m02:44:17.561034 [debug] [MainThread]: Tracking: tracking
[0m02:44:17.561308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1214c25250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1214c252b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1214c25310>]}
[0m02:44:17.585996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:44:17.586343 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/consistent_created_at.sql
[0m02:44:17.610470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb65fe4b-f820-4fa7-a6fc-1a14a5a9a56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213aafd00>]}
[0m02:44:17.615774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb65fe4b-f820-4fa7-a6fc-1a14a5a9a56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213b1cd60>]}
[0m02:44:17.616005 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 267 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:44:17.616207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb65fe4b-f820-4fa7-a6fc-1a14a5a9a56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213b45640>]}
[0m02:44:17.617432 [info ] [MainThread]: 
[0m02:44:17.617800 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:44:17.618679 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:44:17.627482 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:44:17.627676 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:44:17.627770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:18.226193 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.6 seconds
[0m02:44:18.227688 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:44:18.713457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb65fe4b-f820-4fa7-a6fc-1a14a5a9a56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213b976a0>]}
[0m02:44:18.713929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:44:18.714153 [info ] [MainThread]: 
[0m02:44:18.718052 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:44:18.718278 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m02:44:18.718458 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:44:18.718640 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:44:18.718848 [info ] [Thread-2  ]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m02:44:18.718998 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:44:18.719461 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:44:18.719645 [info ] [Thread-3  ]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:44:18.720070 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m02:44:18.720263 [info ] [Thread-4  ]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:44:18.720470 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:44:18.720870 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:44:18.721023 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m02:44:18.721400 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:44:18.721579 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:44:18.721877 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:44:18.722052 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m02:44:18.722257 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:44:18.732338 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:44:18.732564 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:44:18.734534 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m02:44:18.734740 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:44:18.736352 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:44:18.736591 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.742257 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:44:18.742424 [debug] [Thread-2  ]: finished collecting timing info
[0m02:44:18.742726 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:44:18.742898 [debug] [Thread-3  ]: finished collecting timing info
[0m02:44:18.743248 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m02:44:18.743446 [debug] [Thread-4  ]: finished collecting timing info
[0m02:44:18.753710 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:44:18.753910 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:44:18.755280 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m02:44:18.755473 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:44:18.756768 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:44:18.757306 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:44:18.758591 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:44:18.759083 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m02:44:18.759655 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:44:18.759806 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:44:18.760419 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:44:18.760577 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from airbnb.dev.fct_reviews f
inner join airbnb.dev.dim_listings_cleansed d
on f.listing_id = d.listing_id
where  f.review_date < d.created_at
      
    ) dbt_internal_test
[0m02:44:18.760769 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:44:18.760936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:18.761140 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:44:18.761330 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:44:18.761523 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:44:18.764392 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:44:19.445577 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.68 seconds
[0m02:44:19.452366 [debug] [Thread-4  ]: finished collecting timing info
[0m02:44:19.456054 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:44:19.566758 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m02:44:19.567288 [info ] [Thread-4  ]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.85s]
[0m02:44:19.568365 [debug] [Thread-3  ]: finished collecting timing info
[0m02:44:19.568777 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:44:19.568982 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:44:19.569229 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:44:19.571143 [info ] [Thread-4  ]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:44:19.571491 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:44:19.571608 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:44:19.571719 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:44:19.574563 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:44:19.574818 [debug] [Thread-4  ]: finished collecting timing info
[0m02:44:19.574937 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:44:19.576230 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:44:19.576641 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:44:19.576746 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:44:19.576846 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:44:19.686276 [info ] [Thread-3  ]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.97s]
[0m02:44:19.691893 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:44:19.692134 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:44:19.692285 [info ] [Thread-3  ]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:44:19.698008 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:44:19.703403 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:44:19.708696 [debug] [Thread-3  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:44:19.719530 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:44:19.741640 [debug] [Thread-3  ]: finished collecting timing info
[0m02:44:19.741842 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:44:19.743262 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:44:19.743934 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:44:19.744120 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:44:19.744246 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:44:19.941814 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.18 seconds
[0m02:44:19.942924 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:19.943114 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:44:20.036232 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.32s]
[0m02:44:20.036612 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:44:20.036778 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:44:20.036908 [info ] [Thread-1  ]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:44:20.037220 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:44:20.037349 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:44:20.037475 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:44:20.041741 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:44:20.042134 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:20.042261 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:44:20.043624 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:44:20.044128 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:44:20.044241 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:44:20.044345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:20.107365 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.36 seconds
[0m02:44:20.108477 [debug] [Thread-3  ]: finished collecting timing info
[0m02:44:20.108629 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:44:20.148408 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.57 seconds
[0m02:44:20.154798 [debug] [Thread-4  ]: finished collecting timing info
[0m02:44:20.172541 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:44:20.224874 [info ] [Thread-3  ]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.53s]
[0m02:44:20.225290 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:44:20.275446 [info ] [Thread-4  ]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.70s]
[0m02:44:20.275832 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:44:20.388620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.34 seconds
[0m02:44:20.389751 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:20.389886 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:44:20.491360 [info ] [Thread-1  ]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.45s]
[0m02:44:20.491724 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:44:22.017545 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.26 seconds
[0m02:44:22.018669 [debug] [Thread-2  ]: finished collecting timing info
[0m02:44:22.018804 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m02:44:22.108091 [info ] [Thread-2  ]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 3.39s]
[0m02:44:22.108460 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m02:44:22.109687 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:44:22.109922 [info ] [MainThread]: 
[0m02:44:22.110109 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m02:44:22.110290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:22.110384 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:44:22.110478 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m02:44:22.110571 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:44:22.110664 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m02:44:22.115541 [info ] [MainThread]: 
[0m02:44:22.115783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:22.116001 [info ] [MainThread]: 
[0m02:44:22.116180 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m02:44:22.116426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213b45610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213b456d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1213b45670>]}


============================== 2022-07-30 02:57:20.754020 | cdd6ccdc-ee93-43c4-ac6b-16c16eafe679 ==============================
[0m02:57:20.754039 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:57:20.754406 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m02:57:20.754531 [debug] [MainThread]: Tracking: tracking
[0m02:57:20.754731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2a6b52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2a6b5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2a6b53a0>]}
[0m02:57:20.776707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m02:57:20.777008 [debug] [MainThread]: Partial parsing: added file: dbtlearn://macros/no_nulls_in_columns.sql
[0m02:57:20.777160 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/no_nulls_in_dim_listings.sql
[0m02:57:20.777289 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m02:57:20.802567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd6ccdc-ee93-43c4-ac6b-16c16eafe679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c29533a60>]}
[0m02:57:20.807752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd6ccdc-ee93-43c4-ac6b-16c16eafe679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2a624c10>]}
[0m02:57:20.807992 [info ] [MainThread]: Found 8 models, 8 tests, 1 snapshot, 0 analyses, 268 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m02:57:20.808192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd6ccdc-ee93-43c4-ac6b-16c16eafe679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2a624fa0>]}
[0m02:57:20.809325 [info ] [MainThread]: 
[0m02:57:20.809662 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:57:20.810874 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m02:57:20.819733 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:57:20.819912 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:57:20.820022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:21.442774 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.62 seconds
[0m02:57:21.444196 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:57:21.529104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd6ccdc-ee93-43c4-ac6b-16c16eafe679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2a624730>]}
[0m02:57:21.529624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:57:21.529940 [info ] [MainThread]: 
[0m02:57:21.534541 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:57:21.534795 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m02:57:21.535034 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m02:57:21.535283 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m02:57:21.535637 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m02:57:21.535837 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m02:57:21.536433 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:57:21.536698 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m02:57:21.537246 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m02:57:21.537489 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m02:57:21.537752 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:57:21.538253 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:57:21.538481 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m02:57:21.539129 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m02:57:21.539403 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:57:21.539646 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m02:57:21.539873 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m02:57:21.540113 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m02:57:21.550870 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m02:57:21.551519 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:57:21.553626 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m02:57:21.553821 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m02:57:21.555219 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:57:21.561941 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m02:57:21.562899 [debug] [Thread-2  ]: finished collecting timing info
[0m02:57:21.563194 [debug] [Thread-3  ]: finished collecting timing info
[0m02:57:21.563475 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m02:57:21.563620 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:21.563961 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m02:57:21.564170 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m02:57:21.564325 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:57:21.564506 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:57:21.577735 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m02:57:21.578428 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m02:57:21.581567 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:57:21.583007 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m02:57:21.583249 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from airbnb.dev.fct_reviews f
inner join airbnb.dev.dim_listings_cleansed d
on f.listing_id = d.listing_id
where  f.review_date < d.created_at
      
    ) dbt_internal_test
[0m02:57:21.583405 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:57:21.585414 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m02:57:21.585671 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m02:57:21.585828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:21.586183 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m02:57:21.588146 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m02:57:21.588523 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:57:22.634721 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1.07 seconds
[0m02:57:22.636263 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m02:57:22.636547 [debug] [Thread-4  ]: finished collecting timing info
[0m02:57:22.636695 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m02:57:22.638476 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m02:57:22.639070 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m02:57:22.639173 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m02:57:22.644604 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.06 seconds
[0m02:57:22.645160 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.06 seconds
[0m02:57:22.646687 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:22.647607 [debug] [Thread-3  ]: finished collecting timing info
[0m02:57:22.647814 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m02:57:22.648006 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m02:57:22.734960 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.20s]
[0m02:57:22.735419 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.20s]
[0m02:57:22.735816 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m02:57:22.736187 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m02:57:22.736421 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:57:22.736635 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:57:22.736957 [info ] [Thread-3  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m02:57:22.737142 [info ] [Thread-1  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m02:57:22.737541 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:57:22.737945 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:57:22.738140 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:57:22.738331 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:57:22.738528 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:57:22.738721 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:57:22.743702 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:57:22.746279 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:57:22.746804 [debug] [Thread-3  ]: finished collecting timing info
[0m02:57:22.746955 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:57:22.748234 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:57:22.748497 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:22.748635 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:57:22.749774 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:57:22.750330 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m02:57:22.750456 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m02:57:22.750573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:22.752567 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m02:57:22.752689 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m02:57:22.752795 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:57:22.831147 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.25 seconds
[0m02:57:22.837480 [debug] [Thread-2  ]: finished collecting timing info
[0m02:57:22.858459 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m02:57:22.983381 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.45s]
[0m02:57:22.989129 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m02:57:22.993545 [debug] [Thread-2  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:57:23.003736 [info ] [Thread-2  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m02:57:23.006757 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:57:23.007109 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:57:23.007262 [debug] [Thread-2  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:57:23.013576 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:57:23.027617 [debug] [Thread-2  ]: finished collecting timing info
[0m02:57:23.028598 [debug] [Thread-2  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:57:23.035268 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:57:23.038389 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m02:57:23.039299 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:57:23.039460 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:57:23.256418 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m02:57:23.257708 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:23.257843 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m02:57:23.268392 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m02:57:23.269460 [debug] [Thread-4  ]: finished collecting timing info
[0m02:57:23.269596 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m02:57:23.276173 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m02:57:23.277234 [debug] [Thread-3  ]: finished collecting timing info
[0m02:57:23.277372 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m02:57:23.310408 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.27 seconds
[0m02:57:23.311449 [debug] [Thread-2  ]: finished collecting timing info
[0m02:57:23.311583 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m02:57:23.351050 [info ] [Thread-1  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.61s]
[0m02:57:23.354093 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m02:57:23.355601 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.82s]
[0m02:57:23.356453 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:57:23.358320 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m02:57:23.359060 [info ] [Thread-1  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m02:57:23.361299 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:57:23.361657 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:57:23.361997 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:57:23.373962 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:57:23.374614 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:23.374920 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:57:23.375730 [info ] [Thread-3  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.64s]
[0m02:57:23.378526 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:57:23.379157 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m02:57:23.380549 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m02:57:23.380737 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:57:23.380927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:23.406511 [info ] [Thread-2  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.40s]
[0m02:57:23.407035 [debug] [Thread-2  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m02:57:24.006015 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
[0m02:57:24.008295 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:24.008599 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m02:57:24.104922 [info ] [Thread-1  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.74s]
[0m02:57:24.105307 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m02:57:24.106534 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m02:57:24.106773 [info ] [MainThread]: 
[0m02:57:24.106961 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m02:57:24.107167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:24.107261 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m02:57:24.107355 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m02:57:24.107446 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m02:57:24.107538 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m02:57:24.112292 [info ] [MainThread]: 
[0m02:57:24.112537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:24.112754 [info ] [MainThread]: 
[0m02:57:24.112939 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m02:57:24.113205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c28703bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c295338e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c286b0c40>]}


============================== 2022-07-30 03:03:40.515462 | 2a5ee6c6-64e9-4dd6-bb60-46a149e81716 ==============================
[0m03:03:40.515479 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:03:40.515842 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m03:03:40.515963 [debug] [MainThread]: Tracking: tracking
[0m03:03:40.516161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d327a4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d327a4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d327a43d0>]}
[0m03:03:40.547641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m03:03:40.547924 [debug] [MainThread]: Partial parsing: added file: dbtlearn://macros/postitve_value.sql
[0m03:03:40.548184 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m03:03:40.548317 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m03:03:40.558229 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m03:03:40.611385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a5ee6c6-64e9-4dd6-bb60-46a149e81716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d305c8070>]}
[0m03:03:40.616534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a5ee6c6-64e9-4dd6-bb60-46a149e81716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d326ca1c0>]}
[0m03:03:40.616803 [info ] [MainThread]: Found 8 models, 8 tests, 1 snapshot, 0 analyses, 269 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:03:40.617046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a5ee6c6-64e9-4dd6-bb60-46a149e81716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d305cdeb0>]}
[0m03:03:40.618389 [info ] [MainThread]: 
[0m03:03:40.618959 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:03:40.620281 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m03:03:40.628571 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:03:40.628725 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:03:40.628831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:03:41.274830 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.65 seconds
[0m03:03:41.278171 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:03:41.418967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a5ee6c6-64e9-4dd6-bb60-46a149e81716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d327c9f40>]}
[0m03:03:41.419413 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:03:41.419642 [info ] [MainThread]: 
[0m03:03:41.423117 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:03:41.423317 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m03:03:41.423571 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m03:03:41.423760 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m03:03:41.423939 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:03:41.424132 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m03:03:41.424340 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m03:03:41.424843 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:03:41.425038 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m03:03:41.425486 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:03:41.425895 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:03:41.426105 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:03:41.426538 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:03:41.426735 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m03:03:41.426937 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m03:03:41.427142 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:03:41.427290 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m03:03:41.427473 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m03:03:41.427649 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m03:03:41.431860 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:03:41.432071 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m03:03:41.433856 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m03:03:41.435416 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:03:41.476799 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:03:41.477004 [debug] [Thread-1  ]: finished collecting timing info
[0m03:03:41.477621 [debug] [Thread-2  ]: finished collecting timing info
[0m03:03:41.477824 [debug] [Thread-3  ]: finished collecting timing info
[0m03:03:41.478009 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m03:03:41.478214 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:03:41.478410 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m03:03:41.478602 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m03:03:41.478786 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:03:41.494270 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m03:03:41.495523 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:03:41.497712 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:03:41.499830 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:03:41.500291 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:03:41.500443 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m03:03:41.500808 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:03:41.501086 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m03:03:41.501271 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:03:41.501462 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from airbnb.dev.fct_reviews f
inner join airbnb.dev.dim_listings_cleansed d
on f.listing_id = d.listing_id
where  f.review_date < d.created_at
      
    ) dbt_internal_test
[0m03:03:41.501646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:03:41.503376 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:03:42.323773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m03:03:42.325826 [debug] [Thread-1  ]: finished collecting timing info
[0m03:03:42.326007 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m03:03:42.487228 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.99 seconds
[0m03:03:42.489059 [debug] [Thread-3  ]: finished collecting timing info
[0m03:03:42.489284 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m03:03:42.605983 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.18s]
[0m03:03:42.606361 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m03:03:42.606532 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:03:42.606668 [info ] [Thread-3  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m03:03:42.606993 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:03:42.607129 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:03:42.607259 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:03:42.612079 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:03:42.613273 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.11 seconds
[0m03:03:42.615149 [debug] [Thread-2  ]: finished collecting timing info
[0m03:03:42.615346 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m03:03:42.615605 [debug] [Thread-3  ]: finished collecting timing info
[0m03:03:42.617962 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.19s]
[0m03:03:42.618231 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:03:42.618645 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:03:42.620268 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:03:42.620552 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:03:42.621329 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:03:42.621490 [info ] [Thread-1  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m03:03:42.621662 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m03:03:42.622094 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:03:42.622281 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:03:42.622484 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:03:42.623487 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:03:42.626000 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:03:42.627321 [debug] [Thread-1  ]: finished collecting timing info
[0m03:03:42.627493 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:03:42.628901 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:03:42.629483 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:03:42.629597 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m03:03:42.629701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:03:42.720622 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1.24 seconds
[0m03:03:42.722336 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:03:42.724611 [debug] [Thread-4  ]: finished collecting timing info
[0m03:03:42.724760 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m03:03:42.727105 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:03:42.728498 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:03:42.729016 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m03:03:42.732614 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.31s]
[0m03:03:42.732958 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m03:03:42.733142 [debug] [Thread-2  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:03:42.733700 [info ] [Thread-2  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m03:03:42.734180 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:03:42.734597 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:03:42.735264 [debug] [Thread-2  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:03:42.739107 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:03:42.740377 [debug] [Thread-2  ]: finished collecting timing info
[0m03:03:42.740539 [debug] [Thread-2  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:03:42.741879 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:03:42.744327 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:03:42.745375 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:03:42.745510 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:03:42.879044 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m03:03:42.880579 [debug] [Thread-4  ]: finished collecting timing info
[0m03:03:42.880733 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m03:03:42.978226 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.55s]
[0m03:03:42.979049 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:03:42.979231 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:03:42.979781 [info ] [Thread-4  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m03:03:42.980263 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:03:42.982084 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:03:42.982228 [debug] [Thread-4  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:03:42.986497 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:03:42.989461 [debug] [Thread-4  ]: finished collecting timing info
[0m03:03:42.989674 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:03:42.991123 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:03:42.992132 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:03:42.992262 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:03:42.992380 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:03:43.213346 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.59 seconds
[0m03:03:43.214624 [debug] [Thread-3  ]: finished collecting timing info
[0m03:03:43.214892 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m03:03:43.319155 [info ] [Thread-3  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.71s]
[0m03:03:43.319706 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:03:43.438741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
[0m03:03:43.441777 [debug] [Thread-1  ]: finished collecting timing info
[0m03:03:43.442882 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m03:03:43.493766 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m03:03:43.494887 [debug] [Thread-4  ]: finished collecting timing info
[0m03:03:43.495032 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m03:03:43.497773 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.75 seconds
[0m03:03:43.498772 [debug] [Thread-2  ]: finished collecting timing info
[0m03:03:43.498913 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m03:03:43.542295 [info ] [Thread-1  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.92s]
[0m03:03:43.542673 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:03:43.588495 [info ] [Thread-4  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.61s]
[0m03:03:43.588865 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:03:43.591688 [info ] [Thread-2  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.86s]
[0m03:03:43.591990 [debug] [Thread-2  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:03:43.593185 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:03:43.593424 [info ] [MainThread]: 
[0m03:03:43.593614 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m03:03:43.593799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:03:43.593893 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m03:03:43.593988 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m03:03:43.594081 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m03:03:43.594174 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m03:03:43.599283 [info ] [MainThread]: 
[0m03:03:43.599538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:03:43.599759 [info ] [MainThread]: 
[0m03:03:43.599935 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m03:03:43.600184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d326ca3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d326ca430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d326ca340>]}


============================== 2022-07-30 03:05:18.599920 | baf6e07f-4f7f-4a1f-afb8-7faacaba9ccb ==============================
[0m03:05:18.599937 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:05:18.600290 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m03:05:18.600410 [debug] [MainThread]: Tracking: tracking
[0m03:05:18.600602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335972d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335972d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335972d430>]}
[0m03:05:18.623227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:18.623399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:18.628024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baf6e07f-4f7f-4a1f-afb8-7faacaba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33585cd5e0>]}
[0m03:05:18.633507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baf6e07f-4f7f-4a1f-afb8-7faacaba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3359635220>]}
[0m03:05:18.633755 [info ] [MainThread]: Found 8 models, 8 tests, 1 snapshot, 0 analyses, 269 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:05:18.633966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baf6e07f-4f7f-4a1f-afb8-7faacaba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3359635400>]}
[0m03:05:18.635168 [info ] [MainThread]: 
[0m03:05:18.635523 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:05:18.636643 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m03:05:18.644934 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:05:18.645081 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:05:18.645183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:19.594380 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.95 seconds
[0m03:05:19.596485 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:05:19.685802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baf6e07f-4f7f-4a1f-afb8-7faacaba9ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335962ce20>]}
[0m03:05:19.686291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:05:19.686550 [info ] [MainThread]: 
[0m03:05:19.690269 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:05:19.690459 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m03:05:19.690875 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:05:19.691036 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:05:19.691202 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:05:19.696581 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m03:05:19.702095 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m03:05:19.702269 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m03:05:19.702443 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:05:19.703165 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:05:19.703380 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m03:05:19.703815 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:05:19.704029 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m03:05:19.704557 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:05:19.704762 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m03:05:19.705237 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:05:19.705444 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m03:05:19.705608 [debug] [Thread-1  ]: finished collecting timing info
[0m03:05:19.705791 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m03:05:19.705977 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m03:05:19.706158 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m03:05:19.706348 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:05:19.708261 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m03:05:19.708469 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m03:05:19.709882 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:05:19.721184 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:05:19.729579 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:05:19.730256 [debug] [Thread-2  ]: finished collecting timing info
[0m03:05:19.730448 [debug] [Thread-3  ]: finished collecting timing info
[0m03:05:19.730769 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m03:05:19.731077 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m03:05:19.731558 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:05:19.731758 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m03:05:19.731943 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:05:19.733439 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m03:05:19.733651 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m03:05:19.734954 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:05:19.736930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:05:19.739250 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:05:19.739475 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m03:05:19.739598 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:05:19.740415 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:05:19.741536 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from airbnb.dev.fct_reviews f
inner join airbnb.dev.dim_listings_cleansed d
on f.listing_id = d.listing_id
where  f.review_date < d.created_at
      
    ) dbt_internal_test
[0m03:05:19.741658 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:05:20.399903 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
[0m03:05:20.401471 [debug] [Thread-1  ]: finished collecting timing info
[0m03:05:20.401609 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m03:05:20.494103 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.80s]
[0m03:05:20.494472 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:05:20.494631 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:05:20.494760 [info ] [Thread-1  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m03:05:20.495067 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:05:20.495321 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:05:20.495437 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:05:20.499877 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:05:20.501898 [debug] [Thread-1  ]: finished collecting timing info
[0m03:05:20.502071 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:05:20.503537 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:05:20.503982 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:05:20.504092 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m03:05:20.504197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:05:20.557239 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.82 seconds
[0m03:05:20.558364 [debug] [Thread-3  ]: finished collecting timing info
[0m03:05:20.558502 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m03:05:20.574110 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.84 seconds
[0m03:05:20.580643 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:05:20.603681 [debug] [Thread-4  ]: finished collecting timing info
[0m03:05:20.603874 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m03:05:20.605256 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:05:20.621451 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:05:20.626823 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m03:05:20.667210 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.96s]
[0m03:05:20.668807 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m03:05:20.668992 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:05:20.669482 [info ] [Thread-3  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m03:05:20.669916 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:05:20.670171 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:05:20.670393 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:05:20.672983 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:05:20.674402 [debug] [Thread-3  ]: finished collecting timing info
[0m03:05:20.674546 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:05:20.675864 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:05:20.680738 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:05:20.680919 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m03:05:20.681053 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:05:20.693660 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.07 seconds
[0m03:05:20.694805 [debug] [Thread-4  ]: finished collecting timing info
[0m03:05:20.694966 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m03:05:20.745785 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m03:05:20.749925 [debug] [Thread-2  ]: finished collecting timing info
[0m03:05:20.750323 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m03:05:20.797269 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.09s]
[0m03:05:20.803299 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:05:20.803687 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:05:20.814121 [info ] [Thread-4  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m03:05:20.819823 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:05:20.832325 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:05:20.837800 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:05:20.849073 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:05:20.860982 [debug] [Thread-4  ]: finished collecting timing info
[0m03:05:20.861176 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:05:20.862545 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:05:20.870169 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:05:20.870816 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:05:20.872300 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:05:20.875382 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.17s]
[0m03:05:20.875811 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m03:05:20.876343 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:05:20.876691 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m03:05:20.877082 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:05:20.877245 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:05:20.877566 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:05:20.882125 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:05:20.883105 [debug] [Thread-2  ]: finished collecting timing info
[0m03:05:20.883299 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:05:20.884910 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:05:20.889171 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:05:20.889349 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:05:20.889482 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:05:20.914352 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.41 seconds
[0m03:05:20.919110 [debug] [Thread-1  ]: finished collecting timing info
[0m03:05:20.919566 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m03:05:21.040342 [info ] [Thread-1  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.55s]
[0m03:05:21.046026 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:05:21.091347 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.41 seconds
[0m03:05:21.092517 [debug] [Thread-3  ]: finished collecting timing info
[0m03:05:21.092686 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m03:05:21.190604 [info ] [Thread-3  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.52s]
[0m03:05:21.191138 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:05:21.345467 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m03:05:21.346596 [debug] [Thread-4  ]: finished collecting timing info
[0m03:05:21.346737 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m03:05:21.356018 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.47 seconds
[0m03:05:21.357098 [debug] [Thread-2  ]: finished collecting timing info
[0m03:05:21.357233 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m03:05:21.439476 [info ] [Thread-4  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.62s]
[0m03:05:21.439862 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:05:21.443557 [info ] [Thread-2  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.57s]
[0m03:05:21.443892 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:05:21.445084 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:05:21.445343 [info ] [MainThread]: 
[0m03:05:21.445548 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m03:05:21.445744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:21.445846 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m03:05:21.445947 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m03:05:21.446046 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m03:05:21.446144 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m03:05:21.451840 [info ] [MainThread]: 
[0m03:05:21.452077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:21.452299 [info ] [MainThread]: 
[0m03:05:21.452478 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m03:05:21.452726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335962cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33585d67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33501545e0>]}


============================== 2022-07-30 03:07:19.026589 | 20775fea-ccde-4e2e-8033-521299eef94c ==============================
[0m03:07:19.026606 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:07:19.026936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m03:07:19.027058 [debug] [MainThread]: Tracking: tracking
[0m03:07:19.027247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e983092e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e98309370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e983093d0>]}
[0m03:07:19.050044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:07:19.050416 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://macros/postitve_value.sql
[0m03:07:19.050553 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m03:07:19.059199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20775fea-ccde-4e2e-8033-521299eef94c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9716ef10>]}
[0m03:07:19.064233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20775fea-ccde-4e2e-8033-521299eef94c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e971ac8e0>]}
[0m03:07:19.064466 [info ] [MainThread]: Found 8 models, 8 tests, 1 snapshot, 0 analyses, 269 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:07:19.064672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20775fea-ccde-4e2e-8033-521299eef94c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e971acb20>]}
[0m03:07:19.065832 [info ] [MainThread]: 
[0m03:07:19.066186 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:07:19.067122 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m03:07:19.075955 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:07:19.076138 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:07:19.076247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:19.646004 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.57 seconds
[0m03:07:19.648158 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:07:20.033264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20775fea-ccde-4e2e-8033-521299eef94c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e971ac460>]}
[0m03:07:20.034144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:07:20.034712 [info ] [MainThread]: 
[0m03:07:20.041714 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:07:20.041921 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m03:07:20.042177 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m03:07:20.042407 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m03:07:20.042610 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:07:20.042738 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m03:07:20.043206 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:07:20.043403 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m03:07:20.043603 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m03:07:20.043966 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:07:20.044157 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:07:20.044574 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:07:20.044938 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m03:07:20.045180 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:07:20.045394 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:07:20.045586 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m03:07:20.045777 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m03:07:20.046019 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m03:07:20.055536 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:07:20.055759 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m03:07:20.058494 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m03:07:20.058762 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m03:07:20.060454 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:07:20.060952 [debug] [Thread-1  ]: finished collecting timing info
[0m03:07:20.066380 [debug] [Thread-2  ]: finished collecting timing info
[0m03:07:20.068590 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:07:20.068924 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:07:20.069134 [debug] [Thread-3  ]: finished collecting timing info
[0m03:07:20.069333 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m03:07:20.069517 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m03:07:20.075105 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m03:07:20.080604 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:07:20.081957 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m03:07:20.082148 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:07:20.083452 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:07:20.084377 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:07:20.084735 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:07:20.086657 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m03:07:20.086930 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from airbnb.dev.fct_reviews f
inner join airbnb.dev.dim_listings_cleansed d
on f.listing_id = d.listing_id
where  f.review_date < d.created_at
      
    ) dbt_internal_test
[0m03:07:20.087292 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:07:20.087498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:20.087769 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:07:20.087951 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m03:07:20.091365 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:07:21.085743 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.99 seconds
[0m03:07:21.088467 [debug] [Thread-3  ]: finished collecting timing info
[0m03:07:21.088710 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m03:07:21.205097 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.16s]
[0m03:07:21.205483 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m03:07:21.205754 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:07:21.205891 [info ] [Thread-3  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m03:07:21.206230 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:07:21.206364 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:07:21.206622 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:07:21.211614 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:07:21.211894 [debug] [Thread-3  ]: finished collecting timing info
[0m03:07:21.212024 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:07:21.213362 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:07:21.213840 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:07:21.213954 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m03:07:21.214078 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:07:21.292413 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.2 seconds
[0m03:07:21.298298 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.21 seconds
[0m03:07:21.309403 [debug] [Thread-1  ]: finished collecting timing info
[0m03:07:21.324983 [debug] [Thread-2  ]: finished collecting timing info
[0m03:07:21.339610 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m03:07:21.350661 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 1.27 seconds
[0m03:07:21.356130 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m03:07:21.369597 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:07:21.385832 [debug] [Thread-4  ]: finished collecting timing info
[0m03:07:21.386006 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m03:07:21.387961 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:07:21.389168 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:07:21.389303 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m03:07:21.456898 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.07 seconds
[0m03:07:21.458028 [debug] [Thread-4  ]: finished collecting timing info
[0m03:07:21.458168 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m03:07:21.466735 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.42s]
[0m03:07:21.467096 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:07:21.467259 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:07:21.467393 [info ] [Thread-1  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m03:07:21.467835 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:07:21.467948 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:07:21.468059 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:07:21.470677 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:07:21.470928 [debug] [Thread-1  ]: finished collecting timing info
[0m03:07:21.471045 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:07:21.472252 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:07:21.472720 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:07:21.472832 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m03:07:21.472964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:07:21.483195 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.44s]
[0m03:07:21.483582 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m03:07:21.483742 [debug] [Thread-2  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:07:21.483873 [info ] [Thread-2  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m03:07:21.484188 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:07:21.484317 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:07:21.484443 [debug] [Thread-2  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:07:21.490092 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:07:21.490427 [debug] [Thread-2  ]: finished collecting timing info
[0m03:07:21.490578 [debug] [Thread-2  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:07:21.492016 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:07:21.492661 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:07:21.492772 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:07:21.492874 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:07:21.571670 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.53s]
[0m03:07:21.572194 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:07:21.572511 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:07:21.572684 [info ] [Thread-4  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m03:07:21.578381 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:07:21.578568 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:07:21.595167 [debug] [Thread-4  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:07:21.599699 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:07:21.600088 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.39 seconds
[0m03:07:21.616706 [debug] [Thread-3  ]: finished collecting timing info
[0m03:07:21.622209 [debug] [Thread-4  ]: finished collecting timing info
[0m03:07:21.622471 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m03:07:21.643697 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:07:21.665985 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:07:21.703094 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:07:21.703468 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:07:21.703787 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:07:21.797138 [info ] [Thread-3  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.59s]
[0m03:07:21.797684 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:07:21.961555 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.49 seconds
[0m03:07:21.962752 [debug] [Thread-1  ]: finished collecting timing info
[0m03:07:21.962904 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m03:07:21.993585 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.5 seconds
[0m03:07:21.994795 [debug] [Thread-2  ]: finished collecting timing info
[0m03:07:21.994947 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m03:07:22.013781 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.31 seconds
[0m03:07:22.015143 [debug] [Thread-4  ]: finished collecting timing info
[0m03:07:22.015323 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m03:07:22.046469 [info ] [Thread-1  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.58s]
[0m03:07:22.046830 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:07:22.082353 [info ] [Thread-2  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.60s]
[0m03:07:22.082709 [debug] [Thread-2  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:07:22.104601 [info ] [Thread-4  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.53s]
[0m03:07:22.104958 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:07:22.106163 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:07:22.106464 [info ] [MainThread]: 
[0m03:07:22.106677 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m03:07:22.106892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:22.107023 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m03:07:22.107144 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m03:07:22.107253 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m03:07:22.107349 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m03:07:22.112147 [info ] [MainThread]: 
[0m03:07:22.112380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:07:22.112597 [info ] [MainThread]: 
[0m03:07:22.112787 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m03:07:22.113071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e971ac940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e971ac850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e968edf70>]}


============================== 2022-07-30 03:09:12.510557 | 62fe4fd3-0a5e-430c-98ed-e1785f6a97a0 ==============================
[0m03:09:12.510574 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:09:12.510929 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m03:09:12.511048 [debug] [MainThread]: Tracking: tracking
[0m03:09:12.511239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b39f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b39f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b39f400>]}
[0m03:09:12.534055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:09:12.534449 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m03:09:12.534653 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://macros/postitve_value.sql
[0m03:09:12.534778 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m03:09:12.544723 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m03:09:12.595492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62fe4fd3-0a5e-430c-98ed-e1785f6a97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b269370>]}
[0m03:09:12.600415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62fe4fd3-0a5e-430c-98ed-e1785f6a97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b2c7790>]}
[0m03:09:12.600628 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 269 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:09:12.600828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62fe4fd3-0a5e-430c-98ed-e1785f6a97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b264f40>]}
[0m03:09:12.601982 [info ] [MainThread]: 
[0m03:09:12.602319 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:09:12.603228 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m03:09:12.611619 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:09:12.611822 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:09:12.611922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:13.726901 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.11 seconds
[0m03:09:13.729450 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:09:13.835344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62fe4fd3-0a5e-430c-98ed-e1785f6a97a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b2c7220>]}
[0m03:09:13.835833 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:09:13.836115 [info ] [MainThread]: 
[0m03:09:13.839801 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:09:13.840010 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m03:09:13.840455 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:09:13.840617 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:09:13.840784 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:09:13.845716 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:09:13.845974 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m03:09:13.846403 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m03:09:13.846584 [info ] [Thread-2  ]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m03:09:13.847004 [info ] [Thread-3  ]: 3 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m03:09:13.847669 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:09:13.847837 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:09:13.848265 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:09:13.848479 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:13.848633 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m03:09:13.848832 [info ] [Thread-4  ]: 4 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m03:09:13.849003 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m03:09:13.849199 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:09:13.849398 [debug] [Thread-2  ]: Compiling test.dbtlearn.consistent_created_at
[0m03:09:13.849850 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:09:13.850004 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m03:09:13.864210 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m03:09:13.864505 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:09:13.864722 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m03:09:13.900552 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:09:13.901189 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m03:09:13.901404 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m03:09:13.901584 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:13.901885 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m03:09:13.902085 [debug] [Thread-3  ]: finished collecting timing info
[0m03:09:13.907497 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m03:09:13.909616 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:09:13.909781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:13.909965 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m03:09:13.911374 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.consistent_created_at"
[0m03:09:13.911616 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m03:09:13.914627 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m03:09:13.915095 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:09:13.915680 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m03:09:13.917680 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m03:09:13.917837 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from airbnb.dev.fct_reviews f
inner join airbnb.dev.dim_listings_cleansed d
on f.listing_id = d.listing_id
where  f.review_date < d.created_at
      
    ) dbt_internal_test
[0m03:09:13.918020 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * 
 from airbnb.dev.dim_listings_cleansed
 where minimum_nights < 1
 limit 10
      
    ) dbt_internal_test
[0m03:09:13.918256 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:09:13.918437 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:09:14.692878 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.78 seconds
[0m03:09:14.694459 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:09:14.694751 [debug] [Thread-4  ]: finished collecting timing info
[0m03:09:14.694891 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m03:09:14.696604 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:09:14.697198 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m03:09:14.697320 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM airbnb.dev.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m03:09:14.712541 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.79 seconds
[0m03:09:14.714371 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:14.714542 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m03:09:14.786519 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.09 seconds
[0m03:09:14.787648 [debug] [Thread-4  ]: finished collecting timing info
[0m03:09:14.787780 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m03:09:14.804731 [info ] [Thread-2  ]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.96s]
[0m03:09:14.805123 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m03:09:14.805293 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:09:14.805428 [info ] [Thread-2  ]: 5 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m03:09:14.805748 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:09:14.805880 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:09:14.806014 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:09:14.811018 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:09:14.811558 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:14.811701 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:09:14.813096 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:09:14.813522 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m03:09:14.813631 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m03:09:14.813734 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:09:14.909637 [info ] [Thread-4  ]: 4 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.06s]
[0m03:09:14.915260 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m03:09:14.925973 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:09:14.926290 [info ] [Thread-4  ]: 6 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m03:09:14.937548 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:09:14.938471 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.02 seconds
[0m03:09:14.948831 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.04 seconds
[0m03:09:14.949071 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:09:14.965570 [debug] [Thread-3  ]: finished collecting timing info
[0m03:09:14.973970 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:14.983013 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:09:14.983886 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m03:09:14.984350 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m03:09:14.987438 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:09:14.996120 [debug] [Thread-4  ]: finished collecting timing info
[0m03:09:14.996301 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:09:14.997621 [debug] [Thread-4  ]: Writing runtime SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:09:14.998572 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m03:09:14.998699 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m03:09:14.998815 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:09:15.295927 [info ] [Thread-3  ]: 3 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 1.45s]
[0m03:09:15.296438 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m03:09:15.296701 [debug] [Thread-3  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m03:09:15.297751 [info ] [Thread-3  ]: 7 of 9 START test positive_value_dim_listings_cleansed_minimum_nights .......... [RUN]
[0m03:09:15.298428 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m03:09:15.298623 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m03:09:15.298811 [debug] [Thread-3  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m03:09:15.302354 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m03:09:15.303102 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.46s]
[0m03:09:15.303787 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m03:09:15.304041 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:09:15.304330 [debug] [Thread-3  ]: finished collecting timing info
[0m03:09:15.304560 [info ] [Thread-1  ]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m03:09:15.304971 [debug] [Thread-3  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m03:09:15.305593 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:09:15.307665 [debug] [Thread-3  ]: Writing runtime SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m03:09:15.307981 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:09:15.308501 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:09:15.313485 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:09:15.314057 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m03:09:15.314392 [debug] [Thread-3  ]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
    *
FROM
    airbnb.dev.dim_listings_cleansed
WHERE
    minimum_nights < 1

      
    ) dbt_internal_test
[0m03:09:15.314586 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:09:15.317106 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:15.317354 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:09:15.319679 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:09:15.320752 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m03:09:15.320959 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:09:15.321108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:15.323933 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.51 seconds
[0m03:09:15.325397 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:15.325954 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m03:09:15.359739 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.36 seconds
[0m03:09:15.360862 [debug] [Thread-4  ]: finished collecting timing info
[0m03:09:15.361125 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m03:09:15.447304 [info ] [Thread-2  ]: 5 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.64s]
[0m03:09:15.447890 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m03:09:15.479465 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:09:15.485455 [info ] [Thread-2  ]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m03:09:15.506765 [info ] [Thread-4  ]: 6 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.57s]
[0m03:09:15.507206 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:09:15.527968 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m03:09:15.546920 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:09:15.568136 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:09:15.572485 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:09:15.587490 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:15.587702 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:09:15.589085 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:09:15.591651 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m03:09:15.591796 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:09:15.591929 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:09:15.952402 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.36 seconds
[0m03:09:15.954544 [debug] [Thread-2  ]: finished collecting timing info
[0m03:09:15.954813 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m03:09:15.958718 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
[0m03:09:15.960496 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:15.960751 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m03:09:16.046209 [info ] [Thread-2  ]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.54s]
[0m03:09:16.046653 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m03:09:16.048177 [info ] [Thread-1  ]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.74s]
[0m03:09:16.048487 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m03:09:16.303469 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.99 seconds
[0m03:09:16.304555 [debug] [Thread-3  ]: finished collecting timing info
[0m03:09:16.304685 [debug] [Thread-3  ]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m03:09:16.397770 [info ] [Thread-3  ]: 7 of 9 PASS positive_value_dim_listings_cleansed_minimum_nights ................ [[32mPASS[0m in 1.10s]
[0m03:09:16.398153 [debug] [Thread-3  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m03:09:16.399491 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:09:16.399752 [info ] [MainThread]: 
[0m03:09:16.399955 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m03:09:16.400154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:16.400252 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m03:09:16.400352 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m03:09:16.400450 [debug] [MainThread]: Connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m03:09:16.400549 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m03:09:16.405457 [info ] [MainThread]: 
[0m03:09:16.405689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:16.405907 [info ] [MainThread]: 
[0m03:09:16.406085 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:09:16.406328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b2c7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b2c75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9b28c160>]}


============================== 2022-07-30 03:16:34.585429 | 2b6c4368-bdf3-4f71-97ec-59e33bba20af ==============================
[0m03:16:34.585439 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:16:34.585705 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m03:16:34.585808 [debug] [MainThread]: Tracking: tracking
[0m03:16:34.591712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc50040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc50430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc5e700>]}
[0m03:16:34.592302 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ighaednq'
[0m03:16:34.592515 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:16:34.829058 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:16:34.829503 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:16:34.889342 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:16:34.919185 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:16:35.307731 [info ] [MainThread]:   Installed from version 0.8.6
[0m03:16:35.307972 [info ] [MainThread]:   Up to date!
[0m03:16:35.308193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b6c4368-bdf3-4f71-97ec-59e33bba20af', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc26b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc263a0>]}
[0m03:16:35.308515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc50430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc269a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92adc263d0>]}


============================== 2022-07-30 03:25:13.159796 | 3598905b-132c-4682-a6b4-f1c267d371a3 ==============================
03:25:13.159807 [info ] [MainThread]: Running with dbt=1.1.1
03:25:13.160277 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
03:25:13.160417 [debug] [MainThread]: Tracking: tracking
03:25:13.160715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0a861a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0a8610a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0a861040>]}
03:25:13.179327 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
03:25:13.179552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3598905b-132c-4682-a6b4-f1c267d371a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd09784c40>]}
03:25:13.193528 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
03:25:13.194322 [debug] [MainThread]: Parsing macros/postitve_value.sql
03:25:13.194760 [debug] [MainThread]: Parsing macros/adapters.sql
03:25:13.222132 [debug] [MainThread]: Parsing macros/catalog.sql
03:25:13.223758 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
03:25:13.224549 [debug] [MainThread]: Parsing macros/materializations/merge.sql
03:25:13.227342 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
03:25:13.233742 [debug] [MainThread]: Parsing macros/materializations/table.sql
03:25:13.236040 [debug] [MainThread]: Parsing macros/materializations/view.sql
03:25:13.237041 [debug] [MainThread]: Parsing macros/materializations/seed.sql
03:25:13.241159 [debug] [MainThread]: Parsing macros/adapters/columns.sql
03:25:13.248102 [debug] [MainThread]: Parsing macros/adapters/relation.sql
03:25:13.255184 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
03:25:13.258535 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
03:25:13.260664 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
03:25:13.262657 [debug] [MainThread]: Parsing macros/adapters/schema.sql
03:25:13.264236 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
03:25:13.269582 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
03:25:13.272568 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
03:25:13.273822 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
03:25:13.274937 [debug] [MainThread]: Parsing macros/etc/datetime.sql
03:25:13.281028 [debug] [MainThread]: Parsing macros/etc/statement.sql
03:25:13.284175 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
03:25:13.284703 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
03:25:13.285388 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
03:25:13.286701 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
03:25:13.288741 [debug] [MainThread]: Parsing macros/materializations/configs.sql
03:25:13.290394 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
03:25:13.293170 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
03:25:13.294511 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
03:25:13.295845 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
03:25:13.299210 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
03:25:13.310832 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
03:25:13.315341 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
03:25:13.316665 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
03:25:13.324227 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
03:25:13.336089 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
03:25:13.345720 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
03:25:13.357189 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
03:25:13.369494 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
03:25:13.376851 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
03:25:13.377975 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
03:25:13.381227 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
03:25:13.383188 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
03:25:13.384144 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
03:25:13.389292 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
03:25:13.391028 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
03:25:13.393133 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
03:25:13.398581 [debug] [MainThread]: Parsing tests/generic/builtin.sql
03:25:13.400643 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
03:25:13.407168 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
03:25:13.408734 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
03:25:13.413263 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
03:25:13.413989 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
03:25:13.421061 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
03:25:13.422465 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
03:25:13.423606 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
03:25:13.424577 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
03:25:13.426307 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
03:25:13.428472 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
03:25:13.429922 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
03:25:13.431313 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
03:25:13.433278 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
03:25:13.435889 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
03:25:13.436884 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
03:25:13.438468 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
03:25:13.439253 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
03:25:13.443985 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
03:25:13.446620 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
03:25:13.448367 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
03:25:13.449735 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
03:25:13.450560 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
03:25:13.451714 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
03:25:13.452771 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
03:25:13.453866 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
03:25:13.454673 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
03:25:13.458536 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
03:25:13.460650 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
03:25:13.461461 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
03:25:13.462512 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
03:25:13.464035 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
03:25:13.465911 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
03:25:13.467077 [debug] [MainThread]: Parsing macros/sql/star.sql
03:25:13.469857 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
03:25:13.471231 [debug] [MainThread]: Parsing macros/sql/pivot.sql
03:25:13.474370 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
03:25:13.475644 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
03:25:13.477707 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
03:25:13.483654 [debug] [MainThread]: Parsing macros/sql/union.sql
03:25:13.491947 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
03:25:13.493291 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
03:25:13.497404 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
03:25:13.500562 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
03:25:13.503082 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
03:25:13.505774 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
03:25:13.510735 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
03:25:13.513844 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
03:25:13.518561 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
03:25:13.523067 [debug] [MainThread]: Parsing macros/sql/groupby.sql
03:25:13.524224 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
03:25:13.525528 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
03:25:13.527237 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
03:25:13.528467 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
03:25:13.530940 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
03:25:13.531783 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
03:25:13.532719 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
03:25:13.533606 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
03:25:13.534546 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
03:25:13.551673 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
03:25:13.553107 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
03:25:13.554751 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
03:25:13.556238 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
03:25:13.557300 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
03:25:13.559413 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
03:25:13.560958 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
03:25:13.562237 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
03:25:13.564046 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
03:25:13.571767 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
03:25:13.574595 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
03:25:13.576214 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
03:25:13.577139 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
03:25:13.578079 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
03:25:13.579147 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
03:25:13.581373 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
03:25:13.582604 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
03:25:13.861955 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
03:25:13.869935 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
03:25:13.871647 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
03:25:13.873325 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
03:25:13.888847 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
03:25:13.890157 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
03:25:13.892124 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
03:25:13.894098 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
03:25:13.897188 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
03:25:14.039412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3598905b-132c-4682-a6b4-f1c267d371a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdb585160>]}
03:25:14.046490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3598905b-132c-4682-a6b4-f1c267d371a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0a861070>]}
03:25:14.046722 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 420 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
03:25:14.046924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3598905b-132c-4682-a6b4-f1c267d371a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd097db730>]}
03:25:14.047538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdb54bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd097db730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcdb5851f0>]}


============================== 2022-07-30 03:25:57.425306 | 5605459e-dfa6-48a9-9d4d-ab45a3064e02 ==============================
[0m03:25:57.425326 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:25:57.425738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:25:57.425857 [debug] [MainThread]: Tracking: tracking
[0m03:25:57.426063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada679340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada6793a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada679400>]}
[0m03:25:57.447186 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m03:25:57.447450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada6648b0>]}
[0m03:25:57.462735 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m03:25:57.463595 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m03:25:57.464051 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:25:57.494738 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:25:57.496168 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m03:25:57.496884 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m03:25:57.499631 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m03:25:57.506465 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m03:25:57.509087 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m03:25:57.510146 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m03:25:57.513986 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:25:57.514355 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:25:57.514760 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:25:57.515251 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:25:57.515725 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:25:57.522694 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:25:57.532987 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:25:57.536360 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:25:57.538520 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:25:57.548694 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:25:57.550749 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:25:57.552357 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:25:57.557579 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:25:57.559503 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:25:57.560721 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:25:57.561858 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:25:57.567999 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:25:57.571251 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:25:57.571787 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:25:57.572399 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:25:57.573053 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:25:57.574074 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:25:57.575810 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:25:57.579103 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:25:57.580488 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:25:57.581788 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:25:57.585060 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:25:57.598798 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:25:57.603795 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:25:57.605090 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:25:57.613356 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:25:57.625606 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:25:57.635143 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:25:57.646092 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:25:57.658211 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:25:57.664882 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:25:57.666054 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:25:57.669323 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:25:57.671835 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:25:57.672813 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:25:57.676350 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:25:57.678110 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:25:57.680214 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:25:57.684239 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:25:57.686111 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:25:57.687683 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:25:57.688431 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:25:57.689385 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:25:57.690213 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:25:57.690942 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:25:57.691674 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:25:57.692634 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:25:57.693507 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:25:57.695005 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:25:57.695788 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:25:57.696570 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:25:57.697416 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:25:57.698228 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:25:57.699067 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:25:57.700010 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:25:57.700909 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:25:57.705481 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:25:57.706126 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:25:57.706768 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:25:57.707622 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:25:57.709726 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m03:25:57.716486 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m03:25:57.718082 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m03:25:57.722592 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m03:25:57.723323 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m03:25:57.730608 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m03:25:57.732042 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m03:25:57.733208 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m03:25:57.734195 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m03:25:57.735410 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m03:25:57.737557 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m03:25:57.738966 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m03:25:57.740466 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m03:25:57.742408 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m03:25:57.745100 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m03:25:57.746080 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m03:25:57.747308 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m03:25:57.748061 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m03:25:57.752830 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m03:25:57.755557 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m03:25:57.757285 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m03:25:57.758683 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m03:25:57.759543 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m03:25:57.760717 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m03:25:57.761670 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m03:25:57.762763 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m03:25:57.763631 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m03:25:57.767525 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m03:25:57.769564 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m03:25:57.770381 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m03:25:57.771438 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m03:25:57.772811 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m03:25:57.774707 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m03:25:57.775892 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m03:25:57.778812 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m03:25:57.780107 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m03:25:57.783023 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m03:25:57.784242 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m03:25:57.786301 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m03:25:57.792174 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m03:25:57.800526 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m03:25:57.801752 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m03:25:57.805836 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m03:25:57.808932 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m03:25:57.811361 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m03:25:57.813943 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m03:25:57.819248 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m03:25:57.822315 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m03:25:57.827023 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m03:25:57.831126 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m03:25:57.832154 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m03:25:57.833381 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m03:25:57.835056 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m03:25:57.836286 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m03:25:57.838770 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m03:25:57.839600 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m03:25:57.840504 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m03:25:57.841442 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m03:25:57.842285 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m03:25:57.859750 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m03:25:57.861167 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m03:25:57.862733 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m03:25:57.864106 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m03:25:57.865182 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m03:25:57.867251 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m03:25:57.868789 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m03:25:57.870044 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m03:25:57.871830 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m03:25:57.878445 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m03:25:57.881146 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m03:25:57.882778 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m03:25:57.883708 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m03:25:57.884643 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m03:25:57.885692 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m03:25:57.887749 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m03:25:57.889031 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m03:25:58.226986 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m03:25:58.234690 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m03:25:58.236240 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m03:25:58.237733 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m03:25:58.252312 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m03:25:58.253495 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m03:25:58.255892 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m03:25:58.257594 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m03:25:58.259360 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m03:25:58.376004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab32f1640>]}
[0m03:25:58.383435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada634d60>]}
[0m03:25:58.383630 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:25:58.383828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada6e46d0>]}
[0m03:25:58.384923 [info ] [MainThread]: 
[0m03:25:58.385253 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:25:58.386065 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m03:25:58.394993 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m03:25:58.395179 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m03:25:58.395287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:59.012066 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.62 seconds
[0m03:25:59.013515 [debug] [ThreadPool]: On list_airbnb: Close
[0m03:25:59.126489 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m03:25:59.131790 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:25:59.131930 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:25:59.132036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:59.552488 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.42 seconds
[0m03:25:59.553700 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:25:59.651625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab243ed90>]}
[0m03:25:59.652012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:25:59.652217 [info ] [MainThread]: 
[0m03:25:59.655420 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m03:25:59.655598 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m03:25:59.655880 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m03:25:59.656054 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m03:25:59.656369 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m03:25:59.656610 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m03:25:59.656902 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m03:25:59.657085 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m03:25:59.657288 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m03:25:59.657475 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m03:25:59.657656 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m03:25:59.659822 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m03:25:59.660046 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m03:25:59.661854 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m03:25:59.663178 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m03:25:59.663896 [debug] [Thread-1  ]: finished collecting timing info
[0m03:25:59.664291 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m03:25:59.664602 [debug] [Thread-2  ]: finished collecting timing info
[0m03:25:59.665110 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m03:25:59.665478 [debug] [Thread-3  ]: finished collecting timing info
[0m03:25:59.665726 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m03:25:59.666213 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m03:25:59.666564 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m03:25:59.666840 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m03:25:59.667072 [info ] [Thread-2  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m03:25:59.667707 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m03:25:59.668066 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m03:25:59.668280 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m03:25:59.668574 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m03:25:59.668698 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m03:25:59.668907 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m03:25:59.669100 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m03:25:59.669296 [info ] [Thread-1  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m03:25:59.682989 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m03:25:59.685282 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m03:25:59.685700 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m03:25:59.686415 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m03:25:59.686670 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m03:25:59.691918 [debug] [Thread-4  ]: finished collecting timing info
[0m03:25:59.692121 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m03:25:59.696695 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m03:25:59.707531 [debug] [Thread-2  ]: finished collecting timing info
[0m03:25:59.707952 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m03:25:59.713376 [debug] [Thread-1  ]: finished collecting timing info
[0m03:25:59.718863 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m03:25:59.727824 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m03:25:59.734146 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m03:25:59.748773 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:25:59.748954 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)
 
select 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) as review_id  /*这个是扩展包里的surrogate_key*/
    * 
from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m03:25:59.749485 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m03:25:59.749703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:25:59.750315 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m03:25:59.750496 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m03:25:59.752294 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT * FROM airbnb.raw.raw_listings
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m03:25:59.752489 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:25:59.752679 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:26:00.405995 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5f1ad-3201-0757-0000-d0150001f17e
[0m03:26:00.406235 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 4 unexpected '*'.
[0m03:26:00.406528 [debug] [Thread-1  ]: finished collecting timing info
[0m03:26:00.406719 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m03:26:00.489226 [debug] [Thread-1  ]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 4 unexpected '*'.
[0m03:26:00.489495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada619760>]}
[0m03:26:00.489764 [error] [Thread-1  ]: 3 of 5 ERROR creating incremental model dev.fct_reviews ........................ [[31mERROR[0m in 0.80s]
[0m03:26:00.490079 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m03:26:00.490583 [debug] [Thread-3  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m03:26:00.490731 [info ] [Thread-3  ]: 4 of 5 SKIP relation dev.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m03:26:00.491020 [debug] [Thread-3  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m03:26:00.650884 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.9 seconds
[0m03:26:00.664787 [debug] [Thread-4  ]: finished collecting timing info
[0m03:26:00.664988 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m03:26:00.696206 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.94 seconds
[0m03:26:00.707332 [debug] [Thread-2  ]: finished collecting timing info
[0m03:26:00.707491 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m03:26:00.764396 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2412370>]}
[0m03:26:00.764700 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m03:26:00.765013 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m03:26:00.819922 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad95c4d00>]}
[0m03:26:00.820252 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.15s]
[0m03:26:00.820579 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m03:26:00.821116 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m03:26:00.821666 [info ] [Thread-1  ]: 5 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m03:26:00.822018 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:00.822153 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m03:26:00.822283 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m03:26:00.825309 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:00.825667 [debug] [Thread-1  ]: finished collecting timing info
[0m03:26:00.825808 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m03:26:00.833648 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:00.834358 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:00.834481 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m03:26:00.834585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.670556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.84 seconds
[0m03:26:02.675193 [debug] [Thread-1  ]: finished collecting timing info
[0m03:26:02.675333 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m03:26:02.767439 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5605459e-dfa6-48a9-9d4d-ab45a3064e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab32ba580>]}
[0m03:26:02.767789 [info ] [Thread-1  ]: 5 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.95s]
[0m03:26:02.768125 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m03:26:02.769351 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:26:02.769618 [info ] [MainThread]: 
[0m03:26:02.769829 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 2 view models in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m03:26:02.770013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:02.770110 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m03:26:02.770204 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m03:26:02.770295 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m03:26:02.770389 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m03:26:02.778956 [info ] [MainThread]: 
[0m03:26:02.779232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:26:02.779455 [info ] [MainThread]: 
[0m03:26:02.779642 [error] [MainThread]: [33mDatabase Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m03:26:02.779819 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m03:26:02.779989 [error] [MainThread]:   syntax error line 30 at position 4 unexpected '*'.
[0m03:26:02.780210 [info ] [MainThread]: 
[0m03:26:02.780389 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m03:26:02.780662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab33576d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcada69a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab32ba580>]}


============================== 2022-07-30 03:26:38.209576 | 214ce81d-e5a6-48ec-a9e0-f4d81fa2d507 ==============================
[0m03:26:38.209594 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:26:38.209939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:26:38.210060 [debug] [MainThread]: Tracking: tracking
[0m03:26:38.210327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47bf58310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47bf58370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47bf583d0>]}
[0m03:26:38.247494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:26:38.247883 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/fct/fct_reviews.sql
[0m03:26:38.258086 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m03:26:38.287343 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m03:26:38.296748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47acca670>]}
[0m03:26:38.304656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47be55520>]}
[0m03:26:38.304897 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:26:38.305104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47be55670>]}
[0m03:26:38.306266 [info ] [MainThread]: 
[0m03:26:38.306616 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:26:38.307339 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m03:26:38.316518 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m03:26:38.316694 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m03:26:38.316803 [debug] [ThreadPool]: Opening a new connection, currently in state init


============================== 2022-07-30 03:26:38.920928 | bd8d5f90-4d7b-4cd6-afda-f204dfcd8968 ==============================
03:26:38.920938 [info ] [MainThread]: Running with dbt=1.1.1
03:26:38.921188 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
03:26:38.921401 [debug] [MainThread]: Tracking: tracking
03:26:38.921583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5fccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5fc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5fc0d0>]}
[0m03:26:38.925969 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.61 seconds
[0m03:26:38.927229 [debug] [ThreadPool]: On list_airbnb: Close
03:26:38.943098 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
03:26:38.943301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd8d5f90-4d7b-4cd6-afda-f204dfcd8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab543d00>]}
03:26:38.956906 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
03:26:38.957683 [debug] [MainThread]: Parsing macros/postitve_value.sql
03:26:38.958124 [debug] [MainThread]: Parsing macros/adapters.sql
03:26:38.985128 [debug] [MainThread]: Parsing macros/catalog.sql
03:26:38.986817 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
03:26:38.987520 [debug] [MainThread]: Parsing macros/materializations/merge.sql
03:26:38.990286 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
03:26:38.996683 [debug] [MainThread]: Parsing macros/materializations/table.sql
03:26:38.998941 [debug] [MainThread]: Parsing macros/materializations/view.sql
03:26:38.999934 [debug] [MainThread]: Parsing macros/materializations/seed.sql
03:26:39.003821 [debug] [MainThread]: Parsing macros/adapters/columns.sql
03:26:39.010609 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:26:39.017016 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
03:26:39.017761 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
03:26:39.021062 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:26:39.021867 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:26:39.022008 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:26:39.022114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
03:26:39.023273 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
03:26:39.025232 [debug] [MainThread]: Parsing macros/adapters/schema.sql
03:26:39.026828 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
03:26:39.031989 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
03:26:39.033902 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
03:26:39.035077 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
03:26:39.036217 [debug] [MainThread]: Parsing macros/etc/datetime.sql
03:26:39.042390 [debug] [MainThread]: Parsing macros/etc/statement.sql
03:26:39.045506 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
03:26:39.046050 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
03:26:39.046658 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
03:26:39.047298 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
03:26:39.048303 [debug] [MainThread]: Parsing macros/materializations/configs.sql
03:26:39.050101 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
03:26:39.053006 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
03:26:39.054377 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
03:26:39.055680 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
03:26:39.059046 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
03:26:39.071064 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
03:26:39.075587 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
03:26:39.076814 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
03:26:39.084986 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
03:26:39.097225 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
03:26:39.106404 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
03:26:39.118243 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
03:26:39.130596 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
03:26:39.138210 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
03:26:39.139407 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
03:26:39.142794 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
03:26:39.144971 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
03:26:39.146048 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
03:26:39.151055 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
03:26:39.152826 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
03:26:39.155046 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
03:26:39.160820 [debug] [MainThread]: Parsing tests/generic/builtin.sql
03:26:39.163038 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
03:26:39.169226 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
03:26:39.170792 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
03:26:39.175514 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
03:26:39.176265 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
03:26:39.184173 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
03:26:39.185687 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
03:26:39.186811 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
03:26:39.187786 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
03:26:39.189081 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
03:26:39.191387 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
03:26:39.192808 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
03:26:39.194400 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
03:26:39.196377 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
03:26:39.199057 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
03:26:39.200082 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
03:26:39.201580 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
03:26:39.202377 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
03:26:39.207192 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
03:26:39.209850 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
03:26:39.211559 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
03:26:39.212912 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
03:26:39.213756 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
03:26:39.214891 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
03:26:39.215950 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
03:26:39.217017 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
03:26:39.217810 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
03:26:39.221528 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
03:26:39.223618 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
03:26:39.224423 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
03:26:39.225503 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
03:26:39.227045 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
03:26:39.228952 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
03:26:39.230145 [debug] [MainThread]: Parsing macros/sql/star.sql
03:26:39.233015 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
03:26:39.234236 [debug] [MainThread]: Parsing macros/sql/pivot.sql
03:26:39.237652 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
03:26:39.238923 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
03:26:39.240937 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
03:26:39.247235 [debug] [MainThread]: Parsing macros/sql/union.sql
03:26:39.256377 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
03:26:39.257636 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
03:26:39.262242 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
03:26:39.265692 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
03:26:39.268216 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
03:26:39.270787 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
03:26:39.275939 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
03:26:39.278987 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
03:26:39.283764 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
03:26:39.288025 [debug] [MainThread]: Parsing macros/sql/groupby.sql
03:26:39.289010 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
03:26:39.290252 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
03:26:39.291951 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
03:26:39.293186 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
03:26:39.295682 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
03:26:39.296553 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
03:26:39.297545 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
03:26:39.298487 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
03:26:39.299370 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
03:26:39.318409 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
03:26:39.319810 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
03:26:39.321390 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
03:26:39.322844 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
03:26:39.323910 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
03:26:39.326009 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
03:26:39.327538 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
03:26:39.328941 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
03:26:39.330702 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
03:26:39.337077 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
03:26:39.339725 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
03:26:39.341303 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
03:26:39.342246 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
03:26:39.343247 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
03:26:39.344395 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
03:26:39.346526 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
03:26:39.347828 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m03:26:39.353674 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.33 seconds
[0m03:26:39.354787 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:26:39.444568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47bf4a730>]}
[0m03:26:39.444962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:26:39.445180 [info ] [MainThread]: 
[0m03:26:39.448563 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m03:26:39.448771 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m03:26:39.449069 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m03:26:39.449240 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m03:26:39.449564 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m03:26:39.449808 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m03:26:39.450104 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m03:26:39.450298 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m03:26:39.450496 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m03:26:39.450687 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m03:26:39.450871 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m03:26:39.453815 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m03:26:39.454051 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m03:26:39.455823 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m03:26:39.457115 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m03:26:39.457392 [debug] [Thread-1  ]: finished collecting timing info
[0m03:26:39.457689 [debug] [Thread-2  ]: finished collecting timing info
[0m03:26:39.458397 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m03:26:39.458785 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m03:26:39.459252 [debug] [Thread-3  ]: finished collecting timing info
[0m03:26:39.459577 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m03:26:39.460324 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m03:26:39.460479 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m03:26:39.460805 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m03:26:39.461304 [info ] [Thread-1  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m03:26:39.461639 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m03:26:39.462152 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m03:26:39.462583 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m03:26:39.462836 [info ] [Thread-2  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m03:26:39.463005 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m03:26:39.463179 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m03:26:39.463536 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m03:26:39.463714 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m03:26:39.463896 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m03:26:39.464101 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m03:26:39.471520 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m03:26:39.476924 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m03:26:39.477349 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m03:26:39.488291 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m03:26:39.489042 [debug] [Thread-1  ]: finished collecting timing info
[0m03:26:39.489185 [debug] [Thread-2  ]: finished collecting timing info
[0m03:26:39.489355 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m03:26:39.489501 [debug] [Thread-4  ]: finished collecting timing info
[0m03:26:39.489697 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m03:26:39.500711 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m03:26:39.509337 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m03:26:39.522068 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m03:26:39.536149 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:26:39.536629 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)
 
select 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) as review_id,  /*这个是扩展包里的surrogate_key*/
    * 
from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m03:26:39.536773 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:26:39.538005 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m03:26:39.538903 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT * FROM airbnb.raw.raw_listings
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m03:26:39.539325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:39.541259 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m03:26:39.541370 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m03:26:39.541469 [debug] [Thread-4  ]: Opening a new connection, currently in state init
03:26:39.624853 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
03:26:39.632339 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
03:26:39.633938 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
03:26:39.635471 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
03:26:39.650460 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
03:26:39.651572 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
03:26:39.653290 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
03:26:39.655078 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
03:26:39.656923 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
03:26:39.794668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8d5f90-4d7b-4cd6-afda-f204dfcd8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5df070>]}
03:26:39.801156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8d5f90-4d7b-4cd6-afda-f204dfcd8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab3e5310>]}
03:26:39.801376 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 420 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
03:26:39.801528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8d5f90-4d7b-4cd6-afda-f204dfcd8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab579b80>]}
03:26:39.802067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5fc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5df640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ab5df730>]}
[0m03:26:40.425512 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m03:26:40.439429 [debug] [Thread-1  ]: finished collecting timing info
[0m03:26:40.439618 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m03:26:40.536011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe479dca520>]}
[0m03:26:40.536371 [info ] [Thread-1  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.07s]
[0m03:26:40.536763 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m03:26:40.573062 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.03 seconds
[0m03:26:40.574431 [debug] [Thread-4  ]: finished collecting timing info
[0m03:26:40.574591 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m03:26:40.661032 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe479dc9700>]}
[0m03:26:40.661351 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.20s]
[0m03:26:40.661676 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m03:26:40.662177 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m03:26:40.662386 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m03:26:40.662745 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:40.662876 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m03:26:40.663032 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m03:26:40.665599 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:40.665886 [debug] [Thread-3  ]: finished collecting timing info
[0m03:26:40.666018 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m03:26:40.672710 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:40.673428 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m03:26:40.673542 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m03:26:40.673642 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:26:41.291041 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.75 seconds
[0m03:26:41.309296 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:26:41.309630 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m03:26:41.395334 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.09 seconds
[0m03:26:41.398280 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:26:41.398429 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m03:26:41.461489 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m03:26:41.472795 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:26:41.472984 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m03:26:41.544956 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.07 seconds
[0m03:26:41.549127 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:26:41.549270 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m03:26:41.611540 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.06 seconds
[0m03:26:41.618047 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: True
        Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
        Target columns not in source: []
        New column types: []
  
[0m03:26:41.618303 [debug] [Thread-2  ]: finished collecting timing info
[0m03:26:41.618431 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m03:26:41.713789 [debug] [Thread-2  ]: Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
            
  
  > in macro process_schema_changes (macros/materializations/models/incremental/on_schema_change.sql)
  > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
  > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m03:26:41.714094 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe478110ee0>]}
[0m03:26:41.714366 [error] [Thread-2  ]: 3 of 5 ERROR creating incremental model dev.fct_reviews ........................ [[31mERROR[0m in 2.25s]
[0m03:26:41.714715 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m03:26:41.715266 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m03:26:41.715434 [info ] [Thread-4  ]: 5 of 5 SKIP relation dev.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m03:26:41.715765 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m03:26:42.281227 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.61 seconds
[0m03:26:42.286166 [debug] [Thread-3  ]: finished collecting timing info
[0m03:26:42.286346 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m03:26:42.374212 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '214ce81d-e5a6-48ec-a9e0-f4d81fa2d507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4780455b0>]}
[0m03:26:42.374526 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.71s]
[0m03:26:42.374837 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m03:26:42.375828 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:26:42.376086 [info ] [MainThread]: 
[0m03:26:42.376277 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m03:26:42.376460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:42.376560 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m03:26:42.376655 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m03:26:42.376747 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m03:26:42.376839 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m03:26:42.385171 [info ] [MainThread]: 
[0m03:26:42.385409 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:26:42.385648 [info ] [MainThread]: 
[0m03:26:42.385832 [error] [MainThread]: [33mCompilation Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m03:26:42.386008 [error] [MainThread]:   
[0m03:26:42.386177 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m03:26:42.386345 [error] [MainThread]:                 They can be reconciled in several ways:
[0m03:26:42.386511 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m03:26:42.386686 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m03:26:42.386851 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m03:26:42.387016 [error] [MainThread]:             
[0m03:26:42.387181 [error] [MainThread]:   
[0m03:26:42.387346 [error] [MainThread]:   > in macro process_schema_changes (macros/materializations/models/incremental/on_schema_change.sql)
[0m03:26:42.387510 [error] [MainThread]:   > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
[0m03:26:42.387690 [error] [MainThread]:   > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m03:26:42.387868 [info ] [MainThread]: 
[0m03:26:42.388041 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m03:26:42.388285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4627bd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47bf41fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47ad537c0>]}


============================== 2022-07-30 03:27:17.577470 | 83897462-4b58-45b7-b7b9-c85041e296f2 ==============================
[0m03:27:17.577486 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:27:17.577837 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:27:17.577961 [debug] [MainThread]: Tracking: tracking
[0m03:27:17.578148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a31931250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a319312b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a31931310>]}
[0m03:27:17.599256 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m03:27:17.599539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3191d8e0>]}
[0m03:27:17.616227 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m03:27:17.617124 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m03:27:17.617604 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:27:17.651586 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:27:17.653539 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m03:27:17.654251 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m03:27:17.656942 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m03:27:17.664212 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m03:27:17.667251 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m03:27:17.668327 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m03:27:17.672020 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:27:17.672383 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:27:17.672791 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:27:17.673308 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:27:17.673750 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:27:17.680868 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:27:17.691556 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:27:17.695009 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:27:17.697404 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:27:17.707908 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:27:17.710026 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:27:17.711732 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:27:17.717062 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:27:17.719111 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:27:17.720274 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:27:17.721391 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:27:17.727627 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:27:17.730859 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:27:17.731505 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:27:17.732151 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:27:17.732809 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:27:17.733864 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:27:17.735634 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:27:17.738706 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:27:17.740039 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:27:17.741334 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:27:17.744529 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:27:17.757370 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:27:17.762470 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:27:17.763760 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:27:17.771985 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:27:17.783976 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:27:17.793415 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:27:17.803991 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:27:17.816083 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:27:17.822899 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:27:17.824016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:27:17.827288 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:27:17.829731 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:27:17.830784 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:27:17.834687 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:27:17.836383 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:27:17.838506 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:27:17.842543 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:27:17.844284 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:27:17.845840 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:27:17.846552 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:27:17.847484 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:27:17.848281 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:27:17.849013 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:27:17.849720 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:27:17.850745 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:27:17.851609 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:27:17.853045 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:27:17.853779 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:27:17.854514 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:27:17.855338 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:27:17.856121 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:27:17.856911 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:27:17.857819 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:27:17.858612 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:27:17.862846 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:27:17.863484 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:27:17.864130 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:27:17.864975 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:27:17.867195 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m03:27:17.873470 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m03:27:17.875040 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m03:27:17.879522 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m03:27:17.880249 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m03:27:17.887474 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m03:27:17.888916 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m03:27:17.890047 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m03:27:17.891015 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m03:27:17.892212 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m03:27:17.894353 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m03:27:17.895776 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m03:27:17.897310 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m03:27:17.899288 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m03:27:17.901946 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m03:27:17.902946 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m03:27:17.904184 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m03:27:17.904933 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m03:27:17.909568 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m03:27:17.912278 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m03:27:17.914088 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m03:27:17.915603 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m03:27:17.916458 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m03:27:17.917663 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m03:27:17.918615 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m03:27:17.919701 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m03:27:17.920502 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m03:27:17.924402 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m03:27:17.926454 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m03:27:17.927253 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m03:27:17.928328 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m03:27:17.929786 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m03:27:17.931786 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m03:27:17.932986 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m03:27:17.935910 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m03:27:17.937117 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m03:27:17.940064 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m03:27:17.941261 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m03:27:17.943329 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m03:27:17.949067 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m03:27:17.957444 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m03:27:17.958701 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m03:27:17.962878 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m03:27:17.966128 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m03:27:17.968586 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m03:27:17.971159 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m03:27:17.976759 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m03:27:17.980389 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m03:27:17.985229 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m03:27:17.989556 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m03:27:17.990684 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m03:27:17.991931 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m03:27:17.993671 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m03:27:17.994898 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m03:27:17.997426 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m03:27:17.998334 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m03:27:17.999262 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m03:27:18.000152 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m03:27:18.001033 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m03:27:18.018590 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m03:27:18.020091 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m03:27:18.021697 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m03:27:18.023330 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m03:27:18.024405 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m03:27:18.026504 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m03:27:18.028031 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m03:27:18.029363 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m03:27:18.031239 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m03:27:18.038052 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m03:27:18.040780 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m03:27:18.042413 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m03:27:18.043339 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m03:27:18.044271 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m03:27:18.045316 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m03:27:18.047417 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m03:27:18.048721 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m03:27:18.401084 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m03:27:18.408522 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m03:27:18.410061 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m03:27:18.411519 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m03:27:18.426515 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m03:27:18.427639 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m03:27:18.430023 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m03:27:18.431825 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m03:27:18.433625 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m03:27:18.548998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a2a5a9490>]}
[0m03:27:18.556439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a30147f10>]}
[0m03:27:18.556689 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m03:27:18.556882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3199c5e0>]}
[0m03:27:18.557944 [info ] [MainThread]: 
[0m03:27:18.558276 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:27:18.558970 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m03:27:18.567926 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m03:27:18.568111 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m03:27:18.568216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:19.404852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.84 seconds
[0m03:27:19.406099 [debug] [ThreadPool]: On list_airbnb: Close
[0m03:27:19.584943 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m03:27:19.590033 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:27:19.590177 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:27:19.590280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:20.228643 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.64 seconds
[0m03:27:20.229777 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:27:20.322091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3732beb0>]}
[0m03:27:20.322479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:27:20.322683 [info ] [MainThread]: 
[0m03:27:20.325805 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m03:27:20.326145 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m03:27:20.326286 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m03:27:20.326580 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m03:27:20.326911 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m03:27:20.327217 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m03:27:20.327381 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m03:27:20.327550 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m03:27:20.327737 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m03:27:20.327929 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m03:27:20.328112 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m03:27:20.328307 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m03:27:20.330444 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m03:27:20.332330 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m03:27:20.333715 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m03:27:20.334368 [debug] [Thread-2  ]: finished collecting timing info
[0m03:27:20.334575 [debug] [Thread-1  ]: finished collecting timing info
[0m03:27:20.334944 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m03:27:20.335313 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m03:27:20.335698 [debug] [Thread-3  ]: finished collecting timing info
[0m03:27:20.336454 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m03:27:20.337039 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m03:27:20.337229 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m03:27:20.337536 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m03:27:20.338037 [info ] [Thread-2  ]: 2 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m03:27:20.338342 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m03:27:20.338719 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m03:27:20.339168 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m03:27:20.339403 [info ] [Thread-1  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m03:27:20.339570 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m03:27:20.339718 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m03:27:20.340105 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m03:27:20.340230 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m03:27:20.340409 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m03:27:20.340562 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m03:27:20.354781 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m03:27:20.356085 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m03:27:20.356306 [debug] [Thread-1  ]: Compiling model.dbtlearn.fct_reviews
[0m03:27:20.356910 [debug] [Thread-4  ]: finished collecting timing info
[0m03:27:20.362287 [debug] [Thread-2  ]: finished collecting timing info
[0m03:27:20.366705 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m03:27:20.366965 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m03:27:20.367196 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m03:27:20.393822 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m03:27:20.394927 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m03:27:20.395551 [debug] [Thread-1  ]: finished collecting timing info
[0m03:27:20.395798 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m03:27:20.406963 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m03:27:20.412573 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m03:27:20.412807 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:27:20.413503 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m03:27:20.424088 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m03:27:20.424594 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT * FROM airbnb.raw.raw_listings
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m03:27:20.424882 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:27:20.426127 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m03:27:20.426272 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)
 
select 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) as review_id,  /*这个是扩展包里的surrogate_key*/
    * 
from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


      );
[0m03:27:20.426424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:21.318334 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.91 seconds
[0m03:27:21.331193 [debug] [Thread-2  ]: finished collecting timing info
[0m03:27:21.331411 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m03:27:21.442817 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a2968dbe0>]}
[0m03:27:21.443153 [info ] [Thread-2  ]: 2 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m03:27:21.443466 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m03:27:21.487207 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.06 seconds
[0m03:27:21.488480 [debug] [Thread-4  ]: finished collecting timing info
[0m03:27:21.488623 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m03:27:21.581313 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a2a575e20>]}
[0m03:27:21.581641 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.24s]
[0m03:27:21.581976 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m03:27:21.582446 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m03:27:21.582647 [info ] [Thread-3  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m03:27:21.583131 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m03:27:21.583475 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m03:27:21.583596 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m03:27:21.586173 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m03:27:21.586451 [debug] [Thread-3  ]: finished collecting timing info
[0m03:27:21.586573 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m03:27:21.594274 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m03:27:21.595031 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m03:27:21.595145 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m03:27:21.595249 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:27:22.674373 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.08 seconds
[0m03:27:22.678741 [debug] [Thread-3  ]: finished collecting timing info
[0m03:27:22.678880 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m03:27:22.765132 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3185bfd0>]}
[0m03:27:22.765554 [info ] [Thread-3  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 1.18s]
[0m03:27:22.766048 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m03:27:25.769828 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.34 seconds
[0m03:27:25.771244 [debug] [Thread-1  ]: finished collecting timing info
[0m03:27:25.771420 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m03:27:25.874839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a2a5eb520>]}
[0m03:27:25.875138 [info ] [Thread-1  ]: 3 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 1[0m in 5.53s]
[0m03:27:25.875441 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m03:27:25.876096 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m03:27:25.876295 [info ] [Thread-4  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m03:27:25.876634 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m03:27:25.876765 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m03:27:25.876892 [debug] [Thread-4  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m03:27:25.879582 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m03:27:25.879881 [debug] [Thread-4  ]: finished collecting timing info
[0m03:27:25.880049 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m03:27:25.881854 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m03:27:25.882505 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m03:27:25.882614 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)
 
select
    r.*,
    CASE
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_date))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m03:27:25.882718 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:27:29.687912 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.81 seconds
[0m03:27:29.689643 [debug] [Thread-4  ]: finished collecting timing info
[0m03:27:29.689846 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m03:27:29.791481 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83897462-4b58-45b7-b7b9-c85041e296f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a2a5c9280>]}
[0m03:27:29.791808 [info ] [Thread-4  ]: 5 of 5 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 3.91s]
[0m03:27:29.792134 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m03:27:29.793437 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m03:27:29.793710 [info ] [MainThread]: 
[0m03:27:29.793912 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 11.24 seconds (11.24s).
[0m03:27:29.794109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:29.794210 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m03:27:29.794317 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m03:27:29.794447 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m03:27:29.794547 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m03:27:29.803026 [info ] [MainThread]: 
[0m03:27:29.803360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:29.803584 [info ] [MainThread]: 
[0m03:27:29.803779 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m03:27:29.804041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3005b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a31953790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a319319a0>]}


============================== 2022-07-30 06:48:24.647487 | 1086dab3-19c8-46a9-9c6e-7a5b574c02d0 ==============================
06:48:24.647497 [info ] [MainThread]: Running with dbt=1.1.1
06:48:24.647873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
06:48:24.647982 [debug] [MainThread]: Tracking: tracking
06:48:24.648168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781991aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781991a070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78199a7d60>]}
06:48:24.670493 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.1.
06:48:24.670714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1086dab3-19c8-46a9-9c6e-7a5b574c02d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78198faa00>]}
06:48:24.699140 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
06:48:24.699947 [debug] [MainThread]: Parsing macros/postitve_value.sql
06:48:24.700403 [debug] [MainThread]: Parsing macros/adapters.sql
06:48:24.729296 [debug] [MainThread]: Parsing macros/catalog.sql
06:48:24.730749 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
06:48:24.731425 [debug] [MainThread]: Parsing macros/materializations/merge.sql
06:48:24.734327 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
06:48:24.740732 [debug] [MainThread]: Parsing macros/materializations/table.sql
06:48:24.743071 [debug] [MainThread]: Parsing macros/materializations/view.sql
06:48:24.744053 [debug] [MainThread]: Parsing macros/materializations/seed.sql
06:48:24.747824 [debug] [MainThread]: Parsing macros/adapters/columns.sql
06:48:24.754791 [debug] [MainThread]: Parsing macros/adapters/relation.sql
06:48:24.761906 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
06:48:24.765158 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
06:48:24.767271 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
06:48:24.769294 [debug] [MainThread]: Parsing macros/adapters/schema.sql
06:48:24.770904 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
06:48:24.776136 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
06:48:24.777922 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
06:48:24.779065 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
06:48:24.780137 [debug] [MainThread]: Parsing macros/etc/datetime.sql
06:48:24.786308 [debug] [MainThread]: Parsing macros/etc/statement.sql
06:48:24.789550 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
06:48:24.790073 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
06:48:24.790669 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
06:48:24.791305 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
06:48:24.792301 [debug] [MainThread]: Parsing macros/materializations/configs.sql
06:48:24.793994 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
06:48:24.796773 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
06:48:24.798120 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
06:48:24.799456 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
06:48:24.802822 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
06:48:24.814868 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
06:48:24.819324 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
06:48:24.820555 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
06:48:24.828495 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
06:48:24.840685 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
06:48:24.849944 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
06:48:24.860843 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
06:48:24.872521 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
06:48:24.879789 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
06:48:24.880909 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
06:48:24.884081 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
06:48:24.886000 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
06:48:24.887006 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
06:48:24.892017 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
06:48:24.893731 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
06:48:24.895790 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
06:48:24.901155 [debug] [MainThread]: Parsing tests/generic/builtin.sql
06:48:24.903265 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
06:48:24.909809 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
06:48:24.911393 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
06:48:24.915965 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
06:48:24.916667 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
06:48:24.923784 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
06:48:24.925149 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
06:48:24.926244 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
06:48:24.927210 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
06:48:24.928407 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
06:48:24.930599 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
06:48:24.931997 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
06:48:24.933365 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
06:48:24.935241 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
06:48:24.937788 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
06:48:24.938748 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
06:48:24.940231 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
06:48:24.941007 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
06:48:24.945592 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
06:48:24.948177 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
06:48:24.949853 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
06:48:24.951228 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
06:48:24.952136 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
06:48:24.953343 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
06:48:24.954456 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
06:48:24.955580 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
06:48:24.956435 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
06:48:24.960155 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
06:48:24.962217 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
06:48:24.963042 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
06:48:24.964111 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
06:48:24.965672 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
06:48:24.967586 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
06:48:24.968793 [debug] [MainThread]: Parsing macros/sql/star.sql
06:48:24.971748 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
06:48:24.973012 [debug] [MainThread]: Parsing macros/sql/pivot.sql
06:48:24.976119 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
06:48:24.977399 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
06:48:24.979472 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
06:48:24.985495 [debug] [MainThread]: Parsing macros/sql/union.sql
06:48:24.993983 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
06:48:24.995194 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
06:48:24.999235 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
06:48:25.002654 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
06:48:25.005175 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
06:48:25.007710 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
06:48:25.012979 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
06:48:25.016009 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
06:48:25.020642 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
06:48:25.024839 [debug] [MainThread]: Parsing macros/sql/groupby.sql
06:48:25.025816 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
06:48:25.027022 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
06:48:25.028714 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
06:48:25.029928 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
06:48:25.032518 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
06:48:25.033372 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
06:48:25.034294 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
06:48:25.035165 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
06:48:25.036005 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
06:48:25.053763 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
06:48:25.055160 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
06:48:25.056754 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
06:48:25.058206 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
06:48:25.059260 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
06:48:25.061314 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
06:48:25.062933 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
06:48:25.064223 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
06:48:25.065998 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
06:48:25.072614 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
06:48:25.075325 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
06:48:25.076947 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
06:48:25.077890 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
06:48:25.078829 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
06:48:25.079932 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
06:48:25.081920 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
06:48:25.083135 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
06:48:25.361144 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
06:48:25.369265 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
06:48:25.370921 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
06:48:25.372484 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
06:48:25.387954 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
06:48:25.389192 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
06:48:25.391043 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
06:48:25.392918 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
06:48:25.394834 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
06:48:25.537412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1086dab3-19c8-46a9-9c6e-7a5b574c02d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781998c880>]}
06:48:25.544128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1086dab3-19c8-46a9-9c6e-7a5b574c02d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7819862640>]}
06:48:25.544355 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 420 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
06:48:25.544501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1086dab3-19c8-46a9-9c6e-7a5b574c02d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781992e970>]}
06:48:25.545031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78199a7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781992e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f781998cac0>]}


============================== 2022-07-30 06:55:54.139756 | a6ea66e7-8622-4b4b-b93f-f86a2ceaeb97 ==============================
[0m06:55:54.139766 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:55:54.140061 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m06:55:54.140172 [debug] [MainThread]: Tracking: tracking
[0m06:55:54.146295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe596dfe580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe596dfe6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe596e694c0>]}
[0m06:55:54.449929 [debug] [MainThread]: Executing "git --help"
[0m06:55:54.453159 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:55:54.453452 [debug] [MainThread]: STDERR: "b''"
[0m06:55:54.455665 [debug] [MainThread]: Acquiring new snowflake connection "debug"
[0m06:55:54.456653 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:55:54.456779 [debug] [MainThread]: On debug: select 1 as id
[0m06:55:54.456881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:55:55.174348 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.72 seconds
[0m06:55:55.175105 [debug] [MainThread]: On debug: Close
[0m06:55:55.321131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe590ec3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe590ec3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe590ec3190>]}
[0m06:55:56.242389 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-30 07:01:42.584081 | 68fae867-7942-4e7c-913a-02b6d862510d ==============================
[0m07:01:42.584099 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:01:42.584461 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:01:42.584585 [debug] [MainThread]: Tracking: tracking
[0m07:01:42.584794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595b38370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595b381c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595b38430>]}
[0m07:01:42.606634 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.1.1. Current version: 1.2.0.
[0m07:01:42.607023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68fae867-7942-4e7c-913a-02b6d862510d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595b1e790>]}
[0m07:01:42.623439 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m07:01:42.624290 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m07:01:42.624756 [debug] [MainThread]: Parsing macros/adapters.sql
[0m07:01:42.657347 [debug] [MainThread]: Parsing macros/catalog.sql
[0m07:01:42.658679 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m07:01:42.659361 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m07:01:42.662016 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m07:01:42.668377 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m07:01:42.671070 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m07:01:42.672089 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m07:01:42.675686 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:01:42.676042 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:01:42.676452 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:01:42.676939 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:01:42.677416 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:01:42.684119 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:01:42.694180 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:01:42.697518 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:01:42.699654 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:01:42.709966 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:01:42.712074 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:01:42.713714 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:01:42.719024 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:01:42.720959 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:01:42.722123 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:01:42.723230 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:01:42.729343 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:01:42.732599 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:01:42.733131 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:01:42.733815 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:01:42.734492 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:01:42.735538 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:01:42.737320 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:01:42.740523 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:01:42.741868 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:01:42.743170 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:01:42.746451 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:01:42.760617 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:01:42.765725 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:01:42.766919 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:01:42.774798 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:01:42.786755 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:01:42.796586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:01:42.807676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:01:42.821737 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:01:42.829233 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:01:42.830538 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:01:42.833855 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:01:42.836437 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:01:42.837525 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:01:42.841441 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:01:42.843278 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:01:42.845452 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:01:42.849524 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:01:42.851366 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:01:42.853053 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:01:42.853814 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:01:42.854776 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:01:42.855604 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:01:42.856334 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:01:42.857109 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:01:42.858110 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:01:42.858980 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:01:42.860487 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:01:42.861231 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:01:42.861999 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:01:42.862870 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:01:42.863680 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:01:42.864547 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:01:42.865495 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:01:42.866306 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:01:42.870810 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:01:42.871458 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:01:42.872090 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:01:42.872931 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:01:42.875045 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m07:01:42.881675 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m07:01:42.883250 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m07:01:42.887740 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m07:01:42.888477 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m07:01:42.895345 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m07:01:42.896741 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m07:01:42.897844 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m07:01:42.898798 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m07:01:42.899975 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m07:01:42.902086 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m07:01:42.903469 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m07:01:42.905564 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m07:01:42.908636 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m07:01:42.911227 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m07:01:42.912202 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m07:01:42.913426 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m07:01:42.914169 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m07:01:42.918922 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m07:01:42.921660 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m07:01:42.923354 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m07:01:42.924712 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m07:01:42.925538 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m07:01:42.926703 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m07:01:42.927640 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m07:01:42.928709 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m07:01:42.929502 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m07:01:42.933431 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m07:01:42.935454 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m07:01:42.936247 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m07:01:42.937757 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m07:01:42.939176 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m07:01:42.940989 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m07:01:42.942139 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m07:01:42.944836 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m07:01:42.945995 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m07:01:42.948842 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m07:01:42.949993 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m07:01:42.951976 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m07:01:42.958064 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m07:01:42.966566 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m07:01:42.967830 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m07:01:42.972379 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m07:01:42.975280 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m07:01:42.977756 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m07:01:42.980127 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m07:01:42.985217 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m07:01:42.988320 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m07:01:42.992980 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m07:01:42.997163 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m07:01:42.998150 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m07:01:42.999377 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m07:01:43.001162 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m07:01:43.002421 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m07:01:43.004935 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m07:01:43.005787 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m07:01:43.006692 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m07:01:43.007606 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m07:01:43.008441 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m07:01:43.025917 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m07:01:43.027303 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m07:01:43.028871 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m07:01:43.030313 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m07:01:43.031408 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m07:01:43.033540 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m07:01:43.035099 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m07:01:43.036443 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m07:01:43.038320 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m07:01:43.044934 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m07:01:43.047604 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m07:01:43.049246 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m07:01:43.050169 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m07:01:43.051097 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m07:01:43.052165 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m07:01:43.054300 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m07:01:43.055529 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m07:01:43.396788 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m07:01:43.404715 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m07:01:43.406486 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m07:01:43.408173 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m07:01:43.424123 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m07:01:43.425392 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m07:01:43.428134 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m07:01:43.429975 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:01:43.431822 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m07:01:43.553804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68fae867-7942-4e7c-913a-02b6d862510d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5867ad640>]}
[0m07:01:43.561674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68fae867-7942-4e7c-913a-02b6d862510d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595ad1d60>]}
[0m07:01:43.561903 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:01:43.562107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68fae867-7942-4e7c-913a-02b6d862510d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59411eca0>]}
[0m07:01:43.563314 [info ] [MainThread]: 
[0m07:01:43.563648 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:01:43.564405 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:01:43.573149 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:01:43.573327 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:01:43.573435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:44.295820 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.72 seconds
[0m07:01:44.297326 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:01:44.382871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68fae867-7942-4e7c-913a-02b6d862510d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5867a33d0>]}
[0m07:01:44.383281 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:01:44.383497 [info ] [MainThread]: 
[0m07:01:44.387684 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:01:44.387925 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:01:44.388231 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:01:44.388408 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:01:44.388589 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:01:44.388959 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m07:01:44.389139 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:01:44.389433 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m07:01:44.389813 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m07:01:44.390017 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:01:44.390196 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:01:44.390388 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:01:44.390540 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:01:44.390732 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m07:01:44.393862 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:01:44.394126 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m07:01:44.394295 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m07:01:44.435715 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:01:44.437377 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:01:44.438815 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m07:01:44.439520 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.438948 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.439642 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:44.439807 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:01:44.440292 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:01:44.440626 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:01:44.440762 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.440921 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.441140 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:01:44.441829 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:01:44.442211 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:01:44.442525 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:01:44.442837 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:01:44.443104 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:01:44.443331 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:01:44.443733 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:01:44.444023 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m07:01:44.444168 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:01:44.444442 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:01:44.444589 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m07:01:44.444825 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m07:01:44.444999 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:01:44.445174 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:01:44.447601 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.447755 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:01:44.456072 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:01:44.456298 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m07:01:44.456558 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:01:44.456794 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m07:01:44.464220 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:01:44.464483 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.464686 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:44.474954 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:01:44.475370 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.475835 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:01:44.476044 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:01:44.476360 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:01:44.476495 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.476995 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:44.477191 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.477349 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:01:44.477736 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:01:44.478118 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:01:44.478274 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.478967 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:01:44.479767 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:01:44.480026 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:01:44.480158 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:01:44.480284 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m07:01:44.482569 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:01:44.482758 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:01:44.483022 [debug] [Thread-3  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:01:44.483390 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:01:44.483598 [debug] [Thread-4  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:01:44.483910 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:01:44.484097 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.484310 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:01:44.484612 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m07:01:44.484786 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:01:44.484992 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:01:44.485199 [debug] [Thread-2  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m07:01:44.485413 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:01:44.485597 [debug] [Thread-3  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:01:44.485808 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.488232 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:01:44.488442 [debug] [Thread-4  ]: Compiling test.dbtlearn.consistent_created_at
[0m07:01:44.492195 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:01:44.492609 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:01:44.494689 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:01:44.495222 [debug] [Thread-1  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:01:44.495448 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:44.496136 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m07:01:44.496301 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.496521 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:01:44.496695 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:01:44.496857 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.497019 [debug] [Thread-3  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:01:44.497208 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:44.497352 [debug] [Thread-1  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m07:01:44.497501 [debug] [Thread-4  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:01:44.497661 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.497999 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:01:44.501799 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:01:44.502072 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.502572 [debug] [Thread-3  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:01:44.502838 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:01:44.503434 [debug] [Thread-4  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:01:44.503829 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:01:44.504020 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.504495 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:01:44.504731 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:01:44.505140 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:01:44.505337 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:01:44.505519 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:01:44.505775 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:01:44.505961 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:01:44.506293 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.506455 [debug] [Thread-2  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m07:01:44.506610 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:01:44.506761 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:01:44.507155 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:01:44.514694 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:01:44.514894 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:01:44.520964 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:01:44.521211 [debug] [Thread-1  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:01:44.521531 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:01:44.524107 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:01:44.524517 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:01:44.524769 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:01:44.524887 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.525194 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:01:44.526161 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.526333 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:01:44.527520 [debug] [Thread-1  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:01:44.527689 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:01:44.527889 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.530771 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:01:44.531097 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.531566 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:01:44.532064 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:01:44.532326 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:01:44.532728 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:01:44.532884 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.533301 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:01:44.533572 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:01:44.533727 [debug] [Thread-1  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:01:44.533917 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:01:44.534092 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:01:44.534242 [debug] [Thread-1  ]: finished collecting timing info
[0m07:01:44.534416 [debug] [Thread-3  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:01:44.534582 [debug] [Thread-4  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:01:44.534908 [debug] [Thread-1  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:01:44.540432 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:01:44.545180 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:01:44.545880 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.546030 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:01:44.546156 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.546351 [debug] [Thread-3  ]: finished collecting timing info
[0m07:01:44.546537 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:01:44.546946 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:01:44.547129 [debug] [Thread-4  ]: finished collecting timing info
[0m07:01:44.547816 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:01:45.002991 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0.48 seconds
[0m07:01:45.004529 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:01:45.004852 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:45.004992 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:01:45.005119 [debug] [Thread-2  ]: finished collecting timing info
[0m07:01:45.005246 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:01:45.096089 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:01:45.097320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:01:45.097444 [debug] [MainThread]: Connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313' was properly closed.
[0m07:01:45.097547 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:01:45.097647 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m07:01:45.097745 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:01:45.105948 [info ] [MainThread]: Done.
[0m07:01:45.109742 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m07:01:45.109872 [info ] [MainThread]: Building catalog
[0m07:01:45.111268 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m07:01:45.116694 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m07:01:45.116827 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m07:01:45.116935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:47.040031 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 1.92 seconds
[0m07:01:47.054700 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m07:01:47.198613 [info ] [MainThread]: Catalog written to /home/damonfoo/dbtCourse/dbtlearn/target/catalog.json
[0m07:01:47.198988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5940586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595ba4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595ad13d0>]}
[0m07:01:48.121345 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:01:48.121764 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-07-30 07:05:42.790421 | 414bd2ae-76ed-4954-80bc-e5b6def7a061 ==============================
[0m07:05:42.790436 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:05:42.790772 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m07:05:42.790885 [debug] [MainThread]: Tracking: tracking
[0m07:05:42.791072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c33adc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c33adc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c33adc430>]}
[0m07:05:42.792336 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m07:05:42.792522 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m07:05:42.792777 [info ] [MainThread]: 
[0m07:05:42.792991 [info ] [MainThread]: 
[0m07:05:42.793174 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-30 07:16:19.387275 | ee4c6cfa-a7af-491d-ae68-6a07b8ea42c0 ==============================
[0m07:16:19.387291 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:16:19.387678 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:16:19.387794 [debug] [MainThread]: Tracking: tracking
[0m07:16:19.388048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237f733a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237f73400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237f73460>]}
[0m07:16:19.412620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237f9f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237f29e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe237f29ee0>]}


============================== 2022-07-30 07:19:24.656211 | 36768a32-2b5e-4ab8-9317-5a0ca83b3931 ==============================
[0m07:19:24.656227 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:19:24.656583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:19:24.656704 [debug] [MainThread]: Tracking: tracking
[0m07:19:24.656895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e865ab370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e865ab1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e865ab400>]}
[0m07:19:24.694461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:19:24.694788 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/docs.md
[0m07:19:24.695067 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m07:19:24.705407 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:19:24.767799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e842b05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e842b09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8432ad30>]}


============================== 2022-07-30 07:19:43.092729 | e7acf78c-cca4-4dce-9ca2-fda8d59a215a ==============================
[0m07:19:43.092746 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:19:43.093086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:19:43.093201 [debug] [MainThread]: Tracking: tracking
[0m07:19:43.093388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0b423d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0b42430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0b42460>]}
[0m07:19:43.131518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:19:43.131816 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/docs.md
[0m07:19:43.132088 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m07:19:43.142199 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:19:43.186187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79d830610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79d830a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79d8aad90>]}


============================== 2022-07-30 07:20:06.598468 | b46395d6-4dd3-40b9-a6b0-bc4d189cb29e ==============================
[0m07:20:06.598485 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:20:06.598839 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:20:06.598957 [debug] [MainThread]: Tracking: tracking
[0m07:20:06.599156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ed6b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ed6b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ed6b460>]}
[0m07:20:06.636018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:20:06.636326 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/docs.md
[0m07:20:06.636602 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m07:20:06.646938 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:20:06.691381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ca70610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3ca70a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3cae9d90>]}


============================== 2022-07-30 07:21:18.947195 | 656fe4f0-a93c-4763-ae92-11c0bd07fdfa ==============================
[0m07:21:18.947211 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:21:18.947549 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:21:18.947688 [debug] [MainThread]: Tracking: tracking
[0m07:21:18.947897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376b06e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376b06e1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376b06e460>]}
[0m07:21:18.986136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:21:18.986455 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/docs.md
[0m07:21:18.986729 [debug] [MainThread]: Partial parsing: update schema file: dbtlearn://models/schema.yml
[0m07:21:18.997245 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:21:19.049711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '656fe4f0-a93c-4763-ae92-11c0bd07fdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37681635e0>]}
[0m07:21:19.057302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '656fe4f0-a93c-4763-ae92-11c0bd07fdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3769edd5e0>]}
[0m07:21:19.057519 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:21:19.057717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '656fe4f0-a93c-4763-ae92-11c0bd07fdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3769edd820>]}
[0m07:21:19.058978 [info ] [MainThread]: 
[0m07:21:19.059332 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:21:19.060072 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:21:19.069091 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:21:19.069297 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:21:19.069410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:20.203469 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.13 seconds
[0m07:21:20.204700 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:21:20.368041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '656fe4f0-a93c-4763-ae92-11c0bd07fdfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376b08c8b0>]}
[0m07:21:20.368425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:21:20.368638 [info ] [MainThread]: 
[0m07:21:20.372118 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:21:20.372331 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:21:20.372681 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:21:20.372848 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:21:20.373183 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m07:21:20.373334 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:21:20.373552 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:21:20.373853 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m07:21:20.374045 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:21:20.374468 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m07:21:20.374672 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:21:20.374873 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:21:20.375063 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m07:21:20.375258 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:21:20.377657 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:21:20.377908 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m07:21:20.379979 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:21:20.380252 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m07:21:20.381868 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:21:20.382517 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.384203 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m07:21:20.384667 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:20.385270 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:21:20.385526 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.385698 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.386090 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:21:20.386342 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:21:20.386542 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:21:20.387230 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:21:20.387457 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:21:20.387924 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:21:20.388110 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.388324 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:21:20.388622 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:21:20.388988 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:21:20.389346 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:21:20.389614 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:21:20.389791 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:21:20.389976 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m07:21:20.390188 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m07:21:20.390376 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:21:20.390634 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:21:20.394002 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.394333 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m07:21:20.394524 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m07:21:20.402516 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:21:20.402794 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:21:20.403036 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:21:20.408915 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:21:20.409212 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.409510 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m07:21:20.409662 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:20.410196 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:21:20.415595 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.421203 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:21:20.433205 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:21:20.433708 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:21:20.433935 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:20.434212 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.434704 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:21:20.434887 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.435285 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:21:20.435655 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:21:20.436034 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.436311 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:21:20.437165 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:21:20.437398 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:21:20.437527 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:21:20.437651 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m07:21:20.439822 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:21:20.440069 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:21:20.440307 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:21:20.440586 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.440715 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:21:20.440883 [debug] [Thread-3  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:21:20.441089 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:21:20.441235 [debug] [Thread-4  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:21:20.441424 [debug] [Thread-2  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m07:21:20.441699 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:21:20.441893 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.442170 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m07:21:20.445038 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:21:20.445223 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:21:20.445570 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:21:20.445762 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:21:20.446087 [debug] [Thread-3  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:21:20.446226 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:20.446455 [debug] [Thread-1  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:21:20.446654 [debug] [Thread-4  ]: Compiling test.dbtlearn.consistent_created_at
[0m07:21:20.450496 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:21:20.450756 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:21:20.451071 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m07:21:20.453063 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:21:20.453346 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:20.453590 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:21:20.453758 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.454258 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:21:20.454402 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.454631 [debug] [Thread-1  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m07:21:20.454824 [debug] [Thread-3  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:21:20.455055 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:21:20.455258 [debug] [Thread-4  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:21:20.457187 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:21:20.457389 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.457665 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:21:20.457853 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.458310 [debug] [Thread-3  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:21:20.458476 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.458678 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:21:20.459030 [debug] [Thread-4  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:21:20.459266 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:21:20.459472 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:21:20.459753 [debug] [Thread-2  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m07:21:20.459967 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:21:20.460311 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:21:20.460588 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.466141 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:21:20.468804 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:21:20.469010 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:21:20.469397 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:21:20.469578 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:21:20.469755 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:21:20.469943 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:21:20.470181 [debug] [Thread-1  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:21:20.470369 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:21:20.470634 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:21:20.476231 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:21:20.477678 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:21:20.480098 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:21:20.482005 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:21:20.482620 [debug] [Thread-1  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:21:20.485476 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:21:20.485649 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.486065 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:21:20.486375 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.486701 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:21:20.486844 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.487061 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:21:20.487194 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.487406 [debug] [Thread-1  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:21:20.487780 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:21:20.487965 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:21:20.488156 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.488340 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:21:20.488515 [debug] [Thread-4  ]: finished collecting timing info
[0m07:21:20.488939 [debug] [Thread-1  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:21:20.489159 [debug] [Thread-3  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:21:20.489471 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:21:20.489704 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:21:20.493212 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:21:20.493774 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:21:20.494039 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:21:20.494169 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:21:20.498460 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:21:20.498728 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.498882 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:21:20.499058 [debug] [Thread-3  ]: finished collecting timing info
[0m07:21:20.499657 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:21:20.500125 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.500264 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:21:20.500392 [debug] [Thread-1  ]: finished collecting timing info
[0m07:21:20.500688 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:21:21.202041 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0.73 seconds
[0m07:21:21.203404 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:21:21.203654 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:21.203772 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:21:21.203888 [debug] [Thread-2  ]: finished collecting timing info
[0m07:21:21.204004 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:21:21.323879 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:21:21.325143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:21.325273 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:21:21.325401 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:21:21.325511 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m07:21:21.325624 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m07:21:21.334835 [info ] [MainThread]: Done.
[0m07:21:21.336275 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m07:21:21.336387 [info ] [MainThread]: Building catalog
[0m07:21:21.337803 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m07:21:21.343351 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m07:21:21.343552 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m07:21:21.343649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:23.524027 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 2.18 seconds
[0m07:21:23.535705 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m07:21:23.647323 [info ] [MainThread]: Catalog written to /home/damonfoo/dbtCourse/dbtlearn/target/catalog.json
[0m07:21:23.647725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376b06e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37680c4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376b0eaa60>]}
[0m07:21:24.566216 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:21:24.566547 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-07-30 07:21:40.429288 | da24437b-7b4d-4ca9-a332-80d20c5a877a ==============================
[0m07:21:40.429304 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:21:40.429646 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m07:21:40.429762 [debug] [MainThread]: Tracking: tracking
[0m07:21:40.429962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ef54d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ef54d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ef54d4c0>]}
[0m07:21:40.431219 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m07:21:40.431408 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m07:21:40.431582 [info ] [MainThread]: 
[0m07:21:40.431735 [info ] [MainThread]: 
[0m07:21:40.431900 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-30 07:26:00.327011 | a9dae66e-1f3d-4161-b692-129b6bb27632 ==============================
[0m07:26:00.327027 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:26:00.327372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:26:00.327491 [debug] [MainThread]: Tracking: tracking
[0m07:26:00.327684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3b68340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3b683a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3b683d0>]}
[0m07:26:00.368013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:26:00.368347 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/overview.md
[0m07:26:00.378120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9dae66e-1f3d-4161-b692-129b6bb27632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3969820>]}
[0m07:26:00.385811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9dae66e-1f3d-4161-b692-129b6bb27632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3a64700>]}
[0m07:26:00.386048 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:26:00.386250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dae66e-1f3d-4161-b692-129b6bb27632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3a64880>]}
[0m07:26:00.387510 [info ] [MainThread]: 
[0m07:26:00.387861 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:26:00.388616 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:26:00.397625 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:26:00.397774 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:26:00.397884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:01.001793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.6 seconds
[0m07:26:01.003351 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:26:01.105906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dae66e-1f3d-4161-b692-129b6bb27632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a39b97c0>]}
[0m07:26:01.106298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:26:01.106517 [info ] [MainThread]: 
[0m07:26:01.109969 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:26:01.110252 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:26:01.110384 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:26:01.110526 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:26:01.146385 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:26:01.148130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:26:01.148313 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:26:01.148609 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m07:26:01.148761 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:26:01.149146 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m07:26:01.149400 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:26:01.149610 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.149990 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m07:26:01.150202 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:26:01.150385 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m07:26:01.150826 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:26:01.151043 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:26:01.151346 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m07:26:01.153375 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:26:01.153628 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:26:01.153835 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m07:26:01.155269 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:26:01.155658 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:26:01.156970 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m07:26:01.157164 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.157463 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:26:01.157631 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.157825 [debug] [Thread-4  ]: finished collecting timing info
[0m07:26:01.158200 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:26:01.158383 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m07:26:01.158730 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:26:01.158942 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:26:01.159165 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:26:01.161444 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.161858 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:26:01.162198 [debug] [Thread-4  ]: finished collecting timing info
[0m07:26:01.162491 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:26:01.162695 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:26:01.162971 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:26:01.163322 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:26:01.163514 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:26:01.163708 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.163858 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:26:01.164090 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m07:26:01.164413 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:26:01.164753 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:26:01.164936 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m07:26:01.165215 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m07:26:01.173757 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:26:01.179462 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:26:01.180349 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:26:01.180634 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m07:26:01.186171 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.196883 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:26:01.197090 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.197233 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.197626 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:26:01.203003 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:26:01.203255 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:26:01.203731 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.204073 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:26:01.204754 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:26:01.205017 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:26:01.205211 [debug] [Thread-2  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:26:01.205368 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:26:01.205523 [debug] [Thread-4  ]: finished collecting timing info
[0m07:26:01.205677 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:26:01.205993 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:26:01.206187 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m07:26:01.206377 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:26:01.206672 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m07:26:01.206858 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:26:01.209222 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:26:01.209419 [debug] [Thread-4  ]: finished collecting timing info
[0m07:26:01.209608 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:26:01.209801 [debug] [Thread-2  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:26:01.210250 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:26:01.210492 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m07:26:01.210662 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.219888 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:26:01.220166 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:26:01.221929 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:26:01.222370 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:26:01.222792 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:26:01.223166 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.223386 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.223602 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:26:01.223747 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.224127 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:26:01.224324 [debug] [Thread-2  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:26:01.224512 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m07:26:01.224702 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:26:01.224929 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:26:01.225137 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.236090 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.236824 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:26:01.237266 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:26:01.237835 [debug] [Thread-2  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:26:01.238325 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:26:01.238568 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:26:01.238801 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:26:01.239059 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:26:01.239286 [debug] [Thread-3  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:26:01.239638 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:26:01.239838 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:26:01.240143 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:26:01.240442 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:26:01.249082 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:26:01.249288 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:26:01.249625 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:26:01.249899 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:26:01.250155 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.250337 [debug] [Thread-3  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:26:01.253084 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:26:01.253308 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:26:01.256273 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:26:01.256617 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.256798 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.257101 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:26:01.257305 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.257681 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:26:01.257877 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.258066 [debug] [Thread-3  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:26:01.258299 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:26:01.258665 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:26:01.258977 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.259250 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:26:01.259487 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:26:01.259843 [debug] [Thread-3  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:26:01.260119 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:26:01.260394 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:26:01.260616 [debug] [Thread-3  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:26:01.260824 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:26:01.261093 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:26:01.261368 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:26:01.267172 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:26:01.267463 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:26:01.267741 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:26:01.273780 [debug] [Thread-3  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m07:26:01.274199 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:26:01.276307 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:26:01.276543 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.277020 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.277200 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:26:01.277742 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:26:01.277889 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.278150 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.278358 [debug] [Thread-2  ]: finished collecting timing info
[0m07:26:01.278549 [debug] [Thread-3  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:26:01.278934 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:26:01.279270 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:26:01.279462 [debug] [Thread-3  ]: finished collecting timing info
[0m07:26:01.279692 [debug] [Thread-1  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:26:01.280253 [debug] [Thread-3  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:26:01.280535 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m07:26:01.280890 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:26:01.281004 [debug] [Thread-1  ]: Compiling test.dbtlearn.consistent_created_at
[0m07:26:01.282951 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:26:01.283201 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.283318 [debug] [Thread-1  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:26:01.283429 [debug] [Thread-1  ]: finished collecting timing info
[0m07:26:01.283725 [debug] [Thread-1  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:26:01.606179 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.37 seconds
[0m07:26:01.607684 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:26:01.607939 [debug] [Thread-4  ]: finished collecting timing info
[0m07:26:01.608061 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:26:01.608179 [debug] [Thread-4  ]: finished collecting timing info
[0m07:26:01.608300 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:26:01.705458 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:26:01.706543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:01.706684 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m07:26:01.706787 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:26:01.706881 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m07:26:01.706977 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:26:01.714635 [info ] [MainThread]: Done.
[0m07:26:01.715997 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m07:26:01.716108 [info ] [MainThread]: Building catalog
[0m07:26:01.717764 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m07:26:01.723189 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m07:26:01.723342 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m07:26:01.723458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:03.116266 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 1.39 seconds
[0m07:26:03.129261 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m07:26:03.249602 [info ] [MainThread]: Catalog written to /home/damonfoo/dbtCourse/dbtlearn/target/catalog.json
[0m07:26:03.249960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3b68340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a04de670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a05c0640>]}
[0m07:26:04.129427 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:26:04.129776 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-07-30 07:26:11.296806 | 9740d84f-74cf-483d-bc9c-c5aab08e9bcd ==============================
[0m07:26:11.296824 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:26:11.297169 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m07:26:11.297303 [debug] [MainThread]: Tracking: tracking
[0m07:26:11.297503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ef1e9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ef1e93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ef1e9400>]}
[0m07:26:11.298781 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m07:26:11.298978 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m07:26:11.299161 [info ] [MainThread]: 
[0m07:26:11.299384 [info ] [MainThread]: 
[0m07:26:11.299588 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-30 07:33:16.377905 | f92add02-a874-4f81-b91b-ef563daa455e ==============================
[0m07:33:16.377922 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:33:16.378256 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:33:16.378373 [debug] [MainThread]: Tracking: tracking
[0m07:33:16.378561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e2c35310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e2c35370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e2c353d0>]}
[0m07:33:16.400603 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:33:16.400869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f92add02-a874-4f81-b91b-ef563daa455e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e2c54370>]}
[0m07:33:16.416713 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m07:33:16.417550 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m07:33:16.417997 [debug] [MainThread]: Parsing macros/adapters.sql
[0m07:33:16.449750 [debug] [MainThread]: Parsing macros/catalog.sql
[0m07:33:16.451223 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m07:33:16.452033 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m07:33:16.455056 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m07:33:16.463763 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m07:33:16.467112 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m07:33:16.468150 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m07:33:16.472078 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:33:16.472451 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:33:16.473019 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:33:16.473542 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:33:16.474002 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:33:16.481147 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:33:16.491398 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:33:16.495198 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:33:16.497392 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:33:16.507395 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:33:16.509501 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:33:16.511161 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:33:16.516413 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:33:16.518391 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:33:16.519536 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:33:16.520609 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:33:16.526651 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:33:16.529909 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:33:16.530441 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:33:16.531046 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:33:16.531693 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:33:16.532735 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:33:16.534425 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:33:16.537354 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:33:16.538794 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:33:16.540124 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:33:16.543452 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:33:16.557096 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:33:16.561947 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:33:16.563187 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:33:16.571821 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:33:16.583747 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:33:16.592711 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:33:16.604074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:33:16.615634 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:33:16.622349 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:33:16.623520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:33:16.626803 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:33:16.629371 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:33:16.630572 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:33:16.634442 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:33:16.636207 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:33:16.638432 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:33:16.642306 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:33:16.644085 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:33:16.645701 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:33:16.646664 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:33:16.647756 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:33:16.648641 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:33:16.649366 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:33:16.650139 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:33:16.651106 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:33:16.652128 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:33:16.653682 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:33:16.654418 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:33:16.655175 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:33:16.656098 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:33:16.656911 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:33:16.657777 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:33:16.658851 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:33:16.659815 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:33:16.664401 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:33:16.665092 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:33:16.665740 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:33:16.666573 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:33:16.668759 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m07:33:16.675513 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m07:33:16.677180 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m07:33:16.681363 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m07:33:16.682103 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m07:33:16.688956 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m07:33:16.690335 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m07:33:16.691441 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m07:33:16.692398 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m07:33:16.693688 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m07:33:16.695815 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m07:33:16.697251 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m07:33:16.698737 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m07:33:16.700664 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m07:33:16.703170 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m07:33:16.704145 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m07:33:16.705363 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m07:33:16.706119 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m07:33:16.710888 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m07:33:16.713539 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m07:33:16.715231 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m07:33:16.716595 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m07:33:16.717423 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m07:33:16.718602 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m07:33:16.719534 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m07:33:16.720597 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m07:33:16.721387 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m07:33:16.725462 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m07:33:16.727546 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m07:33:16.728367 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m07:33:16.729418 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m07:33:16.730855 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m07:33:16.732709 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m07:33:16.733851 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m07:33:16.736726 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m07:33:16.737898 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m07:33:16.740877 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m07:33:16.742077 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m07:33:16.744017 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m07:33:16.749873 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m07:33:16.758243 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m07:33:16.759498 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m07:33:16.763627 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m07:33:16.766823 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m07:33:16.769318 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m07:33:16.771928 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m07:33:16.777218 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m07:33:16.780377 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m07:33:16.785153 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m07:33:16.789505 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m07:33:16.790516 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m07:33:16.791750 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m07:33:16.793510 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m07:33:16.794744 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m07:33:16.797246 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m07:33:16.798089 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m07:33:16.799022 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m07:33:16.799911 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m07:33:16.801097 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m07:33:16.819910 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m07:33:16.821262 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m07:33:16.822891 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m07:33:16.824368 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m07:33:16.825440 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m07:33:16.827594 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m07:33:16.829170 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m07:33:16.830483 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m07:33:16.832523 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m07:33:16.838690 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m07:33:16.841392 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m07:33:16.842979 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m07:33:16.843911 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m07:33:16.844845 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m07:33:16.845900 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m07:33:16.847965 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m07:33:16.849225 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m07:33:17.200973 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m07:33:17.208634 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m07:33:17.210216 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m07:33:17.211699 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m07:33:17.227210 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m07:33:17.228432 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m07:33:17.230283 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m07:33:17.231870 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:33:17.233481 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m07:33:17.352879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92add02-a874-4f81-b91b-ef563daa455e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e0133c10>]}
[0m07:33:17.360139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f92add02-a874-4f81-b91b-ef563daa455e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e1ae5a00>]}
[0m07:33:17.360367 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:33:17.360565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92add02-a874-4f81-b91b-ef563daa455e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e0147df0>]}
[0m07:33:17.361743 [info ] [MainThread]: 
[0m07:33:17.362078 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:33:17.363032 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:33:17.372133 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:33:17.372328 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:33:17.372461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:18.391334 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.02 seconds
[0m07:33:18.392854 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:33:18.551038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92add02-a874-4f81-b91b-ef563daa455e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e0140b20>]}
[0m07:33:18.551440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:33:18.551658 [info ] [MainThread]: 
[0m07:33:18.591510 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:33:18.591895 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:33:18.592044 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:33:18.592178 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:33:18.594538 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:33:18.594750 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:33:18.595027 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:33:18.595327 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m07:33:18.595647 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:33:18.595835 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.596091 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m07:33:18.596275 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:33:18.596555 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m07:33:18.596746 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m07:33:18.596919 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:33:18.597105 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m07:33:18.597288 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:33:18.597486 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.597653 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m07:33:18.599593 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:33:18.599789 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m07:33:18.600147 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:33:18.601254 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:33:18.602555 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m07:33:18.602699 [debug] [Thread-2  ]: finished collecting timing info
[0m07:33:18.602937 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:33:18.603401 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.603877 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.604040 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m07:33:18.604386 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:33:18.604577 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:33:18.604759 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m07:33:18.604951 [debug] [Thread-2  ]: finished collecting timing info
[0m07:33:18.605135 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:33:18.605326 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.605503 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.605842 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:33:18.606014 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m07:33:18.606349 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:33:18.606666 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:33:18.606889 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:33:18.609901 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.610539 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:33:18.611163 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:33:18.611408 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m07:33:18.611561 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:33:18.611805 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:33:18.611987 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:33:18.612227 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m07:33:18.612418 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.612567 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:33:18.612765 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:33:18.612947 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:33:18.613418 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:33:18.613561 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m07:33:18.616505 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:33:18.616696 [debug] [Thread-3  ]: Compiling model.dbtlearn.fct_reviews
[0m07:33:18.618691 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:33:18.623546 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:33:18.624156 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.624407 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:33:18.624549 [debug] [Thread-2  ]: finished collecting timing info
[0m07:33:18.624716 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.624915 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.625110 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:33:18.625491 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:33:18.625670 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:33:18.625892 [debug] [Thread-2  ]: finished collecting timing info
[0m07:33:18.626464 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.626716 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:33:18.627135 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:33:18.627281 [debug] [Thread-4  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:33:18.627638 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:33:18.627885 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:33:18.628126 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:33:18.628387 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m07:33:18.628819 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:33:18.628986 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:33:18.629474 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:33:18.629717 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:33:18.629981 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:33:18.630126 [debug] [Thread-1  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:33:18.630301 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:33:18.630480 [debug] [Thread-4  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m07:33:18.630653 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:33:18.634583 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:33:18.634771 [debug] [Thread-2  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m07:33:18.636421 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:33:18.636596 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:33:18.650342 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:33:18.651207 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:33:18.651427 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:33:18.651612 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.652133 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:33:18.652422 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.654744 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:33:18.652656 [debug] [Thread-4  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:33:18.652834 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.654900 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.655108 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.655307 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:33:18.655731 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:33:18.656111 [debug] [Thread-4  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:33:18.656317 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.656547 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:33:18.656767 [debug] [Thread-4  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:33:18.657231 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:33:18.657519 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:33:18.657794 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:33:18.658012 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:33:18.658213 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:33:18.658467 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:33:18.658742 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:33:18.658928 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:33:18.659105 [debug] [Thread-4  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:33:18.659263 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:33:18.662257 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:33:18.664850 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:33:18.665051 [debug] [Thread-1  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:33:18.665717 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.665897 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.669942 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:33:18.670158 [debug] [Thread-4  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:33:18.670350 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:33:18.670659 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.670858 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.671032 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.671401 [debug] [Thread-4  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:33:18.671579 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:33:18.671898 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:33:18.672122 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:33:18.672337 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.672656 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:33:18.673018 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:33:18.673349 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:33:18.673611 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:33:18.673799 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:33:18.674024 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:33:18.674211 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:33:18.674473 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m07:33:18.674745 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:33:18.674914 [debug] [Thread-3  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:33:18.676915 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:33:18.677154 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:33:18.681263 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:33:18.681726 [debug] [Thread-1  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m07:33:18.682024 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.682536 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.685261 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:33:18.685535 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:33:18.685750 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:33:18.686103 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.686357 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.686541 [debug] [Thread-3  ]: finished collecting timing info
[0m07:33:18.687008 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:33:18.687190 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:33:18.687650 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:33:18.687951 [debug] [Thread-4  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:33:18.688144 [debug] [Thread-1  ]: finished collecting timing info
[0m07:33:18.688692 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m07:33:18.689033 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:33:18.689225 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:33:18.689476 [debug] [Thread-4  ]: Compiling test.dbtlearn.consistent_created_at
[0m07:33:18.691618 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:33:18.691962 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.692077 [debug] [Thread-4  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:33:18.692184 [debug] [Thread-4  ]: finished collecting timing info
[0m07:33:18.692438 [debug] [Thread-4  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:33:19.130642 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0.48 seconds
[0m07:33:19.132943 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:33:19.133325 [debug] [Thread-2  ]: finished collecting timing info
[0m07:33:19.133451 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:33:19.133570 [debug] [Thread-2  ]: finished collecting timing info
[0m07:33:19.133693 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:33:19.266655 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:33:19.267867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:19.267991 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m07:33:19.268087 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:33:19.268186 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m07:33:19.268280 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m07:33:19.276176 [info ] [MainThread]: Done.
[0m07:33:19.277983 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m07:33:19.278106 [info ] [MainThread]: Building catalog
[0m07:33:19.279867 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m07:33:19.284927 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m07:33:19.285100 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m07:33:19.285226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:21.571598 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 2.29 seconds
[0m07:33:21.583038 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m07:33:21.690331 [info ] [MainThread]: Catalog written to /home/damonfoo/dbtCourse/dbtlearn/target/catalog.json
[0m07:33:21.690659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e2c35310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e1b60820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e1b60a60>]}
[0m07:33:22.584047 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:33:22.584490 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-07-30 07:33:29.432877 | c129a25b-f2be-47a9-b31e-3c07b110415c ==============================
[0m07:33:29.432893 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:33:29.433269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m07:33:29.433384 [debug] [MainThread]: Tracking: tracking
[0m07:33:29.433580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f074b9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f074b95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f074b9610>]}
[0m07:33:29.435740 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m07:33:29.436096 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m07:33:29.436340 [info ] [MainThread]: 
[0m07:33:29.436519 [info ] [MainThread]: 
[0m07:33:29.436694 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-30 07:44:29.984924 | 651492f1-38d4-4047-b07f-b45286e5c256 ==============================
[0m07:44:29.984941 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:44:29.985279 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['src_hosts+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:44:29.985391 [debug] [MainThread]: Tracking: tracking
[0m07:44:29.985582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde566f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde566f1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde566f1460>]}
[0m07:44:30.024272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:30.024451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:30.029037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde554e6040>]}
[0m07:44:30.037279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde555c4640>]}
[0m07:44:30.037538 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:44:30.037744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde554e0fd0>]}
[0m07:44:30.038820 [info ] [MainThread]: 
[0m07:44:30.039169 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:44:30.039876 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m07:44:30.049287 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m07:44:30.049496 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m07:44:30.049624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:30.759538 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.71 seconds
[0m07:44:30.760813 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:44:30.865067 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:44:30.870157 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:44:30.870419 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:44:30.870535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:31.398055 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.53 seconds
[0m07:44:31.399306 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:44:31.489456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde555c4460>]}
[0m07:44:31.489852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:31.490081 [info ] [MainThread]: 
[0m07:44:31.493211 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:44:31.493439 [info ] [Thread-1  ]: 1 of 3 START view model dev.src_hosts .......................................... [RUN]
[0m07:44:31.494019 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:44:31.494159 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:44:31.494303 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:44:31.496315 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:44:31.496622 [debug] [Thread-1  ]: finished collecting timing info
[0m07:44:31.496744 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m07:44:31.548447 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.src_hosts"
[0m07:44:31.549064 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m07:44:31.549222 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace  view airbnb.dev.src_hosts
  
   as (
    with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
  );
[0m07:44:31.549345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:44:32.065261 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m07:44:32.076333 [debug] [Thread-1  ]: finished collecting timing info
[0m07:44:32.076515 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m07:44:32.166895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5677a160>]}
[0m07:44:32.167211 [info ] [Thread-1  ]: 1 of 3 OK created view model dev.src_hosts ..................................... [[32mSUCCESS 1[0m in 0.67s]
[0m07:44:32.167519 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:44:32.168108 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:44:32.168554 [info ] [Thread-3  ]: 2 of 3 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m07:44:32.168900 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:32.169019 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:44:32.169127 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:44:32.171395 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:32.171630 [debug] [Thread-3  ]: finished collecting timing info
[0m07:44:32.171749 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:44:32.173722 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:32.174212 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:32.174317 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with src_hosts as (
    select * from airbnb.dev.src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m07:44:32.174416 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:44:32.694066 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.52 seconds
[0m07:44:32.697264 [debug] [Thread-3  ]: finished collecting timing info
[0m07:44:32.697404 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m07:44:32.791899 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde5676e7c0>]}
[0m07:44:32.792221 [info ] [Thread-3  ]: 2 of 3 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 0.62s]
[0m07:44:32.792541 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:44:32.793071 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:44:32.793504 [info ] [Thread-2  ]: 3 of 3 START view model dev.dim_listings_w_hosts ............................... [RUN]
[0m07:44:32.793846 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:44:32.793979 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:44:32.794104 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m07:44:32.796906 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:44:32.797150 [debug] [Thread-2  ]: finished collecting timing info
[0m07:44:32.797265 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:44:32.802654 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type table
[0m07:44:32.806231 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:44:32.806394 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m07:44:32.806481 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:44:33.169796 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.36 seconds
[0m07:44:33.170791 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:44:33.171421 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:44:33.171524 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace  view airbnb.dev.dim_listings_w_hosts
  
   as (
    with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
  );
[0m07:44:33.405951 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m07:44:33.407140 [debug] [Thread-2  ]: finished collecting timing info
[0m07:44:33.407273 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m07:44:33.515244 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '651492f1-38d4-4047-b07f-b45286e5c256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde554efcd0>]}
[0m07:44:33.515547 [info ] [Thread-2  ]: 3 of 3 OK created view model dev.dim_listings_w_hosts .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m07:44:33.515849 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:44:33.517191 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:44:33.517453 [info ] [MainThread]: 
[0m07:44:33.517646 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m07:44:33.517831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:33.517925 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m07:44:33.518019 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m07:44:33.518111 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m07:44:33.526249 [info ] [MainThread]: 
[0m07:44:33.526491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:33.526745 [info ] [MainThread]: 
[0m07:44:33.526929 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:44:33.527176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde540cb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde540cb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde540cb880>]}


============================== 2022-07-30 07:56:54.299739 | 24ed6a5e-1b13-4aa8-a9d4-7f3e22957e85 ==============================
[0m07:56:54.299756 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:56:54.300115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m07:56:54.300234 [debug] [MainThread]: Tracking: tracking
[0m07:56:54.300428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55135e2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55135e2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55135e24c0>]}
[0m07:56:54.338183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:56:54.338523 [debug] [MainThread]: Partial parsing: added file: dbtlearn://analyses/full_moon_no_sleep.sql
[0m07:56:54.366502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ed6a5e-1b13-4aa8-a9d4-7f3e22957e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5513390430>]}
[0m07:56:54.373894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ed6a5e-1b13-4aa8-a9d4-7f3e22957e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55134eb8b0>]}
[0m07:56:54.374151 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:56:54.374360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ed6a5e-1b13-4aa8-a9d4-7f3e22957e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55134ebac0>]}
[0m07:56:54.375734 [info ] [MainThread]: 
[0m07:56:54.376090 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m07:56:54.376980 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m07:56:54.385393 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:56:54.385542 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:56:54.385647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:55.038200 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.65 seconds
[0m07:56:55.039502 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:56:55.138711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ed6a5e-1b13-4aa8-a9d4-7f3e22957e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55134eb5b0>]}
[0m07:56:55.139225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:56:55.139510 [info ] [MainThread]: 
[0m07:56:55.143554 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:56:55.143720 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:56:55.144076 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m07:56:55.144242 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:56:55.144547 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m07:56:55.144690 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:56:55.144882 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:56:55.145263 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m07:56:55.145443 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:56:55.145728 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m07:56:55.145926 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m07:56:55.146108 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:56:55.146318 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m07:56:55.146515 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:56:55.148830 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:56:55.149037 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m07:56:55.150814 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:56:55.151018 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m07:56:55.153263 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:56:55.153523 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.154828 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m07:56:55.155019 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.155368 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m07:56:55.155511 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.155702 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:55.155882 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m07:56:55.156088 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.156279 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m07:56:55.156489 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:56:55.156698 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.157140 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:56:55.157341 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.157520 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:55.157877 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:56:55.158117 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:56:55.158495 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:56:55.159057 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:56:55.159297 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:56:55.159599 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:56:55.160027 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:56:55.160514 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:56:55.160745 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m07:56:55.160894 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:56:55.161179 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:56:55.161336 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:56:55.161600 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m07:56:55.161773 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m07:56:55.161955 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:56:55.162123 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m07:56:55.162305 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:56:55.164860 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.165050 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m07:56:55.166923 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:56:55.167112 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m07:56:55.167303 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:56:55.169177 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:56:55.185202 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.185426 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.186828 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:56:55.187280 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:56:55.187592 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:56:55.187758 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.188134 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:55.188351 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.188642 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:56:55.188860 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:56:55.189264 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:56:55.189466 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.189648 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:55.190216 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:56:55.190558 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:56:55.191443 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:56:55.191668 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:56:55.191824 [debug] [Thread-2  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:56:55.191970 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:56:55.192128 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:56:55.192407 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:56:55.192552 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:56:55.192759 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m07:56:55.193031 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m07:56:55.193203 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:56:55.193474 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:56:55.195673 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:56:55.195866 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:56:55.196039 [debug] [Thread-2  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:56:55.196221 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:56:55.196535 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m07:56:55.196671 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.205238 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:56:55.205418 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m07:56:55.207292 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:56:55.207514 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:56:55.215627 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:56:55.216027 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.216303 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:56:55.216480 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.216905 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:56:55.217076 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.217258 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:56:55.217456 [debug] [Thread-2  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:56:55.217676 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:56:55.217892 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:56:55.218808 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.220141 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:56:55.220338 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.220719 [debug] [Thread-2  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:56:55.220923 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:56:55.221422 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:56:55.221678 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:56:55.221880 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:56:55.222191 [debug] [Thread-3  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:56:55.222485 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:56:55.229161 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:56:55.229418 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:56:55.229626 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:56:55.230061 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:56:55.230250 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.230444 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:56:55.230658 [debug] [Thread-3  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:56:55.230862 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:56:55.233652 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:56:55.236639 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:56:55.236862 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.237872 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:56:55.238207 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:56:55.238409 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.238682 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.239076 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:56:55.239401 [debug] [Thread-3  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:56:55.239959 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:56:55.240155 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:56:55.240348 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.240498 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.240670 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:56:55.241036 [debug] [Thread-3  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:56:55.241334 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:56:55.247020 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:56:55.247302 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:56:55.247849 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:56:55.248371 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:56:55.248717 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:56:55.248892 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.249082 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:56:55.249271 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:56:55.249457 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:56:55.249643 [debug] [Thread-3  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:56:55.249823 [debug] [Thread-2  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m07:56:55.250013 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.254267 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:56:55.256454 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:56:55.256849 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:56:55.257237 [debug] [Thread-1  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:56:55.257605 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m07:56:55.258003 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:56:55.258168 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.258325 [debug] [Thread-1  ]: Compiling test.dbtlearn.consistent_created_at
[0m07:56:55.258555 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.258748 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:56:55.261429 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:56:55.261633 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:56:55.261828 [debug] [Thread-3  ]: finished collecting timing info
[0m07:56:55.262127 [debug] [Thread-2  ]: finished collecting timing info
[0m07:56:55.262323 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.262706 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:56:55.263047 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:56:55.263237 [debug] [Thread-1  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:56:55.263882 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.264159 [debug] [Thread-1  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:56:55.264324 [debug] [Thread-1  ]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m07:56:55.264673 [debug] [Thread-1  ]: Acquiring new snowflake connection "analysis.dbtlearn.full_moon_no_sleep"
[0m07:56:55.264805 [debug] [Thread-1  ]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m07:56:55.264924 [debug] [Thread-1  ]: Compiling analysis.dbtlearn.full_moon_no_sleep
[0m07:56:55.266547 [debug] [Thread-1  ]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m07:56:55.266963 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.267077 [debug] [Thread-1  ]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m07:56:55.267186 [debug] [Thread-1  ]: finished collecting timing info
[0m07:56:55.267440 [debug] [Thread-1  ]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m07:56:55.747786 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.53 seconds
[0m07:56:55.749711 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:56:55.750052 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:55.750224 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:56:55.750391 [debug] [Thread-4  ]: finished collecting timing info
[0m07:56:55.750557 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:56:55.842382 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:56:55.843585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:55.843712 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m07:56:55.843812 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m07:56:55.843906 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:56:55.844002 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:56:55.850868 [info ] [MainThread]: Done.
[0m07:56:55.851134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54faf57fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54faf35970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54fafe5130>]}


============================== 2022-07-30 08:14:30.067158 | 8b810aea-2d97-4ef3-a677-6640f7d86311 ==============================
[0m08:14:30.067173 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:14:30.067522 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:14:30.067636 [debug] [MainThread]: Tracking: tracking
[0m08:14:30.067938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64da737310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64da737370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64da7373d0>]}
[0m08:14:30.089688 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:14:30.089953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64da737b80>]}
[0m08:14:30.105783 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m08:14:30.106580 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m08:14:30.107025 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:14:30.137699 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:14:30.139125 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:14:30.139806 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:14:30.142699 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:14:30.149473 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:14:30.152289 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:14:30.153331 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:14:30.157213 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:14:30.157568 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:14:30.157969 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:14:30.158458 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:14:30.158900 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:14:30.165918 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:14:30.176737 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:14:30.180290 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:14:30.182457 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:14:30.192540 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:14:30.194598 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:14:30.196288 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:14:30.201579 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:14:30.203566 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:14:30.204744 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:14:30.205830 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:14:30.211950 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:14:30.215151 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:14:30.215680 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:14:30.216290 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:14:30.216950 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:14:30.218022 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:14:30.219774 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:14:30.222749 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:14:30.224090 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:14:30.225421 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:14:30.228695 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:14:30.242045 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:14:30.246768 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:14:30.248054 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:14:30.256095 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:14:30.268237 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:14:30.277515 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:14:30.288177 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:14:30.300387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:14:30.307088 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:14:30.308194 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:14:30.311458 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:14:30.314026 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:14:30.315078 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:14:30.319060 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:14:30.320789 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:14:30.322905 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:14:30.326831 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:14:30.328605 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:14:30.330315 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:14:30.331047 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:14:30.331988 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:14:30.332796 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:14:30.333514 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:14:30.334248 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:14:30.335198 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:14:30.336022 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:14:30.337461 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:14:30.338177 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:14:30.338935 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:14:30.339763 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:14:30.340551 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:14:30.341371 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:14:30.342313 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:14:30.343132 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:14:30.347538 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:14:30.348222 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:14:30.348836 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:14:30.349655 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:14:30.351811 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m08:14:30.358590 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m08:14:30.360203 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m08:14:30.364635 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m08:14:30.365419 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m08:14:30.372623 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m08:14:30.374968 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m08:14:30.377268 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m08:14:30.379177 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m08:14:30.381594 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m08:14:30.386077 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m08:14:30.388914 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m08:14:30.391810 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m08:14:30.395767 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m08:14:30.401211 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m08:14:30.403010 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m08:14:30.405231 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m08:14:30.406007 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m08:14:30.410875 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m08:14:30.413539 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m08:14:30.415272 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m08:14:30.416640 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m08:14:30.417465 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m08:14:30.418616 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m08:14:30.419653 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m08:14:30.420763 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m08:14:30.421565 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m08:14:30.425511 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m08:14:30.427599 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m08:14:30.428457 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m08:14:30.429554 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m08:14:30.430970 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m08:14:30.432887 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m08:14:30.434059 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m08:14:30.436988 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m08:14:30.438244 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m08:14:30.441214 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m08:14:30.442423 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m08:14:30.444458 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m08:14:30.450505 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m08:14:30.458998 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m08:14:30.460254 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m08:14:30.464456 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m08:14:30.467742 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m08:14:30.470274 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m08:14:30.472838 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m08:14:30.478162 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m08:14:30.481306 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m08:14:30.486119 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m08:14:30.490490 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m08:14:30.491526 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m08:14:30.492797 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m08:14:30.494501 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m08:14:30.495834 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m08:14:30.498437 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m08:14:30.499335 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m08:14:30.500279 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m08:14:30.501197 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m08:14:30.502078 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m08:14:30.520002 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m08:14:30.521501 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m08:14:30.523141 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m08:14:30.524647 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m08:14:30.525750 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m08:14:30.527878 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m08:14:30.529635 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m08:14:30.530995 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m08:14:30.532902 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m08:14:30.539376 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m08:14:30.542175 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m08:14:30.543853 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m08:14:30.544849 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m08:14:30.545845 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m08:14:30.546938 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m08:14:30.549008 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m08:14:30.550225 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m08:14:30.913529 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:14:30.923913 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:14:30.927099 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:14:30.930876 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m08:14:30.947356 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m08:14:30.948841 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:14:30.952773 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:14:30.956761 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:14:30.961026 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:14:31.112548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b3333a90>]}
[0m08:14:31.121183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64da7a5040>]}
[0m08:14:31.121449 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:14:31.121651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d95810a0>]}
[0m08:14:31.122829 [info ] [MainThread]: 
[0m08:14:31.123257 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:14:31.124020 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:14:31.133458 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:14:31.133634 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:14:31.133744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:31.768766 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.64 seconds
[0m08:14:31.770032 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:14:32.278365 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:14:32.283529 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:14:32.283704 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:14:32.283824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:14:32.891583 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.61 seconds
[0m08:14:32.892752 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:14:32.981086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b328b040>]}
[0m08:14:32.981768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:14:32.982155 [info ] [MainThread]: 
[0m08:14:32.986068 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:14:32.986523 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:14:32.986701 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:14:32.987067 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:14:32.987449 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:14:32.987747 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:14:32.987952 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:14:32.988151 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:14:32.988343 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:14:32.988563 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:14:32.988757 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:14:32.988965 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:14:32.992098 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:14:32.994037 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:14:32.996036 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:14:32.997027 [debug] [Thread-3  ]: finished collecting timing info
[0m08:14:32.997622 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:14:32.998119 [debug] [Thread-2  ]: finished collecting timing info
[0m08:14:32.998285 [debug] [Thread-1  ]: finished collecting timing info
[0m08:14:32.998431 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m08:14:32.998895 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:14:32.999345 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:14:32.999640 [info ] [Thread-4  ]: 1 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:14:33.000308 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:14:33.000732 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:14:33.000981 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:33.001264 [info ] [Thread-3  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m08:14:33.001505 [info ] [Thread-1  ]: 3 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m08:14:33.001698 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:14:33.002064 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:14:33.002440 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:14:33.002624 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m08:14:33.002828 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:14:33.002980 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:14:33.013555 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:14:33.016816 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:14:33.017061 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:14:33.022946 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:14:33.027730 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:14:33.028351 [debug] [Thread-4  ]: finished collecting timing info
[0m08:14:33.028785 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:14:33.029027 [debug] [Thread-3  ]: finished collecting timing info
[0m08:14:33.029191 [debug] [Thread-1  ]: finished collecting timing info
[0m08:14:33.039834 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:14:33.055419 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:14:33.059779 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:33.075124 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:14:33.077949 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:14:33.078164 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)
 
select 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) as review_id,  /*这个是扩展包里的surrogate_key*/
    * 
from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m08:14:33.078891 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:14:33.081430 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:14:33.082097 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:14:33.082244 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m08:14:33.082499 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT * FROM airbnb.raw.raw_listings
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m08:14:33.082658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:14:33.082867 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:14:33.980554 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.9 seconds
[0m08:14:33.991909 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:14:33.992027 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
-"GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER"
[0m08:14:34.009704 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
[0m08:14:34.011405 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:14:34.011520 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
-"GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER"
[0m08:14:34.070306 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a5f2ce-3201-06f6-0000-d015000198ee
[0m08:14:34.070472 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected '-'.
[0m08:14:34.070668 [debug] [Thread-3  ]: finished collecting timing info
[0m08:14:34.070788 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:14:34.090371 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a5f2ce-3201-078c-0000-d01500027112
[0m08:14:34.090522 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected '-'.
[0m08:14:34.090707 [debug] [Thread-1  ]: finished collecting timing info
[0m08:14:34.090828 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:14:34.181392 [debug] [Thread-3  ]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected '-'.
  compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m08:14:34.181777 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b0034bb0>]}
[0m08:14:34.182172 [error] [Thread-3  ]: 2 of 5 ERROR creating view model dev.dim_listings_cleansed ..................... [[31mERROR[0m in 1.18s]
[0m08:14:34.182751 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:14:34.184884 [debug] [Thread-1  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected '-'.
  compiled SQL at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m08:14:34.185182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64b0034d00>]}
[0m08:14:34.185568 [error] [Thread-1  ]: 3 of 5 ERROR creating view model dev.dim_hosts_cleansed ........................ [[31mERROR[0m in 1.18s]
[0m08:14:34.186016 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:14:34.186719 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:14:34.187008 [info ] [Thread-2  ]: 4 of 5 SKIP relation dev.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m08:14:34.187518 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:14:34.899340 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.82 seconds
[0m08:14:34.905786 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:34.905913 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:14:34.980174 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.07 seconds
[0m08:14:34.983654 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:34.983827 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:14:35.046684 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.06 seconds
[0m08:14:35.056234 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:35.056392 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:14:35.110943 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.05 seconds
[0m08:14:35.115168 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:35.115368 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:14:35.171816 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.06 seconds
[0m08:14:35.181378 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:14:35.192793 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:14:35.193321 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:35.193443 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m08:14:35.269342 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m08:14:35.269559 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:35.269679 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:14:35.675849 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.41 seconds
[0m08:14:35.676136 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:35.676286 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:14:35.810064 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.13 seconds
[0m08:14:35.811853 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:14:35.812015 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-"GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER"
[0m08:14:35.880677 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a5f2ce-3201-06f6-0000-d015000198f6
[0m08:14:35.880895 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected '-'.
[0m08:14:35.881165 [debug] [Thread-4  ]: finished collecting timing info
[0m08:14:35.881337 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: Close
[0m08:14:35.991811 [debug] [Thread-4  ]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected '-'.
  compiled SQL at target/run/dbtlearn/models/fct/fct_reviews.sql
[0m08:14:35.992079 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b810aea-2d97-4ef3-a677-6640f7d86311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f647efc2880>]}
[0m08:14:35.992335 [error] [Thread-4  ]: 1 of 5 ERROR creating incremental model dev.fct_reviews ........................ [[31mERROR[0m in 2.99s]
[0m08:14:35.992646 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:14:35.993182 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:14:35.993583 [info ] [Thread-1  ]: 5 of 5 SKIP relation dev.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m08:14:35.993898 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:14:35.995146 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:14:35.995416 [info ] [MainThread]: 
[0m08:14:35.995612 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m08:14:35.995797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:14:35.995894 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m08:14:35.995989 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m08:14:35.996088 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:14:35.996210 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:14:36.003843 [info ] [MainThread]: 
[0m08:14:36.004099 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m08:14:36.004313 [info ] [MainThread]: 
[0m08:14:36.004479 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)[0m
[0m08:14:36.004657 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m08:14:36.004826 [error] [MainThread]:   syntax error line 1 at position 0 unexpected '-'.
[0m08:14:36.004995 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m08:14:36.005172 [info ] [MainThread]: 
[0m08:14:36.005393 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m08:14:36.005571 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m08:14:36.005738 [error] [MainThread]:   syntax error line 1 at position 0 unexpected '-'.
[0m08:14:36.005907 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m08:14:36.006079 [info ] [MainThread]: 
[0m08:14:36.006253 [error] [MainThread]: [33mDatabase Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m08:14:36.006424 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m08:14:36.006590 [error] [MainThread]:   syntax error line 1 at position 0 unexpected '-'.
[0m08:14:36.006757 [error] [MainThread]:   compiled SQL at target/run/dbtlearn/models/fct/fct_reviews.sql
[0m08:14:36.006934 [info ] [MainThread]: 
[0m08:14:36.007111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m08:14:36.007371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d9584730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64da74b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d95b1c70>]}


============================== 2022-07-30 08:15:17.757387 | b8b5fcad-b851-4006-9396-a38694618e7e ==============================
[0m08:15:17.757403 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:15:17.757748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m08:15:17.757865 [debug] [MainThread]: Tracking: tracking
[0m08:15:17.758072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e3677040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e36773d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e3677430>]}
[0m08:15:17.796150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:15:17.796314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:15:17.801517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8b5fcad-b851-4006-9396-a38694618e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e246ba00>]}
[0m08:15:17.810425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8b5fcad-b851-4006-9396-a38694618e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e255bdf0>]}
[0m08:15:17.810665 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:15:17.810880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b5fcad-b851-4006-9396-a38694618e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e255bfd0>]}
[0m08:15:17.812179 [info ] [MainThread]: 
[0m08:15:17.812521 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:15:17.813361 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:15:17.822426 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:15:17.822607 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:15:17.822730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:18.357590 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.53 seconds
[0m08:15:18.360033 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:15:18.467697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b5fcad-b851-4006-9396-a38694618e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e368c9d0>]}
[0m08:15:18.468089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:15:18.468301 [info ] [MainThread]: 
[0m08:15:18.471763 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:15:18.472043 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:15:18.472179 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:15:18.472334 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:15:18.474895 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:15:18.475179 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:15:18.475501 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:15:18.475683 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.475812 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m08:15:18.476092 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:15:18.476421 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:15:18.476804 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:15:18.477095 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:15:18.477286 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:15:18.477465 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:15:18.477682 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m08:15:18.477879 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m08:15:18.478283 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:15:18.478476 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:15:18.478757 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m08:15:18.478939 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m08:15:18.481401 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:15:18.482606 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:15:18.482801 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m08:15:18.484855 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m08:15:18.485273 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m08:15:18.485559 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.485700 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.485885 [debug] [Thread-4  ]: finished collecting timing info
[0m08:15:18.518756 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.519198 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:15:18.519568 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:15:18.519790 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m08:15:18.519992 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m08:15:18.520244 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:15:18.520749 [debug] [Thread-4  ]: finished collecting timing info
[0m08:15:18.521066 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:15:18.521225 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.521604 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:15:18.521965 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m08:15:18.522237 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:15:18.522579 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m08:15:18.522770 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:15:18.522995 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m08:15:18.523189 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:15:18.523645 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:15:18.523912 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:15:18.524097 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:15:18.529542 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:15:18.533200 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:15:18.539655 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:15:18.539852 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m08:15:18.561840 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:15:18.562034 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.562438 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:15:18.562716 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.562951 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.563061 [debug] [Thread-4  ]: finished collecting timing info
[0m08:15:18.563255 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:15:18.563646 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:15:18.563835 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:15:18.564029 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.564449 [debug] [Thread-4  ]: finished collecting timing info
[0m08:15:18.564806 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:15:18.565152 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:15:18.566052 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:15:18.566314 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:15:18.566438 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:15:18.566557 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:15:18.569287 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:15:18.569542 [debug] [Thread-2  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:15:18.569717 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:15:18.569979 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:15:18.570120 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.570257 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:15:18.570537 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:15:18.570723 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:15:18.570913 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:15:18.571190 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:15:18.571365 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:15:18.571549 [debug] [Thread-2  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:15:18.571738 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.571921 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m08:15:18.572090 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m08:15:18.580945 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:15:18.581311 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:15:18.581499 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m08:15:18.583388 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:15:18.583728 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:15:18.589430 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.590047 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:15:18.593026 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:15:18.593212 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.593415 [debug] [Thread-2  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:15:18.593610 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:15:18.593795 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:15:18.593989 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:15:18.594187 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.594372 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:15:18.594557 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:15:18.594759 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.595156 [debug] [Thread-2  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:15:18.601161 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:15:18.603232 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:15:18.603503 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:15:18.603933 [debug] [Thread-3  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:15:18.604441 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:15:18.604585 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.604901 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:15:18.605195 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:15:18.605468 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:15:18.605656 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:15:18.605851 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:15:18.606045 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.606222 [debug] [Thread-3  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:15:18.609775 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:15:18.610130 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:15:18.613221 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:15:18.613574 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:15:18.613886 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.614393 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:15:18.614646 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.614848 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:15:18.615024 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:15:18.615220 [debug] [Thread-3  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:15:18.615413 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.615595 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:15:18.615789 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.616131 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:15:18.621383 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:15:18.622103 [debug] [Thread-3  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:15:18.622418 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:15:18.623217 [debug] [Thread-3  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:15:18.623327 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.623628 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:15:18.624016 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:15:18.624208 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:15:18.624401 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:15:18.624616 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:15:18.624812 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.625002 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:15:18.625192 [debug] [Thread-3  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m08:15:18.625532 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:15:18.629843 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:15:18.632094 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:15:18.632479 [debug] [Thread-1  ]: Began running node test.dbtlearn.consistent_created_at
[0m08:15:18.633285 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m08:15:18.633428 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m08:15:18.633676 [debug] [Thread-1  ]: Compiling test.dbtlearn.consistent_created_at
[0m08:15:18.635663 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m08:15:18.635831 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.636394 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.636551 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.636741 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:15:18.636941 [debug] [Thread-3  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:15:18.637137 [debug] [Thread-1  ]: Began executing node test.dbtlearn.consistent_created_at
[0m08:15:18.637327 [debug] [Thread-2  ]: finished collecting timing info
[0m08:15:18.637521 [debug] [Thread-3  ]: finished collecting timing info
[0m08:15:18.637715 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.638094 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:15:18.638441 [debug] [Thread-3  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:15:18.638767 [debug] [Thread-1  ]: Finished running node test.dbtlearn.consistent_created_at
[0m08:15:18.639409 [debug] [Thread-1  ]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m08:15:18.639644 [debug] [Thread-1  ]: Acquiring new snowflake connection "analysis.dbtlearn.full_moon_no_sleep"
[0m08:15:18.639770 [debug] [Thread-1  ]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m08:15:18.639891 [debug] [Thread-1  ]: Compiling analysis.dbtlearn.full_moon_no_sleep
[0m08:15:18.642411 [debug] [Thread-1  ]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m08:15:18.642748 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.642860 [debug] [Thread-1  ]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m08:15:18.642969 [debug] [Thread-1  ]: finished collecting timing info
[0m08:15:18.643231 [debug] [Thread-1  ]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m08:15:18.962358 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.37 seconds
[0m08:15:18.964199 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:15:18.964452 [debug] [Thread-4  ]: finished collecting timing info
[0m08:15:18.964574 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m08:15:18.964688 [debug] [Thread-4  ]: finished collecting timing info
[0m08:15:18.964805 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m08:15:19.077549 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:15:19.084287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:19.085026 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m08:15:19.085603 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:15:19.086152 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m08:15:19.086695 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m08:15:19.094844 [info ] [MainThread]: Done.
[0m08:15:19.095107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e002c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d1ffa0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d1ffa130>]}


============================== 2022-07-30 08:17:08.155633 | 39292903-91ca-409e-b0e0-7c69fa6e0164 ==============================
[0m08:17:08.155648 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:17:08.155998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m08:17:08.156188 [debug] [MainThread]: Tracking: tracking
[0m08:17:08.156447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a55e53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a55e5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a55e5490>]}
[0m08:17:08.177972 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:17:08.178232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39292903-91ca-409e-b0e0-7c69fa6e0164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a55e5af0>]}
[0m08:17:08.193843 [debug] [MainThread]: Parsing macros/no_nulls_in_columns.sql
[0m08:17:08.194653 [debug] [MainThread]: Parsing macros/postitve_value.sql
[0m08:17:08.195108 [debug] [MainThread]: Parsing macros/adapters.sql
[0m08:17:08.226130 [debug] [MainThread]: Parsing macros/catalog.sql
[0m08:17:08.227554 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m08:17:08.228235 [debug] [MainThread]: Parsing macros/materializations/merge.sql
[0m08:17:08.230984 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m08:17:08.237748 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m08:17:08.240518 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m08:17:08.241525 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m08:17:08.245326 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:17:08.245676 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:17:08.246074 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:17:08.246579 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:17:08.247014 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m08:17:08.254222 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m08:17:08.264692 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m08:17:08.268177 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m08:17:08.270421 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m08:17:08.280140 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m08:17:08.282215 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m08:17:08.283822 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m08:17:08.288872 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m08:17:08.290784 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m08:17:08.291938 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m08:17:08.293029 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m08:17:08.298910 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m08:17:08.302160 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m08:17:08.302692 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m08:17:08.303303 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m08:17:08.303944 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m08:17:08.304955 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m08:17:08.306591 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m08:17:08.309533 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m08:17:08.310857 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m08:17:08.312205 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m08:17:08.315442 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m08:17:08.329126 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m08:17:08.334063 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m08:17:08.335280 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m08:17:08.343541 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m08:17:08.355386 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m08:17:08.364758 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m08:17:08.375876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m08:17:08.387979 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m08:17:08.394600 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m08:17:08.395723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m08:17:08.398999 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m08:17:08.401423 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m08:17:08.402392 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m08:17:08.408473 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m08:17:08.410289 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m08:17:08.412437 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m08:17:08.416505 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m08:17:08.418282 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m08:17:08.419846 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m08:17:08.420802 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m08:17:08.421753 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m08:17:08.422587 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m08:17:08.423312 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m08:17:08.424035 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m08:17:08.424996 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m08:17:08.425844 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m08:17:08.427339 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m08:17:08.428068 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m08:17:08.428823 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m08:17:08.429665 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m08:17:08.430468 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m08:17:08.431324 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m08:17:08.432267 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m08:17:08.433089 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m08:17:08.437467 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m08:17:08.438123 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m08:17:08.438765 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m08:17:08.439619 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m08:17:08.441702 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
[0m08:17:08.448012 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m08:17:08.449607 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m08:17:08.454106 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m08:17:08.454879 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m08:17:08.462157 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m08:17:08.463562 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m08:17:08.464699 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
[0m08:17:08.465675 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
[0m08:17:08.466877 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m08:17:08.469028 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m08:17:08.470429 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m08:17:08.471931 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m08:17:08.473762 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m08:17:08.476406 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m08:17:08.477433 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m08:17:08.478643 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m08:17:08.479392 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m08:17:08.483947 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m08:17:08.486420 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m08:17:08.488112 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
[0m08:17:08.489490 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m08:17:08.490353 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m08:17:08.491512 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m08:17:08.492452 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m08:17:08.493487 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m08:17:08.494283 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m08:17:08.498208 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m08:17:08.500313 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m08:17:08.501119 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m08:17:08.502199 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m08:17:08.503645 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m08:17:08.505567 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m08:17:08.506743 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m08:17:08.509685 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m08:17:08.510894 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m08:17:08.513864 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m08:17:08.515193 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m08:17:08.517231 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m08:17:08.522921 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m08:17:08.531266 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m08:17:08.532500 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m08:17:08.536625 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m08:17:08.539832 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m08:17:08.542170 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m08:17:08.544658 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m08:17:08.549698 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m08:17:08.552735 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m08:17:08.557437 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m08:17:08.561687 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m08:17:08.562792 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m08:17:08.564218 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m08:17:08.566076 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m08:17:08.567355 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m08:17:08.570064 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m08:17:08.570940 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m08:17:08.571882 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m08:17:08.572814 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m08:17:08.573733 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m08:17:08.593055 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m08:17:08.594511 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m08:17:08.596160 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m08:17:08.597741 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m08:17:08.598855 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m08:17:08.601121 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m08:17:08.602895 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m08:17:08.604299 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m08:17:08.606123 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m08:17:08.612712 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m08:17:08.615428 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m08:17:08.617022 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m08:17:08.617934 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m08:17:08.618862 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m08:17:08.619911 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m08:17:08.622021 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m08:17:08.623249 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m08:17:08.961077 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:17:08.971104 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:17:08.974181 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:17:08.977289 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m08:17:08.992893 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m08:17:08.994216 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:17:08.998001 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:17:09.001631 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:17:09.006185 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:17:09.133789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39292903-91ca-409e-b0e0-7c69fa6e0164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03871f3b20>]}
[0m08:17:09.141512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39292903-91ca-409e-b0e0-7c69fa6e0164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a668ccd0>]}
[0m08:17:09.141738 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:17:09.141937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39292903-91ca-409e-b0e0-7c69fa6e0164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a5446430>]}
[0m08:17:09.143153 [info ] [MainThread]: 
[0m08:17:09.143490 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:17:09.144208 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:17:09.152777 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:17:09.152952 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:17:09.153090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:09.731520 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.58 seconds
[0m08:17:09.734057 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:17:09.830047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39292903-91ca-409e-b0e0-7c69fa6e0164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03871f1250>]}
[0m08:17:09.830455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:17:09.830683 [info ] [MainThread]: 
[0m08:17:09.834287 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:17:09.834509 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:17:09.834841 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:17:09.835006 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:17:09.835346 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:17:09.835504 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m08:17:09.835719 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:17:09.836014 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:17:09.836204 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:17:09.836608 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:17:09.836795 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:17:09.836964 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:17:09.837152 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:17:09.837352 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m08:17:09.840095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:17:09.840358 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:17:09.842458 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:17:09.842707 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m08:17:09.844926 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:17:09.846304 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m08:17:09.846544 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.846831 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.847390 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:17:09.847524 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:09.847658 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.847858 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m08:17:09.848061 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m08:17:09.848429 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:17:09.849042 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:17:09.849229 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.849471 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m08:17:09.849689 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:17:09.850244 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m08:17:09.850609 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m08:17:09.850755 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:17:09.851023 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:09.851250 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m08:17:09.851412 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m08:17:09.851769 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:17:09.851947 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:17:09.852187 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:09.854706 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.854963 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:17:09.855171 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:17:09.855379 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:17:09.855581 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m08:17:09.855776 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:17:09.863482 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:09.863673 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m08:17:09.863885 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.869490 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:17:09.880458 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m08:17:09.879960 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:17:09.880803 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:09.881111 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.881588 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:17:09.881793 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.881969 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:17:09.882161 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:09.882352 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:17:09.882541 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.882884 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:17:09.883073 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.883424 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:17:09.883939 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:17:09.884989 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:17:09.885213 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:09.885339 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:17:09.885459 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:17:09.888668 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:09.888918 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:09.889384 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:09.889529 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:09.889775 [debug] [Thread-3  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:17:09.889934 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.890085 [debug] [Thread-4  ]: Began running node test.dbtlearn.consistent_created_at
[0m08:17:09.890246 [debug] [Thread-2  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m08:17:09.890527 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:17:09.890730 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:17:09.890998 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m08:17:09.893462 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:09.893648 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:17:09.893843 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.894020 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m08:17:09.894339 [debug] [Thread-3  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:17:09.894483 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:09.894838 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:17:09.895010 [debug] [Thread-4  ]: Compiling test.dbtlearn.consistent_created_at
[0m08:17:09.898674 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:17:09.898862 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:09.899088 [debug] [Thread-1  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:17:09.900923 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m08:17:09.901342 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:09.901716 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:17:09.901848 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.902314 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:09.902608 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:17:09.902786 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.902982 [debug] [Thread-3  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:17:09.903215 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:17:09.903675 [debug] [Thread-1  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m08:17:09.903871 [debug] [Thread-4  ]: Began executing node test.dbtlearn.consistent_created_at
[0m08:17:09.904067 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.904442 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:17:09.906518 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:17:09.906776 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.907169 [debug] [Thread-3  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:17:09.907350 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m08:17:09.907806 [debug] [Thread-4  ]: Finished running node test.dbtlearn.consistent_created_at
[0m08:17:09.908086 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:17:09.908256 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.908561 [debug] [Thread-2  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m08:17:09.908786 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:17:09.909067 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:17:09.909350 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:17:09.914912 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:17:09.917326 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:17:09.917522 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:17:09.917721 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.917906 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:17:09.918094 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:17:09.918277 [debug] [Thread-3  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:17:09.918645 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:17:09.918826 [debug] [Thread-4  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:17:09.919004 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:17:09.924537 [debug] [Thread-1  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:17:09.925117 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:17:09.927511 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:17:09.929693 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:17:09.930164 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:17:09.930313 [debug] [Thread-1  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:17:09.930686 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.933418 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:17:09.933676 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:17:09.933847 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.934216 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.934389 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.934611 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:17:09.935069 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:17:09.935258 [debug] [Thread-1  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:17:09.935449 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.935671 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:17:09.935866 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.936301 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:17:09.936593 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:17:09.936997 [debug] [Thread-1  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:17:09.937229 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:17:09.937406 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:17:09.937739 [debug] [Thread-1  ]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m08:17:09.938083 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:17:09.938271 [debug] [Thread-4  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:17:09.938550 [debug] [Thread-1  ]: Acquiring new snowflake connection "analysis.dbtlearn.full_moon_no_sleep"
[0m08:17:09.938735 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:17:09.942593 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:17:09.942803 [debug] [Thread-1  ]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m08:17:09.942985 [debug] [Thread-3  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:17:09.943250 [debug] [Thread-1  ]: Compiling analysis.dbtlearn.full_moon_no_sleep
[0m08:17:09.943475 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.947619 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:17:09.950277 [debug] [Thread-1  ]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m08:17:09.950582 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:17:09.951506 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:09.951989 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:17:09.952459 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.952596 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:17:09.952735 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:09.953008 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:17:09.953228 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.953380 [debug] [Thread-1  ]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m08:17:09.953527 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:09.953949 [debug] [Thread-1  ]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m08:17:10.460409 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 0.54 seconds
[0m08:17:10.462027 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:17:10.462328 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:10.462478 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m08:17:10.462673 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:10.462825 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m08:17:10.551019 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:17:10.552074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:10.552199 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m08:17:10.552301 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m08:17:10.552399 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:17:10.552497 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:17:10.560159 [info ] [MainThread]: Done.
[0m08:17:10.560440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a40f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a5591b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a55e5fd0>]}


============================== 2022-07-30 08:17:14.848833 | 0699ef76-a9a6-4ed3-846e-c14d20b574eb ==============================
[0m08:17:14.848850 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:17:14.849193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:17:14.849308 [debug] [MainThread]: Tracking: tracking
[0m08:17:14.849499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddeee513a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddeee51430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddeee51490>]}
[0m08:17:14.887224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:17:14.887388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:17:14.892251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddedc2aa30>]}
[0m08:17:14.900461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddedd23ee0>]}
[0m08:17:14.900697 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 506 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:17:14.900898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddedd23040>]}
[0m08:17:14.902125 [info ] [MainThread]: 
[0m08:17:14.902459 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:17:14.903293 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m08:17:14.912530 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:17:14.912731 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:17:14.912843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:15.283182 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.37 seconds
[0m08:17:15.284457 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:17:15.378034 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:17:15.383396 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:17:15.383538 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:17:15.383647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:15.896949 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.51 seconds
[0m08:17:15.898061 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:17:15.989806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddeee67a00>]}
[0m08:17:15.990303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:17:15.990567 [info ] [MainThread]: 
[0m08:17:15.994404 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:17:15.994644 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:17:15.995237 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:17:15.995615 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:17:15.995813 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:17:15.996099 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:17:15.996383 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:17:15.996736 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:17:15.997125 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:17:15.997351 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:17:15.997568 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:17:16.000914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:17:16.037078 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:17:16.037265 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:17:16.038550 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:17:16.038989 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:16.039328 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:17:16.039679 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:16.040043 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:17:16.040185 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:16.040727 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:17:16.041419 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:17:16.041623 [info ] [Thread-4  ]: 1 of 5 START view model dev.dim_hosts_cleansed ................................. [RUN]
[0m08:17:16.041959 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:16.042084 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:17:16.042208 [debug] [Thread-4  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:17:16.042356 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:17:16.047792 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m08:17:16.051447 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:16.051774 [info ] [Thread-3  ]: 2 of 5 START view model dev.dim_listings_cleansed .............................. [RUN]
[0m08:17:16.052049 [info ] [Thread-2  ]: 3 of 5 START incremental model dev.fct_reviews ................................. [RUN]
[0m08:17:16.052616 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:17:16.053030 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:16.053245 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:17:16.053511 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:17:16.053668 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:16.053870 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:17:16.054061 [debug] [Thread-2  ]: Compiling model.dbtlearn.fct_reviews
[0m08:17:16.054258 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:17:16.060630 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:17:16.092442 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:17:16.093098 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:16.093267 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:17:16.098557 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:16.109090 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:17:16.110857 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:16.111608 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:17:16.122997 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:16.123222 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace  view airbnb.dev.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from airbnb.raw.raw_hosts
)
select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
from
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
select
    host_id,
  /*  CASE
        when host_name is null then 'Anonymous'
        else host_name
    end as host_name,
  */

    NVL(host_name, 'Anonymous') as host_name,

    is_superhost,
    created_at,
    updated_at
from src_hosts
  );
[0m08:17:16.128604 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:17:16.135107 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:17:16.135467 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace  view airbnb.dev.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
WITH raw_listings AS (
SELECT * FROM airbnb.raw.raw_listings
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
),src_listings as(
    select * from __dbt__cte__src_listings
)
select 
    listing_id,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights =0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    ) ::number(
        10,2
    ) as price,
    created_at,
    updated_at
From 
src_listings
  );
[0m08:17:16.136603 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:17:16.142054 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:16.142463 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (-- auto-incremental set up--

-------------------------------
with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from "AIRBNB"."RAW"."RAW_REVIEWS"
)
select
	listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)
 
select 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) as review_id,  /*这个是扩展包里的surrogate_key*/
    * 
from src_reviews
where review_text is not null

--------------------------------
--tell pc how to incremental--


    and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m08:17:16.142599 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:17:17.290626 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.15 seconds
[0m08:17:17.297894 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:17.298040 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:17:17.420950 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.28 seconds
[0m08:17:17.431035 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:17:17.431168 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m08:17:17.654287 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.36 seconds
[0m08:17:17.660068 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:17.660365 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:17:17.664594 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.23 seconds
[0m08:17:17.670957 [debug] [Thread-3  ]: finished collecting timing info
[0m08:17:17.671094 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:17:17.742021 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.08 seconds
[0m08:17:17.754905 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:17.755048 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:17:17.791080 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddece063a0>]}
[0m08:17:17.791449 [info ] [Thread-3  ]: 2 of 5 OK created view model dev.dim_listings_cleansed ......................... [[32mSUCCESS 1[0m in 1.74s]
[0m08:17:17.791819 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:17:17.849355 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.09 seconds
[0m08:17:17.852455 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:17.852598 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:17:17.892835 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.76 seconds
[0m08:17:17.894618 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:17:17.894733 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m08:17:17.917830 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.07 seconds
[0m08:17:17.924688 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:17:17.933455 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtlearn.fct_reviews"
[0m08:17:17.933940 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:17.934055 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
BEGIN
[0m08:17:18.022331 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.09 seconds
[0m08:17:18.022594 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:18.022807 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:17:18.135022 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.24 seconds
[0m08:17:18.135958 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:18.136097 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:17:18.287693 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddecdedb50>]}
[0m08:17:18.288014 [info ] [Thread-4  ]: 1 of 5 OK created view model dev.dim_hosts_cleansed ............................ [[32mSUCCESS 1[0m in 2.25s]
[0m08:17:18.288333 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:17:18.288803 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:17:18.288987 [info ] [Thread-1  ]: 4 of 5 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m08:17:18.289311 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:18.289441 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:17:18.289568 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:17:18.291890 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:18.292159 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:18.292280 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:17:18.298974 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" because it is of type view
[0m08:17:18.303371 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:18.303506 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_W_HOSTS" cascade
[0m08:17:18.303608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:17:18.667168 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.36 seconds
[0m08:17:18.668435 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:18.669388 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:18.669548 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (with
l as (
    select * from airbnb.dev.dim_listings_cleansed
),

h as (
    select * from airbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
from l
left join h on (h.host_id = l.host_id)
      );
[0m08:17:19.746431 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.72 seconds
[0m08:17:19.746659 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:19.746766 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:17:19.900927 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.15 seconds
[0m08:17:19.902736 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:17:19.902877 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m08:17:19.978246 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.08 seconds
[0m08:17:19.983946 [debug] [Thread-2  ]: finished collecting timing info
[0m08:17:19.984093 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m08:17:20.087330 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddd7ee790>]}
[0m08:17:20.087695 [info ] [Thread-2  ]: 3 of 5 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 4.03s]
[0m08:17:20.088075 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:17:20.088652 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:20.088897 [info ] [Thread-4  ]: 5 of 5 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m08:17:20.089354 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:20.089549 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:20.089718 [debug] [Thread-4  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m08:17:20.093230 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:20.093597 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:20.093723 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:20.096453 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:20.097126 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:20.097239 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

with fct_reviews as (
    select * from airbnb.dev.fct_reviews
),
full_moon_dates as (
    select * from airbnb.dev.seed_full_moon_dates
)
 
select
    r.*,
    CASE
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon


from 
    fct_reviews r
left join full_moon_dates fm 
on (TO_DATE(r.review_date) = DATEADD(day, 1, fm.full_moon_date))   -- 加一秒钟 DATEADD(second, 1, '2019-12-31 23:59:59') result
                                                                    -- to_date() 去掉了原来的时间只留下日期
      );
[0m08:17:20.097344 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:17:21.089047 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.42 seconds
[0m08:17:21.090627 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:17:21.090742 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m08:17:21.145055 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.05 seconds
[0m08:17:21.146347 [debug] [Thread-1  ]: finished collecting timing info
[0m08:17:21.146488 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m08:17:21.240340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddd7274f0>]}
[0m08:17:21.240772 [info ] [Thread-1  ]: 4 of 5 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 2.95s]
[0m08:17:21.241213 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:17:24.455438 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.36 seconds
[0m08:17:24.458247 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:17:24.458483 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_reviews TO ROLE REPORTER
[0m08:17:24.525751 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.07 seconds
[0m08:17:24.527287 [debug] [Thread-4  ]: finished collecting timing info
[0m08:17:24.527437 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m08:17:24.618431 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0699ef76-a9a6-4ed3-846e-c14d20b574eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddd6d3670>]}
[0m08:17:24.618766 [info ] [Thread-4  ]: 5 of 5 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 4.53s]
[0m08:17:24.619098 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:17:24.620295 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:17:24.620561 [info ] [MainThread]: 
[0m08:17:24.620763 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.72 seconds (9.72s).
[0m08:17:24.620958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:24.621066 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m08:17:24.621166 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:17:24.621266 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:17:24.621348 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m08:17:24.629301 [info ] [MainThread]: 
[0m08:17:24.629543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:17:24.629817 [info ] [MainThread]: 
[0m08:17:24.630149 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:17:24.631100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddedc0a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddedd238e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddedd23160>]}


============================== 2022-07-30 08:42:40.226479 | 666bf5e7-970c-4e65-bd29-687a803e1699 ==============================
[0m08:42:40.226495 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:42:40.226840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m08:42:40.226957 [debug] [MainThread]: Tracking: tracking
[0m08:42:40.227151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b213ea3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b213ea430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b213ea490>]}
[0m08:42:40.267867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:42:40.268197 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dashboards.yml
[0m08:42:40.286294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '666bf5e7-970c-4e65-bd29-687a803e1699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b211af7c0>]}
[0m08:42:40.294321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '666bf5e7-970c-4e65-bd29-687a803e1699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b212d7fd0>]}
[0m08:42:40.294559 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 1 analysis, 506 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m08:42:40.294763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '666bf5e7-970c-4e65-bd29-687a803e1699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b212d70d0>]}
[0m08:42:40.296117 [info ] [MainThread]: 
[0m08:42:40.296552 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:42:40.297333 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m08:42:40.306304 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:42:40.306495 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:42:40.306607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:40.970089 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.66 seconds
[0m08:42:40.971390 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:42:41.073039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '666bf5e7-970c-4e65-bd29-687a803e1699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b211c0f40>]}
[0m08:42:41.073419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:42:41.073628 [info ] [MainThread]: 
[0m08:42:41.076588 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:42:41.076866 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.src_hosts"
[0m08:42:41.076998 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:42:41.077129 [debug] [Thread-1  ]: Compiling model.dbtlearn.src_hosts
[0m08:42:41.079269 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:42:41.079517 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:42:41.079912 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.src_listings"
[0m08:42:41.080082 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:42:41.080204 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:42:41.080339 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.080500 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m08:42:41.080817 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.src_reviews"
[0m08:42:41.081007 [debug] [Thread-2  ]: Compiling model.dbtlearn.src_listings
[0m08:42:41.081424 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:42:41.081714 [debug] [Thread-4  ]: Acquiring new snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:42:41.081901 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:42:41.083644 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:42:41.083870 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m08:42:41.084076 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m08:42:41.084478 [debug] [Thread-3  ]: Compiling model.dbtlearn.src_reviews
[0m08:42:41.084897 [debug] [Thread-1  ]: Acquiring new snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m08:42:41.085064 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.085274 [debug] [Thread-4  ]: Compiling seed.dbtlearn.seed_full_moon_dates
[0m08:42:41.086477 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:42:41.086684 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m08:42:41.087115 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:42:41.089477 [debug] [Thread-4  ]: Writing injected SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m08:42:41.089895 [debug] [Thread-1  ]: Compiling snapshot.dbtlearn.scd_raw_listings
[0m08:42:41.090231 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:42:41.090408 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.090797 [debug] [Thread-4  ]: finished collecting timing info
[0m08:42:41.093210 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.093541 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:42:41.093909 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:42:41.094108 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m08:42:41.094267 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m08:42:41.094483 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:42:41.094718 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:42:41.094918 [debug] [Thread-4  ]: finished collecting timing info
[0m08:42:41.095281 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.095463 [debug] [Thread-2  ]: Compiling model.dbtlearn.dim_hosts_cleansed
[0m08:42:41.095739 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:42:41.096075 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m08:42:41.096413 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m08:42:41.101831 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:42:41.105428 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:42:41.105751 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m08:42:41.106177 [debug] [Thread-3  ]: Compiling model.dbtlearn.dim_listings_cleansed
[0m08:42:41.106729 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.dbtlearn.fct_reviews"
[0m08:42:41.112095 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.112316 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:42:41.112902 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:42:41.113097 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:42:41.113288 [debug] [Thread-4  ]: Compiling model.dbtlearn.fct_reviews
[0m08:42:41.113639 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.113808 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.124852 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:42:41.130329 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:42:41.135601 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:42:41.136094 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.136746 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:42:41.137222 [debug] [Thread-4  ]: finished collecting timing info
[0m08:42:41.137760 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:42:41.137932 [debug] [Thread-4  ]: finished collecting timing info
[0m08:42:41.138339 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:42:41.138857 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:42:41.139126 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:42:41.139261 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:42:41.139390 [debug] [Thread-1  ]: Compiling model.dbtlearn.dim_listings_w_hosts
[0m08:42:41.142388 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:42:41.142673 [debug] [Thread-2  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:42:41.143002 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:42:41.143152 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.143310 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:42:41.143467 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:42:41.143676 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:42:41.143823 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:42:41.144012 [debug] [Thread-2  ]: Compiling test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:42:41.144288 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:42:41.144488 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.144764 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:42:41.153690 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:42:41.153933 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:42:41.154398 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:42:41.154603 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m08:42:41.154890 [debug] [Thread-3  ]: Compiling test.dbtlearn.dim_listings_minimum_nights
[0m08:42:41.155191 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:42:41.155330 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.155553 [debug] [Thread-4  ]: Compiling test.dbtlearn.no_nulls_in_dim_listings
[0m08:42:41.157747 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:42:41.158063 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:42:41.158262 [debug] [Thread-2  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:42:41.166452 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:42:41.166629 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:42:41.166908 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.167084 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.167269 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:42:41.167437 [debug] [Thread-1  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:42:41.167823 [debug] [Thread-2  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:42:41.168017 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:42:41.168197 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:42:41.174268 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:42:41.174510 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:42:41.174749 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.176898 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:42:41.177362 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:42:41.177576 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.177849 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:42:41.178084 [debug] [Thread-3  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:42:41.178307 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:42:41.178594 [debug] [Thread-2  ]: Compiling test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:42:41.178875 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:42:41.179047 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.182648 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:42:41.182920 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:42:41.183304 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:42:41.183638 [debug] [Thread-3  ]: Compiling test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:42:41.183796 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.184043 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:42:41.187315 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:42:41.187687 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:42:41.188070 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:42:41.188460 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.188723 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:42:41.188942 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.189308 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:42:41.189506 [debug] [Thread-1  ]: Compiling test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:42:41.189687 [debug] [Thread-3  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:42:41.189929 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:42:41.195625 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.196445 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:42:41.196810 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:42:41.197651 [debug] [Thread-3  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:42:41.197908 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:42:41.198219 [debug] [Thread-3  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:42:41.198372 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.198577 [debug] [Thread-2  ]: Compiling test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:42:41.198984 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:42:41.199171 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:42:41.203520 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:42:41.203728 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:42:41.204062 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.204398 [debug] [Thread-3  ]: Compiling model.dbtlearn.mart_fullmoon_reviews
[0m08:42:41.204951 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:42:41.205093 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.207630 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:42:41.207895 [debug] [Thread-1  ]: Began running node test.dbtlearn.consistent_created_at
[0m08:42:41.208109 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:42:41.208613 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbtlearn.consistent_created_at"
[0m08:42:41.208870 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.209023 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.209206 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m08:42:41.209395 [debug] [Thread-3  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:42:41.209811 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:42:41.209997 [debug] [Thread-1  ]: Compiling test.dbtlearn.consistent_created_at
[0m08:42:41.210175 [debug] [Thread-3  ]: finished collecting timing info
[0m08:42:41.212611 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m08:42:41.213083 [debug] [Thread-3  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:42:41.213781 [debug] [Thread-2  ]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m08:42:41.214065 [debug] [Thread-2  ]: Acquiring new snowflake connection "analysis.dbtlearn.full_moon_no_sleep"
[0m08:42:41.214214 [debug] [Thread-2  ]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m08:42:41.214340 [debug] [Thread-2  ]: Compiling analysis.dbtlearn.full_moon_no_sleep
[0m08:42:41.217134 [debug] [Thread-2  ]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m08:42:41.217397 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.217534 [debug] [Thread-1  ]: Began executing node test.dbtlearn.consistent_created_at
[0m08:42:41.217663 [debug] [Thread-1  ]: finished collecting timing info
[0m08:42:41.217955 [debug] [Thread-1  ]: Finished running node test.dbtlearn.consistent_created_at
[0m08:42:41.218265 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.218383 [debug] [Thread-2  ]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m08:42:41.218492 [debug] [Thread-2  ]: finished collecting timing info
[0m08:42:41.218746 [debug] [Thread-2  ]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m08:42:41.668727 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 0.5 seconds
[0m08:42:41.670064 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:42:41.670313 [debug] [Thread-4  ]: finished collecting timing info
[0m08:42:41.670435 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m08:42:41.670555 [debug] [Thread-4  ]: finished collecting timing info
[0m08:42:41.670674 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m08:42:41.768995 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:42:41.774804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:41.775522 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m08:42:41.775892 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m08:42:41.775988 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m08:42:41.776085 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m08:42:41.783493 [info ] [MainThread]: Done.
[0m08:42:41.785194 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
[0m08:42:41.785306 [info ] [MainThread]: Building catalog
[0m08:42:41.786697 [debug] [ThreadPool]: Acquiring new snowflake connection "airbnb.information_schema"
[0m08:42:41.792275 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m08:42:41.792445 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m08:42:41.792559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:43.924658 [debug] [ThreadPool]: SQL status: SUCCESS 74 in 2.13 seconds
[0m08:42:43.938114 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m08:42:44.060556 [info ] [MainThread]: Catalog written to /home/damonfoo/dbtCourse/dbtlearn/target/catalog.json
[0m08:42:44.060903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b213d3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18d68910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b18d95880>]}
[0m08:42:45.007255 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:42:45.007597 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-07-30 08:42:58.190612 | 6362e875-a661-4fb6-a42d-aba3756bbce9 ==============================
[0m08:42:58.190630 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:42:58.190974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/damonfoo/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m08:42:58.191091 [debug] [MainThread]: Tracking: tracking
[0m08:42:58.191282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8a855340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8a8553a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8a855400>]}
[0m08:42:58.192642 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m08:42:58.192838 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m08:42:58.193077 [info ] [MainThread]: 
[0m08:42:58.193306 [info ] [MainThread]: 
[0m08:42:58.193529 [info ] [MainThread]: Press Ctrl+C to exit.
